function hb(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var fb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yx={exports:{}},vd={},vx={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rl=Symbol.for("react.element"),pb=Symbol.for("react.portal"),mb=Symbol.for("react.fragment"),gb=Symbol.for("react.strict_mode"),yb=Symbol.for("react.profiler"),vb=Symbol.for("react.provider"),_b=Symbol.for("react.context"),wb=Symbol.for("react.forward_ref"),xb=Symbol.for("react.suspense"),Eb=Symbol.for("react.memo"),Sb=Symbol.for("react.lazy"),Gv=Symbol.iterator;function Cb(t){return t===null||typeof t!="object"?null:(t=Gv&&t[Gv]||t["@@iterator"],typeof t=="function"?t:null)}var _x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wx=Object.assign,xx={};function No(t,e,n){this.props=t,this.context=e,this.refs=xx,this.updater=n||_x}No.prototype.isReactComponent={};No.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};No.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ex(){}Ex.prototype=No.prototype;function wm(t,e,n){this.props=t,this.context=e,this.refs=xx,this.updater=n||_x}var xm=wm.prototype=new Ex;xm.constructor=wm;wx(xm,No.prototype);xm.isPureReactComponent=!0;var Kv=Array.isArray,Sx=Object.prototype.hasOwnProperty,Em={current:null},Cx={key:!0,ref:!0,__self:!0,__source:!0};function Ix(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Sx.call(e,r)&&!Cx.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Rl,type:t,key:i,ref:o,props:s,_owner:Em.current}}function Ib(t,e){return{$$typeof:Rl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rl}function Tb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Qv=/\/+/g;function Lh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Tb(""+t.key):e.toString(36)}function qc(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Rl:case pb:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Lh(o,0):r,Kv(s)?(n="",t!=null&&(n=t.replace(Qv,"$&/")+"/"),qc(s,e,n,"",function(d){return d})):s!=null&&(Sm(s)&&(s=Ib(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Qv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Kv(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Lh(i,l);o+=qc(i,e,n,c,s)}else if(c=Cb(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Lh(i,l++),o+=qc(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function _c(t,e,n){if(t==null)return t;var r=[],s=0;return qc(t,r,"","",function(i){return e.call(n,i,s++)}),r}function bb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Zt={current:null},Wc={transition:null},Nb={ReactCurrentDispatcher:Zt,ReactCurrentBatchConfig:Wc,ReactCurrentOwner:Em};function Tx(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:_c,forEach:function(t,e,n){_c(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _c(t,function(){e++}),e},toArray:function(t){return _c(t,function(e){return e})||[]},only:function(t){if(!Sm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ce.Component=No;Ce.Fragment=mb;Ce.Profiler=yb;Ce.PureComponent=wm;Ce.StrictMode=gb;Ce.Suspense=xb;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nb;Ce.act=Tx;Ce.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=wx({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Em.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Sx.call(e,c)&&!Cx.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Rl,type:t.type,key:s,ref:i,props:r,_owner:o}};Ce.createContext=function(t){return t={$$typeof:_b,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:vb,_context:t},t.Consumer=t};Ce.createElement=Ix;Ce.createFactory=function(t){var e=Ix.bind(null,t);return e.type=t,e};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(t){return{$$typeof:wb,render:t}};Ce.isValidElement=Sm;Ce.lazy=function(t){return{$$typeof:Sb,_payload:{_status:-1,_result:t},_init:bb}};Ce.memo=function(t,e){return{$$typeof:Eb,type:t,compare:e===void 0?null:e}};Ce.startTransition=function(t){var e=Wc.transition;Wc.transition={};try{t()}finally{Wc.transition=e}};Ce.unstable_act=Tx;Ce.useCallback=function(t,e){return Zt.current.useCallback(t,e)};Ce.useContext=function(t){return Zt.current.useContext(t)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(t){return Zt.current.useDeferredValue(t)};Ce.useEffect=function(t,e){return Zt.current.useEffect(t,e)};Ce.useId=function(){return Zt.current.useId()};Ce.useImperativeHandle=function(t,e,n){return Zt.current.useImperativeHandle(t,e,n)};Ce.useInsertionEffect=function(t,e){return Zt.current.useInsertionEffect(t,e)};Ce.useLayoutEffect=function(t,e){return Zt.current.useLayoutEffect(t,e)};Ce.useMemo=function(t,e){return Zt.current.useMemo(t,e)};Ce.useReducer=function(t,e,n){return Zt.current.useReducer(t,e,n)};Ce.useRef=function(t){return Zt.current.useRef(t)};Ce.useState=function(t){return Zt.current.useState(t)};Ce.useSyncExternalStore=function(t,e,n){return Zt.current.useSyncExternalStore(t,e,n)};Ce.useTransition=function(){return Zt.current.useTransition()};Ce.version="18.3.1";vx.exports=Ce;var k=vx.exports;const Sn=gx(k),kb=hb({__proto__:null,default:Sn},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rb=k,Ab=Symbol.for("react.element"),Pb=Symbol.for("react.fragment"),jb=Object.prototype.hasOwnProperty,Db=Rb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lb={key:!0,ref:!0,__self:!0,__source:!0};function bx(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)jb.call(e,r)&&!Lb.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Ab,type:t,key:i,ref:o,props:s,_owner:Db.current}}vd.Fragment=Pb;vd.jsx=bx;vd.jsxs=bx;yx.exports=vd;var a=yx.exports,Pf={},Nx={exports:{}},mn={},kx={exports:{}},Rx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,$){var W=D.length;D.push($);e:for(;0<W;){var ne=W-1>>>1,se=D[ne];if(0<s(se,$))D[ne]=$,D[W]=se,W=ne;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var $=D[0],W=D.pop();if(W!==$){D[0]=W;e:for(var ne=0,se=D.length,ce=se>>>1;ne<ce;){var F=2*(ne+1)-1,H=D[F],b=F+1,Q=D[b];if(0>s(H,W))b<se&&0>s(Q,H)?(D[ne]=Q,D[b]=W,ne=b):(D[ne]=H,D[F]=W,ne=F);else if(b<se&&0>s(Q,W))D[ne]=Q,D[b]=W,ne=b;else break e}}return $}function s(D,$){var W=D.sortIndex-$.sortIndex;return W!==0?W:D.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,f=null,m=3,y=!1,C=!1,w=!1,R=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(D){for(var $=n(d);$!==null;){if($.callback===null)r(d);else if($.startTime<=D)r(d),$.sortIndex=$.expirationTime,e(c,$);else break;$=n(d)}}function O(D){if(w=!1,_(D),!C)if(n(c)!==null)C=!0,q(j);else{var $=n(d);$!==null&&V(O,$.startTime-D)}}function j(D,$){C=!1,w&&(w=!1,T(v),v=-1),y=!0;var W=m;try{for(_($),f=n(c);f!==null&&(!(f.expirationTime>$)||D&&!P());){var ne=f.callback;if(typeof ne=="function"){f.callback=null,m=f.priorityLevel;var se=ne(f.expirationTime<=$);$=t.unstable_now(),typeof se=="function"?f.callback=se:f===n(c)&&r(c),_($)}else r(c);f=n(c)}if(f!==null)var ce=!0;else{var F=n(d);F!==null&&V(O,F.startTime-$),ce=!1}return ce}finally{f=null,m=W,y=!1}}var L=!1,E=null,v=-1,I=5,A=-1;function P(){return!(t.unstable_now()-A<I)}function M(){if(E!==null){var D=t.unstable_now();A=D;var $=!0;try{$=E(!0,D)}finally{$?S():(L=!1,E=null)}}else L=!1}var S;if(typeof x=="function")S=function(){x(M)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,U=Z.port2;Z.port1.onmessage=M,S=function(){U.postMessage(null)}}else S=function(){R(M,0)};function q(D){E=D,L||(L=!0,S())}function V(D,$){v=R(function(){D(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){C||y||(C=!0,q(j))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(D){switch(m){case 1:case 2:case 3:var $=3;break;default:$=m}var W=m;m=$;try{return D()}finally{m=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,$){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var W=m;m=D;try{return $()}finally{m=W}},t.unstable_scheduleCallback=function(D,$,W){var ne=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?ne+W:ne):W=ne,D){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=W+se,D={id:h++,callback:$,priorityLevel:D,startTime:W,expirationTime:se,sortIndex:-1},W>ne?(D.sortIndex=W,e(d,D),n(c)===null&&D===n(d)&&(w?(T(v),v=-1):w=!0,V(O,W-ne))):(D.sortIndex=se,e(c,D),C||y||(C=!0,q(j))),D},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(D){var $=m;return function(){var W=m;m=$;try{return D.apply(this,arguments)}finally{m=W}}}})(Rx);kx.exports=Rx;var Ob=kx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mb=k,pn=Ob;function te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ax=new Set,Ka={};function pi(t,e){ao(t,e),ao(t+"Capture",e)}function ao(t,e){for(Ka[t]=e,t=0;t<e.length;t++)Ax.add(e[t])}var Ir=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jf=Object.prototype.hasOwnProperty,Fb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Yv={},Jv={};function Vb(t){return jf.call(Jv,t)?!0:jf.call(Yv,t)?!1:Fb.test(t)?Jv[t]=!0:(Yv[t]=!0,!1)}function Ub(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function $b(t,e,n,r){if(e===null||typeof e>"u"||Ub(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function en(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var At={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){At[t]=new en(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];At[e]=new en(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){At[t]=new en(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){At[t]=new en(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){At[t]=new en(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){At[t]=new en(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){At[t]=new en(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){At[t]=new en(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){At[t]=new en(t,5,!1,t.toLowerCase(),null,!1,!1)});var Cm=/[\-:]([a-z])/g;function Im(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Cm,Im);At[e]=new en(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Cm,Im);At[e]=new en(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Cm,Im);At[e]=new en(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){At[t]=new en(t,1,!1,t.toLowerCase(),null,!1,!1)});At.xlinkHref=new en("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){At[t]=new en(t,1,!1,t.toLowerCase(),null,!0,!0)});function Tm(t,e,n,r){var s=At.hasOwnProperty(e)?At[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&($b(e,n,s,r)&&(n=null),r||s===null?Vb(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Dr=Mb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wc=Symbol.for("react.element"),ji=Symbol.for("react.portal"),Di=Symbol.for("react.fragment"),bm=Symbol.for("react.strict_mode"),Df=Symbol.for("react.profiler"),Px=Symbol.for("react.provider"),jx=Symbol.for("react.context"),Nm=Symbol.for("react.forward_ref"),Lf=Symbol.for("react.suspense"),Of=Symbol.for("react.suspense_list"),km=Symbol.for("react.memo"),qr=Symbol.for("react.lazy"),Dx=Symbol.for("react.offscreen"),Xv=Symbol.iterator;function sa(t){return t===null||typeof t!="object"?null:(t=Xv&&t[Xv]||t["@@iterator"],typeof t=="function"?t:null)}var Je=Object.assign,Oh;function va(t){if(Oh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Oh=e&&e[1]||""}return`
`+Oh+t}var Mh=!1;function Fh(t,e){if(!t||Mh)return"";Mh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Mh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?va(t):""}function Bb(t){switch(t.tag){case 5:return va(t.type);case 16:return va("Lazy");case 13:return va("Suspense");case 19:return va("SuspenseList");case 0:case 2:case 15:return t=Fh(t.type,!1),t;case 11:return t=Fh(t.type.render,!1),t;case 1:return t=Fh(t.type,!0),t;default:return""}}function Mf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Di:return"Fragment";case ji:return"Portal";case Df:return"Profiler";case bm:return"StrictMode";case Lf:return"Suspense";case Of:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case jx:return(t.displayName||"Context")+".Consumer";case Px:return(t._context.displayName||"Context")+".Provider";case Nm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case km:return e=t.displayName||null,e!==null?e:Mf(t.type)||"Memo";case qr:e=t._payload,t=t._init;try{return Mf(t(e))}catch{}}return null}function zb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mf(e);case 8:return e===bm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function _s(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Lx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qb(t){var e=Lx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function xc(t){t._valueTracker||(t._valueTracker=qb(t))}function Ox(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Lx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function hu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ff(t,e){var n=e.checked;return Je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Zv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=_s(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Mx(t,e){e=e.checked,e!=null&&Tm(t,"checked",e,!1)}function Vf(t,e){Mx(t,e);var n=_s(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Uf(t,e.type,n):e.hasOwnProperty("defaultValue")&&Uf(t,e.type,_s(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function e_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Uf(t,e,n){(e!=="number"||hu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var _a=Array.isArray;function Qi(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+_s(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function $f(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(te(91));return Je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function t_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(te(92));if(_a(n)){if(1<n.length)throw Error(te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:_s(n)}}function Fx(t,e){var n=_s(e.value),r=_s(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function n_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Vx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Vx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ec,Ux=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ec=Ec||document.createElement("div"),Ec.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ec.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Qa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ka={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wb=["Webkit","ms","Moz","O"];Object.keys(ka).forEach(function(t){Wb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ka[e]=ka[t]})});function $x(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ka.hasOwnProperty(t)&&ka[t]?(""+e).trim():e+"px"}function Bx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=$x(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Hb=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zf(t,e){if(e){if(Hb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(te(62))}}function qf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wf=null;function Rm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hf=null,Yi=null,Ji=null;function r_(t){if(t=jl(t)){if(typeof Hf!="function")throw Error(te(280));var e=t.stateNode;e&&(e=Sd(e),Hf(t.stateNode,t.type,e))}}function zx(t){Yi?Ji?Ji.push(t):Ji=[t]:Yi=t}function qx(){if(Yi){var t=Yi,e=Ji;if(Ji=Yi=null,r_(t),e)for(t=0;t<e.length;t++)r_(e[t])}}function Wx(t,e){return t(e)}function Hx(){}var Vh=!1;function Gx(t,e,n){if(Vh)return t(e,n);Vh=!0;try{return Wx(t,e,n)}finally{Vh=!1,(Yi!==null||Ji!==null)&&(Hx(),qx())}}function Ya(t,e){var n=t.stateNode;if(n===null)return null;var r=Sd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(te(231,e,typeof n));return n}var Gf=!1;if(Ir)try{var ia={};Object.defineProperty(ia,"passive",{get:function(){Gf=!0}}),window.addEventListener("test",ia,ia),window.removeEventListener("test",ia,ia)}catch{Gf=!1}function Gb(t,e,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Ra=!1,fu=null,pu=!1,Kf=null,Kb={onError:function(t){Ra=!0,fu=t}};function Qb(t,e,n,r,s,i,o,l,c){Ra=!1,fu=null,Gb.apply(Kb,arguments)}function Yb(t,e,n,r,s,i,o,l,c){if(Qb.apply(this,arguments),Ra){if(Ra){var d=fu;Ra=!1,fu=null}else throw Error(te(198));pu||(pu=!0,Kf=d)}}function mi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Kx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function s_(t){if(mi(t)!==t)throw Error(te(188))}function Jb(t){var e=t.alternate;if(!e){if(e=mi(t),e===null)throw Error(te(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return s_(s),t;if(i===r)return s_(s),e;i=i.sibling}throw Error(te(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?t:e}function Qx(t){return t=Jb(t),t!==null?Yx(t):null}function Yx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Yx(t);if(e!==null)return e;t=t.sibling}return null}var Jx=pn.unstable_scheduleCallback,i_=pn.unstable_cancelCallback,Xb=pn.unstable_shouldYield,Zb=pn.unstable_requestPaint,st=pn.unstable_now,eN=pn.unstable_getCurrentPriorityLevel,Am=pn.unstable_ImmediatePriority,Xx=pn.unstable_UserBlockingPriority,mu=pn.unstable_NormalPriority,tN=pn.unstable_LowPriority,Zx=pn.unstable_IdlePriority,_d=null,Qn=null;function nN(t){if(Qn&&typeof Qn.onCommitFiberRoot=="function")try{Qn.onCommitFiberRoot(_d,t,void 0,(t.current.flags&128)===128)}catch{}}var Mn=Math.clz32?Math.clz32:iN,rN=Math.log,sN=Math.LN2;function iN(t){return t>>>=0,t===0?32:31-(rN(t)/sN|0)|0}var Sc=64,Cc=4194304;function wa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function gu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=wa(l):(i&=o,i!==0&&(r=wa(i)))}else o=n&~s,o!==0?r=wa(o):i!==0&&(r=wa(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Mn(e),s=1<<n,r|=t[n],e&=~s;return r}function oN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Mn(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=oN(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Qf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function eE(){var t=Sc;return Sc<<=1,!(Sc&4194240)&&(Sc=64),t}function Uh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Al(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Mn(e),t[e]=n}function lN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Mn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Pm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Mn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Le=0;function tE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var nE,jm,rE,sE,iE,Yf=!1,Ic=[],rs=null,ss=null,is=null,Ja=new Map,Xa=new Map,Hr=[],cN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function o_(t,e){switch(t){case"focusin":case"focusout":rs=null;break;case"dragenter":case"dragleave":ss=null;break;case"mouseover":case"mouseout":is=null;break;case"pointerover":case"pointerout":Ja.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xa.delete(e.pointerId)}}function oa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=jl(e),e!==null&&jm(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function uN(t,e,n,r,s){switch(e){case"focusin":return rs=oa(rs,t,e,n,r,s),!0;case"dragenter":return ss=oa(ss,t,e,n,r,s),!0;case"mouseover":return is=oa(is,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ja.set(i,oa(Ja.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Xa.set(i,oa(Xa.get(i)||null,t,e,n,r,s)),!0}return!1}function oE(t){var e=zs(t.target);if(e!==null){var n=mi(e);if(n!==null){if(e=n.tag,e===13){if(e=Kx(n),e!==null){t.blockedOn=e,iE(t.priority,function(){rE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Jf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Wf=r,n.target.dispatchEvent(r),Wf=null}else return e=jl(n),e!==null&&jm(e),t.blockedOn=n,!1;e.shift()}return!0}function a_(t,e,n){Hc(t)&&n.delete(e)}function dN(){Yf=!1,rs!==null&&Hc(rs)&&(rs=null),ss!==null&&Hc(ss)&&(ss=null),is!==null&&Hc(is)&&(is=null),Ja.forEach(a_),Xa.forEach(a_)}function aa(t,e){t.blockedOn===e&&(t.blockedOn=null,Yf||(Yf=!0,pn.unstable_scheduleCallback(pn.unstable_NormalPriority,dN)))}function Za(t){function e(s){return aa(s,t)}if(0<Ic.length){aa(Ic[0],t);for(var n=1;n<Ic.length;n++){var r=Ic[n];r.blockedOn===t&&(r.blockedOn=null)}}for(rs!==null&&aa(rs,t),ss!==null&&aa(ss,t),is!==null&&aa(is,t),Ja.forEach(e),Xa.forEach(e),n=0;n<Hr.length;n++)r=Hr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Hr.length&&(n=Hr[0],n.blockedOn===null);)oE(n),n.blockedOn===null&&Hr.shift()}var Xi=Dr.ReactCurrentBatchConfig,yu=!0;function hN(t,e,n,r){var s=Le,i=Xi.transition;Xi.transition=null;try{Le=1,Dm(t,e,n,r)}finally{Le=s,Xi.transition=i}}function fN(t,e,n,r){var s=Le,i=Xi.transition;Xi.transition=null;try{Le=4,Dm(t,e,n,r)}finally{Le=s,Xi.transition=i}}function Dm(t,e,n,r){if(yu){var s=Jf(t,e,n,r);if(s===null)Yh(t,e,r,vu,n),o_(t,r);else if(uN(s,t,e,n,r))r.stopPropagation();else if(o_(t,r),e&4&&-1<cN.indexOf(t)){for(;s!==null;){var i=jl(s);if(i!==null&&nE(i),i=Jf(t,e,n,r),i===null&&Yh(t,e,r,vu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Yh(t,e,r,null,n)}}var vu=null;function Jf(t,e,n,r){if(vu=null,t=Rm(r),t=zs(t),t!==null)if(e=mi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Kx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return vu=t,null}function aE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(eN()){case Am:return 1;case Xx:return 4;case mu:case tN:return 16;case Zx:return 536870912;default:return 16}default:return 16}}var Xr=null,Lm=null,Gc=null;function lE(){if(Gc)return Gc;var t,e=Lm,n=e.length,r,s="value"in Xr?Xr.value:Xr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Gc=s.slice(t,1<r?1-r:void 0)}function Kc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Tc(){return!0}function l_(){return!1}function gn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Tc:l_,this.isPropagationStopped=l_,this}return Je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Tc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Tc)},persist:function(){},isPersistent:Tc}),e}var ko={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Om=gn(ko),Pl=Je({},ko,{view:0,detail:0}),pN=gn(Pl),$h,Bh,la,wd=Je({},Pl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==la&&(la&&t.type==="mousemove"?($h=t.screenX-la.screenX,Bh=t.screenY-la.screenY):Bh=$h=0,la=t),$h)},movementY:function(t){return"movementY"in t?t.movementY:Bh}}),c_=gn(wd),mN=Je({},wd,{dataTransfer:0}),gN=gn(mN),yN=Je({},Pl,{relatedTarget:0}),zh=gn(yN),vN=Je({},ko,{animationName:0,elapsedTime:0,pseudoElement:0}),_N=gn(vN),wN=Je({},ko,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xN=gn(wN),EN=Je({},ko,{data:0}),u_=gn(EN),SN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},CN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=IN[t])?!!e[t]:!1}function Mm(){return TN}var bN=Je({},Pl,{key:function(t){if(t.key){var e=SN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Kc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?CN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mm,charCode:function(t){return t.type==="keypress"?Kc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Kc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),NN=gn(bN),kN=Je({},wd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),d_=gn(kN),RN=Je({},Pl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mm}),AN=gn(RN),PN=Je({},ko,{propertyName:0,elapsedTime:0,pseudoElement:0}),jN=gn(PN),DN=Je({},wd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),LN=gn(DN),ON=[9,13,27,32],Fm=Ir&&"CompositionEvent"in window,Aa=null;Ir&&"documentMode"in document&&(Aa=document.documentMode);var MN=Ir&&"TextEvent"in window&&!Aa,cE=Ir&&(!Fm||Aa&&8<Aa&&11>=Aa),h_=" ",f_=!1;function uE(t,e){switch(t){case"keyup":return ON.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Li=!1;function FN(t,e){switch(t){case"compositionend":return dE(e);case"keypress":return e.which!==32?null:(f_=!0,h_);case"textInput":return t=e.data,t===h_&&f_?null:t;default:return null}}function VN(t,e){if(Li)return t==="compositionend"||!Fm&&uE(t,e)?(t=lE(),Gc=Lm=Xr=null,Li=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return cE&&e.locale!=="ko"?null:e.data;default:return null}}var UN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function p_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!UN[t.type]:e==="textarea"}function hE(t,e,n,r){zx(r),e=_u(e,"onChange"),0<e.length&&(n=new Om("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Pa=null,el=null;function $N(t){SE(t,0)}function xd(t){var e=Fi(t);if(Ox(e))return t}function BN(t,e){if(t==="change")return e}var fE=!1;if(Ir){var qh;if(Ir){var Wh="oninput"in document;if(!Wh){var m_=document.createElement("div");m_.setAttribute("oninput","return;"),Wh=typeof m_.oninput=="function"}qh=Wh}else qh=!1;fE=qh&&(!document.documentMode||9<document.documentMode)}function g_(){Pa&&(Pa.detachEvent("onpropertychange",pE),el=Pa=null)}function pE(t){if(t.propertyName==="value"&&xd(el)){var e=[];hE(e,el,t,Rm(t)),Gx($N,e)}}function zN(t,e,n){t==="focusin"?(g_(),Pa=e,el=n,Pa.attachEvent("onpropertychange",pE)):t==="focusout"&&g_()}function qN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xd(el)}function WN(t,e){if(t==="click")return xd(e)}function HN(t,e){if(t==="input"||t==="change")return xd(e)}function GN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $n=typeof Object.is=="function"?Object.is:GN;function tl(t,e){if($n(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!jf.call(e,s)||!$n(t[s],e[s]))return!1}return!0}function y_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function v_(t,e){var n=y_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=y_(n)}}function mE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?mE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function gE(){for(var t=window,e=hu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=hu(t.document)}return e}function Vm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function KN(t){var e=gE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&mE(n.ownerDocument.documentElement,n)){if(r!==null&&Vm(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=v_(n,i);var o=v_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var QN=Ir&&"documentMode"in document&&11>=document.documentMode,Oi=null,Xf=null,ja=null,Zf=!1;function __(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zf||Oi==null||Oi!==hu(r)||(r=Oi,"selectionStart"in r&&Vm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ja&&tl(ja,r)||(ja=r,r=_u(Xf,"onSelect"),0<r.length&&(e=new Om("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Oi)))}function bc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Mi={animationend:bc("Animation","AnimationEnd"),animationiteration:bc("Animation","AnimationIteration"),animationstart:bc("Animation","AnimationStart"),transitionend:bc("Transition","TransitionEnd")},Hh={},yE={};Ir&&(yE=document.createElement("div").style,"AnimationEvent"in window||(delete Mi.animationend.animation,delete Mi.animationiteration.animation,delete Mi.animationstart.animation),"TransitionEvent"in window||delete Mi.transitionend.transition);function Ed(t){if(Hh[t])return Hh[t];if(!Mi[t])return t;var e=Mi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in yE)return Hh[t]=e[n];return t}var vE=Ed("animationend"),_E=Ed("animationiteration"),wE=Ed("animationstart"),xE=Ed("transitionend"),EE=new Map,w_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ks(t,e){EE.set(t,e),pi(e,[t])}for(var Gh=0;Gh<w_.length;Gh++){var Kh=w_[Gh],YN=Kh.toLowerCase(),JN=Kh[0].toUpperCase()+Kh.slice(1);ks(YN,"on"+JN)}ks(vE,"onAnimationEnd");ks(_E,"onAnimationIteration");ks(wE,"onAnimationStart");ks("dblclick","onDoubleClick");ks("focusin","onFocus");ks("focusout","onBlur");ks(xE,"onTransitionEnd");ao("onMouseEnter",["mouseout","mouseover"]);ao("onMouseLeave",["mouseout","mouseover"]);ao("onPointerEnter",["pointerout","pointerover"]);ao("onPointerLeave",["pointerout","pointerover"]);pi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pi("onBeforeInput",["compositionend","keypress","textInput","paste"]);pi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XN=new Set("cancel close invalid load scroll toggle".split(" ").concat(xa));function x_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Yb(r,e,void 0,t),t.currentTarget=null}function SE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;x_(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;x_(s,l,d),i=c}}}if(pu)throw t=Kf,pu=!1,Kf=null,t}function qe(t,e){var n=e[sp];n===void 0&&(n=e[sp]=new Set);var r=t+"__bubble";n.has(r)||(CE(e,t,2,!1),n.add(r))}function Qh(t,e,n){var r=0;e&&(r|=4),CE(n,t,r,e)}var Nc="_reactListening"+Math.random().toString(36).slice(2);function nl(t){if(!t[Nc]){t[Nc]=!0,Ax.forEach(function(n){n!=="selectionchange"&&(XN.has(n)||Qh(n,!1,t),Qh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Nc]||(e[Nc]=!0,Qh("selectionchange",!1,e))}}function CE(t,e,n,r){switch(aE(e)){case 1:var s=hN;break;case 4:s=fN;break;default:s=Dm}n=s.bind(null,e,n,t),s=void 0,!Gf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Yh(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=zs(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Gx(function(){var d=i,h=Rm(n),f=[];e:{var m=EE.get(t);if(m!==void 0){var y=Om,C=t;switch(t){case"keypress":if(Kc(n)===0)break e;case"keydown":case"keyup":y=NN;break;case"focusin":C="focus",y=zh;break;case"focusout":C="blur",y=zh;break;case"beforeblur":case"afterblur":y=zh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=c_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=gN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=AN;break;case vE:case _E:case wE:y=_N;break;case xE:y=jN;break;case"scroll":y=pN;break;case"wheel":y=LN;break;case"copy":case"cut":case"paste":y=xN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=d_}var w=(e&4)!==0,R=!w&&t==="scroll",T=w?m!==null?m+"Capture":null:m;w=[];for(var x=d,_;x!==null;){_=x;var O=_.stateNode;if(_.tag===5&&O!==null&&(_=O,T!==null&&(O=Ya(x,T),O!=null&&w.push(rl(x,O,_)))),R)break;x=x.return}0<w.length&&(m=new y(m,C,null,n,h),f.push({event:m,listeners:w}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",m&&n!==Wf&&(C=n.relatedTarget||n.fromElement)&&(zs(C)||C[Tr]))break e;if((y||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,y?(C=n.relatedTarget||n.toElement,y=d,C=C?zs(C):null,C!==null&&(R=mi(C),C!==R||C.tag!==5&&C.tag!==6)&&(C=null)):(y=null,C=d),y!==C)){if(w=c_,O="onMouseLeave",T="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(w=d_,O="onPointerLeave",T="onPointerEnter",x="pointer"),R=y==null?m:Fi(y),_=C==null?m:Fi(C),m=new w(O,x+"leave",y,n,h),m.target=R,m.relatedTarget=_,O=null,zs(h)===d&&(w=new w(T,x+"enter",C,n,h),w.target=_,w.relatedTarget=R,O=w),R=O,y&&C)t:{for(w=y,T=C,x=0,_=w;_;_=Ni(_))x++;for(_=0,O=T;O;O=Ni(O))_++;for(;0<x-_;)w=Ni(w),x--;for(;0<_-x;)T=Ni(T),_--;for(;x--;){if(w===T||T!==null&&w===T.alternate)break t;w=Ni(w),T=Ni(T)}w=null}else w=null;y!==null&&E_(f,m,y,w,!1),C!==null&&R!==null&&E_(f,R,C,w,!0)}}e:{if(m=d?Fi(d):window,y=m.nodeName&&m.nodeName.toLowerCase(),y==="select"||y==="input"&&m.type==="file")var j=BN;else if(p_(m))if(fE)j=HN;else{j=qN;var L=zN}else(y=m.nodeName)&&y.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(j=WN);if(j&&(j=j(t,d))){hE(f,j,n,h);break e}L&&L(t,m,d),t==="focusout"&&(L=m._wrapperState)&&L.controlled&&m.type==="number"&&Uf(m,"number",m.value)}switch(L=d?Fi(d):window,t){case"focusin":(p_(L)||L.contentEditable==="true")&&(Oi=L,Xf=d,ja=null);break;case"focusout":ja=Xf=Oi=null;break;case"mousedown":Zf=!0;break;case"contextmenu":case"mouseup":case"dragend":Zf=!1,__(f,n,h);break;case"selectionchange":if(QN)break;case"keydown":case"keyup":__(f,n,h)}var E;if(Fm)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Li?uE(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(cE&&n.locale!=="ko"&&(Li||v!=="onCompositionStart"?v==="onCompositionEnd"&&Li&&(E=lE()):(Xr=h,Lm="value"in Xr?Xr.value:Xr.textContent,Li=!0)),L=_u(d,v),0<L.length&&(v=new u_(v,t,null,n,h),f.push({event:v,listeners:L}),E?v.data=E:(E=dE(n),E!==null&&(v.data=E)))),(E=MN?FN(t,n):VN(t,n))&&(d=_u(d,"onBeforeInput"),0<d.length&&(h=new u_("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=E))}SE(f,e)})}function rl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function _u(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ya(t,n),i!=null&&r.unshift(rl(t,i,s)),i=Ya(t,e),i!=null&&r.push(rl(t,i,s))),t=t.return}return r}function Ni(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function E_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=Ya(n,i),c!=null&&o.unshift(rl(n,c,l))):s||(c=Ya(n,i),c!=null&&o.push(rl(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var ZN=/\r\n?/g,ek=/\u0000|\uFFFD/g;function S_(t){return(typeof t=="string"?t:""+t).replace(ZN,`
`).replace(ek,"")}function kc(t,e,n){if(e=S_(e),S_(t)!==e&&n)throw Error(te(425))}function wu(){}var ep=null,tp=null;function np(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rp=typeof setTimeout=="function"?setTimeout:void 0,tk=typeof clearTimeout=="function"?clearTimeout:void 0,C_=typeof Promise=="function"?Promise:void 0,nk=typeof queueMicrotask=="function"?queueMicrotask:typeof C_<"u"?function(t){return C_.resolve(null).then(t).catch(rk)}:rp;function rk(t){setTimeout(function(){throw t})}function Jh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Za(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Za(e)}function os(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function I_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ro=Math.random().toString(36).slice(2),Gn="__reactFiber$"+Ro,sl="__reactProps$"+Ro,Tr="__reactContainer$"+Ro,sp="__reactEvents$"+Ro,sk="__reactListeners$"+Ro,ik="__reactHandles$"+Ro;function zs(t){var e=t[Gn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Tr]||n[Gn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=I_(t);t!==null;){if(n=t[Gn])return n;t=I_(t)}return e}t=n,n=t.parentNode}return null}function jl(t){return t=t[Gn]||t[Tr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Fi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(te(33))}function Sd(t){return t[sl]||null}var ip=[],Vi=-1;function Rs(t){return{current:t}}function He(t){0>Vi||(t.current=ip[Vi],ip[Vi]=null,Vi--)}function Be(t,e){Vi++,ip[Vi]=t.current,t.current=e}var ws={},zt=Rs(ws),on=Rs(!1),ei=ws;function lo(t,e){var n=t.type.contextTypes;if(!n)return ws;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function an(t){return t=t.childContextTypes,t!=null}function xu(){He(on),He(zt)}function T_(t,e,n){if(zt.current!==ws)throw Error(te(168));Be(zt,e),Be(on,n)}function IE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(te(108,zb(t)||"Unknown",s));return Je({},n,r)}function Eu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ws,ei=zt.current,Be(zt,t),Be(on,on.current),!0}function b_(t,e,n){var r=t.stateNode;if(!r)throw Error(te(169));n?(t=IE(t,e,ei),r.__reactInternalMemoizedMergedChildContext=t,He(on),He(zt),Be(zt,t)):He(on),Be(on,n)}var hr=null,Cd=!1,Xh=!1;function TE(t){hr===null?hr=[t]:hr.push(t)}function ok(t){Cd=!0,TE(t)}function As(){if(!Xh&&hr!==null){Xh=!0;var t=0,e=Le;try{var n=hr;for(Le=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}hr=null,Cd=!1}catch(s){throw hr!==null&&(hr=hr.slice(t+1)),Jx(Am,As),s}finally{Le=e,Xh=!1}}return null}var Ui=[],$i=0,Su=null,Cu=0,_n=[],wn=0,ti=null,fr=1,pr="";function Vs(t,e){Ui[$i++]=Cu,Ui[$i++]=Su,Su=t,Cu=e}function bE(t,e,n){_n[wn++]=fr,_n[wn++]=pr,_n[wn++]=ti,ti=t;var r=fr;t=pr;var s=32-Mn(r)-1;r&=~(1<<s),n+=1;var i=32-Mn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,fr=1<<32-Mn(e)+s|n<<s|r,pr=i+t}else fr=1<<i|n<<s|r,pr=t}function Um(t){t.return!==null&&(Vs(t,1),bE(t,1,0))}function $m(t){for(;t===Su;)Su=Ui[--$i],Ui[$i]=null,Cu=Ui[--$i],Ui[$i]=null;for(;t===ti;)ti=_n[--wn],_n[wn]=null,pr=_n[--wn],_n[wn]=null,fr=_n[--wn],_n[wn]=null}var fn=null,dn=null,Ge=!1,Dn=null;function NE(t,e){var n=xn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function N_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fn=t,dn=os(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fn=t,dn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ti!==null?{id:fr,overflow:pr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fn=t,dn=null,!0):!1;default:return!1}}function op(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ap(t){if(Ge){var e=dn;if(e){var n=e;if(!N_(t,e)){if(op(t))throw Error(te(418));e=os(n.nextSibling);var r=fn;e&&N_(t,e)?NE(r,n):(t.flags=t.flags&-4097|2,Ge=!1,fn=t)}}else{if(op(t))throw Error(te(418));t.flags=t.flags&-4097|2,Ge=!1,fn=t}}}function k_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fn=t}function Rc(t){if(t!==fn)return!1;if(!Ge)return k_(t),Ge=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!np(t.type,t.memoizedProps)),e&&(e=dn)){if(op(t))throw kE(),Error(te(418));for(;e;)NE(t,e),e=os(e.nextSibling)}if(k_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){dn=os(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}dn=null}}else dn=fn?os(t.stateNode.nextSibling):null;return!0}function kE(){for(var t=dn;t;)t=os(t.nextSibling)}function co(){dn=fn=null,Ge=!1}function Bm(t){Dn===null?Dn=[t]:Dn.push(t)}var ak=Dr.ReactCurrentBatchConfig;function ca(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,t))}return t}function Ac(t,e){throw t=Object.prototype.toString.call(e),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function R_(t){var e=t._init;return e(t._payload)}function RE(t){function e(T,x){if(t){var _=T.deletions;_===null?(T.deletions=[x],T.flags|=16):_.push(x)}}function n(T,x){if(!t)return null;for(;x!==null;)e(T,x),x=x.sibling;return null}function r(T,x){for(T=new Map;x!==null;)x.key!==null?T.set(x.key,x):T.set(x.index,x),x=x.sibling;return T}function s(T,x){return T=us(T,x),T.index=0,T.sibling=null,T}function i(T,x,_){return T.index=_,t?(_=T.alternate,_!==null?(_=_.index,_<x?(T.flags|=2,x):_):(T.flags|=2,x)):(T.flags|=1048576,x)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function l(T,x,_,O){return x===null||x.tag!==6?(x=of(_,T.mode,O),x.return=T,x):(x=s(x,_),x.return=T,x)}function c(T,x,_,O){var j=_.type;return j===Di?h(T,x,_.props.children,O,_.key):x!==null&&(x.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===qr&&R_(j)===x.type)?(O=s(x,_.props),O.ref=ca(T,x,_),O.return=T,O):(O=tu(_.type,_.key,_.props,null,T.mode,O),O.ref=ca(T,x,_),O.return=T,O)}function d(T,x,_,O){return x===null||x.tag!==4||x.stateNode.containerInfo!==_.containerInfo||x.stateNode.implementation!==_.implementation?(x=af(_,T.mode,O),x.return=T,x):(x=s(x,_.children||[]),x.return=T,x)}function h(T,x,_,O,j){return x===null||x.tag!==7?(x=Qs(_,T.mode,O,j),x.return=T,x):(x=s(x,_),x.return=T,x)}function f(T,x,_){if(typeof x=="string"&&x!==""||typeof x=="number")return x=of(""+x,T.mode,_),x.return=T,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case wc:return _=tu(x.type,x.key,x.props,null,T.mode,_),_.ref=ca(T,null,x),_.return=T,_;case ji:return x=af(x,T.mode,_),x.return=T,x;case qr:var O=x._init;return f(T,O(x._payload),_)}if(_a(x)||sa(x))return x=Qs(x,T.mode,_,null),x.return=T,x;Ac(T,x)}return null}function m(T,x,_,O){var j=x!==null?x.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return j!==null?null:l(T,x,""+_,O);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case wc:return _.key===j?c(T,x,_,O):null;case ji:return _.key===j?d(T,x,_,O):null;case qr:return j=_._init,m(T,x,j(_._payload),O)}if(_a(_)||sa(_))return j!==null?null:h(T,x,_,O,null);Ac(T,_)}return null}function y(T,x,_,O,j){if(typeof O=="string"&&O!==""||typeof O=="number")return T=T.get(_)||null,l(x,T,""+O,j);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case wc:return T=T.get(O.key===null?_:O.key)||null,c(x,T,O,j);case ji:return T=T.get(O.key===null?_:O.key)||null,d(x,T,O,j);case qr:var L=O._init;return y(T,x,_,L(O._payload),j)}if(_a(O)||sa(O))return T=T.get(_)||null,h(x,T,O,j,null);Ac(x,O)}return null}function C(T,x,_,O){for(var j=null,L=null,E=x,v=x=0,I=null;E!==null&&v<_.length;v++){E.index>v?(I=E,E=null):I=E.sibling;var A=m(T,E,_[v],O);if(A===null){E===null&&(E=I);break}t&&E&&A.alternate===null&&e(T,E),x=i(A,x,v),L===null?j=A:L.sibling=A,L=A,E=I}if(v===_.length)return n(T,E),Ge&&Vs(T,v),j;if(E===null){for(;v<_.length;v++)E=f(T,_[v],O),E!==null&&(x=i(E,x,v),L===null?j=E:L.sibling=E,L=E);return Ge&&Vs(T,v),j}for(E=r(T,E);v<_.length;v++)I=y(E,T,v,_[v],O),I!==null&&(t&&I.alternate!==null&&E.delete(I.key===null?v:I.key),x=i(I,x,v),L===null?j=I:L.sibling=I,L=I);return t&&E.forEach(function(P){return e(T,P)}),Ge&&Vs(T,v),j}function w(T,x,_,O){var j=sa(_);if(typeof j!="function")throw Error(te(150));if(_=j.call(_),_==null)throw Error(te(151));for(var L=j=null,E=x,v=x=0,I=null,A=_.next();E!==null&&!A.done;v++,A=_.next()){E.index>v?(I=E,E=null):I=E.sibling;var P=m(T,E,A.value,O);if(P===null){E===null&&(E=I);break}t&&E&&P.alternate===null&&e(T,E),x=i(P,x,v),L===null?j=P:L.sibling=P,L=P,E=I}if(A.done)return n(T,E),Ge&&Vs(T,v),j;if(E===null){for(;!A.done;v++,A=_.next())A=f(T,A.value,O),A!==null&&(x=i(A,x,v),L===null?j=A:L.sibling=A,L=A);return Ge&&Vs(T,v),j}for(E=r(T,E);!A.done;v++,A=_.next())A=y(E,T,v,A.value,O),A!==null&&(t&&A.alternate!==null&&E.delete(A.key===null?v:A.key),x=i(A,x,v),L===null?j=A:L.sibling=A,L=A);return t&&E.forEach(function(M){return e(T,M)}),Ge&&Vs(T,v),j}function R(T,x,_,O){if(typeof _=="object"&&_!==null&&_.type===Di&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case wc:e:{for(var j=_.key,L=x;L!==null;){if(L.key===j){if(j=_.type,j===Di){if(L.tag===7){n(T,L.sibling),x=s(L,_.props.children),x.return=T,T=x;break e}}else if(L.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===qr&&R_(j)===L.type){n(T,L.sibling),x=s(L,_.props),x.ref=ca(T,L,_),x.return=T,T=x;break e}n(T,L);break}else e(T,L);L=L.sibling}_.type===Di?(x=Qs(_.props.children,T.mode,O,_.key),x.return=T,T=x):(O=tu(_.type,_.key,_.props,null,T.mode,O),O.ref=ca(T,x,_),O.return=T,T=O)}return o(T);case ji:e:{for(L=_.key;x!==null;){if(x.key===L)if(x.tag===4&&x.stateNode.containerInfo===_.containerInfo&&x.stateNode.implementation===_.implementation){n(T,x.sibling),x=s(x,_.children||[]),x.return=T,T=x;break e}else{n(T,x);break}else e(T,x);x=x.sibling}x=af(_,T.mode,O),x.return=T,T=x}return o(T);case qr:return L=_._init,R(T,x,L(_._payload),O)}if(_a(_))return C(T,x,_,O);if(sa(_))return w(T,x,_,O);Ac(T,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,x!==null&&x.tag===6?(n(T,x.sibling),x=s(x,_),x.return=T,T=x):(n(T,x),x=of(_,T.mode,O),x.return=T,T=x),o(T)):n(T,x)}return R}var uo=RE(!0),AE=RE(!1),Iu=Rs(null),Tu=null,Bi=null,zm=null;function qm(){zm=Bi=Tu=null}function Wm(t){var e=Iu.current;He(Iu),t._currentValue=e}function lp(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Zi(t,e){Tu=t,zm=Bi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rn=!0),t.firstContext=null)}function bn(t){var e=t._currentValue;if(zm!==t)if(t={context:t,memoizedValue:e,next:null},Bi===null){if(Tu===null)throw Error(te(308));Bi=t,Tu.dependencies={lanes:0,firstContext:t}}else Bi=Bi.next=t;return e}var qs=null;function Hm(t){qs===null?qs=[t]:qs.push(t)}function PE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Hm(e)):(n.next=s.next,s.next=n),e.interleaved=n,br(t,r)}function br(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Wr=!1;function Gm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function as(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ne&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,br(t,n)}return s=r.interleaved,s===null?(e.next=e,Hm(r)):(e.next=s.next,s.next=e),r.interleaved=e,br(t,n)}function Qc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pm(t,n)}}function A_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function bu(t,e,n,r){var s=t.updateQueue;Wr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;o=0,h=d=c=null,l=i;do{var m=l.lane,y=l.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var C=t,w=l;switch(m=e,y=n,w.tag){case 1:if(C=w.payload,typeof C=="function"){f=C.call(y,f,m);break e}f=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=w.payload,m=typeof C=="function"?C.call(y,f,m):C,m==null)break e;f=Je({},f,m);break e;case 2:Wr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else y={eventTime:y,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=y,c=f):h=h.next=y,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ri|=o,t.lanes=o,t.memoizedState=f}}function P_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(te(191,s));s.call(r)}}}var Dl={},Yn=Rs(Dl),il=Rs(Dl),ol=Rs(Dl);function Ws(t){if(t===Dl)throw Error(te(174));return t}function Km(t,e){switch(Be(ol,e),Be(il,t),Be(Yn,Dl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Bf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Bf(e,t)}He(Yn),Be(Yn,e)}function ho(){He(Yn),He(il),He(ol)}function DE(t){Ws(ol.current);var e=Ws(Yn.current),n=Bf(e,t.type);e!==n&&(Be(il,t),Be(Yn,n))}function Qm(t){il.current===t&&(He(Yn),He(il))}var Ke=Rs(0);function Nu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Zh=[];function Ym(){for(var t=0;t<Zh.length;t++)Zh[t]._workInProgressVersionPrimary=null;Zh.length=0}var Yc=Dr.ReactCurrentDispatcher,ef=Dr.ReactCurrentBatchConfig,ni=0,Ye=null,ht=null,xt=null,ku=!1,Da=!1,al=0,lk=0;function Mt(){throw Error(te(321))}function Jm(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!$n(t[n],e[n]))return!1;return!0}function Xm(t,e,n,r,s,i){if(ni=i,Ye=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Yc.current=t===null||t.memoizedState===null?hk:fk,t=n(r,s),Da){i=0;do{if(Da=!1,al=0,25<=i)throw Error(te(301));i+=1,xt=ht=null,e.updateQueue=null,Yc.current=pk,t=n(r,s)}while(Da)}if(Yc.current=Ru,e=ht!==null&&ht.next!==null,ni=0,xt=ht=Ye=null,ku=!1,e)throw Error(te(300));return t}function Zm(){var t=al!==0;return al=0,t}function Wn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?Ye.memoizedState=xt=t:xt=xt.next=t,xt}function Nn(){if(ht===null){var t=Ye.alternate;t=t!==null?t.memoizedState:null}else t=ht.next;var e=xt===null?Ye.memoizedState:xt.next;if(e!==null)xt=e,ht=t;else{if(t===null)throw Error(te(310));ht=t,t={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},xt===null?Ye.memoizedState=xt=t:xt=xt.next=t}return xt}function ll(t,e){return typeof e=="function"?e(t):e}function tf(t){var e=Nn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=ht,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var h=d.lane;if((ni&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=r):c=c.next=f,Ye.lanes|=h,ri|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,$n(r,e.memoizedState)||(rn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ye.lanes|=i,ri|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function nf(t){var e=Nn(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);$n(i,e.memoizedState)||(rn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function LE(){}function OE(t,e){var n=Ye,r=Nn(),s=e(),i=!$n(r.memoizedState,s);if(i&&(r.memoizedState=s,rn=!0),r=r.queue,eg(VE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||xt!==null&&xt.memoizedState.tag&1){if(n.flags|=2048,cl(9,FE.bind(null,n,r,s,e),void 0,null),St===null)throw Error(te(349));ni&30||ME(n,e,s)}return s}function ME(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function FE(t,e,n,r){e.value=n,e.getSnapshot=r,UE(e)&&$E(t)}function VE(t,e,n){return n(function(){UE(e)&&$E(t)})}function UE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!$n(t,n)}catch{return!0}}function $E(t){var e=br(t,1);e!==null&&Fn(e,t,1,-1)}function j_(t){var e=Wn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:t},e.queue=t,t=t.dispatch=dk.bind(null,Ye,t),[e.memoizedState,t]}function cl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function BE(){return Nn().memoizedState}function Jc(t,e,n,r){var s=Wn();Ye.flags|=t,s.memoizedState=cl(1|e,n,void 0,r===void 0?null:r)}function Id(t,e,n,r){var s=Nn();r=r===void 0?null:r;var i=void 0;if(ht!==null){var o=ht.memoizedState;if(i=o.destroy,r!==null&&Jm(r,o.deps)){s.memoizedState=cl(e,n,i,r);return}}Ye.flags|=t,s.memoizedState=cl(1|e,n,i,r)}function D_(t,e){return Jc(8390656,8,t,e)}function eg(t,e){return Id(2048,8,t,e)}function zE(t,e){return Id(4,2,t,e)}function qE(t,e){return Id(4,4,t,e)}function WE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function HE(t,e,n){return n=n!=null?n.concat([t]):null,Id(4,4,WE.bind(null,e,t),n)}function tg(){}function GE(t,e){var n=Nn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jm(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function KE(t,e){var n=Nn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jm(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function QE(t,e,n){return ni&21?($n(n,e)||(n=eE(),Ye.lanes|=n,ri|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rn=!0),t.memoizedState=n)}function ck(t,e){var n=Le;Le=n!==0&&4>n?n:4,t(!0);var r=ef.transition;ef.transition={};try{t(!1),e()}finally{Le=n,ef.transition=r}}function YE(){return Nn().memoizedState}function uk(t,e,n){var r=cs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},JE(t))XE(e,n);else if(n=PE(t,e,n,r),n!==null){var s=Yt();Fn(n,t,r,s),ZE(n,e,r)}}function dk(t,e,n){var r=cs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(JE(t))XE(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,$n(l,o)){var c=e.interleaved;c===null?(s.next=s,Hm(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=PE(t,e,s,r),n!==null&&(s=Yt(),Fn(n,t,r,s),ZE(n,e,r))}}function JE(t){var e=t.alternate;return t===Ye||e!==null&&e===Ye}function XE(t,e){Da=ku=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ZE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pm(t,n)}}var Ru={readContext:bn,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useInsertionEffect:Mt,useLayoutEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useMutableSource:Mt,useSyncExternalStore:Mt,useId:Mt,unstable_isNewReconciler:!1},hk={readContext:bn,useCallback:function(t,e){return Wn().memoizedState=[t,e===void 0?null:e],t},useContext:bn,useEffect:D_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Jc(4194308,4,WE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Jc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Jc(4,2,t,e)},useMemo:function(t,e){var n=Wn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Wn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=uk.bind(null,Ye,t),[r.memoizedState,t]},useRef:function(t){var e=Wn();return t={current:t},e.memoizedState=t},useState:j_,useDebugValue:tg,useDeferredValue:function(t){return Wn().memoizedState=t},useTransition:function(){var t=j_(!1),e=t[0];return t=ck.bind(null,t[1]),Wn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ye,s=Wn();if(Ge){if(n===void 0)throw Error(te(407));n=n()}else{if(n=e(),St===null)throw Error(te(349));ni&30||ME(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,D_(VE.bind(null,r,i,t),[t]),r.flags|=2048,cl(9,FE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Wn(),e=St.identifierPrefix;if(Ge){var n=pr,r=fr;n=(r&~(1<<32-Mn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=al++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=lk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fk={readContext:bn,useCallback:GE,useContext:bn,useEffect:eg,useImperativeHandle:HE,useInsertionEffect:zE,useLayoutEffect:qE,useMemo:KE,useReducer:tf,useRef:BE,useState:function(){return tf(ll)},useDebugValue:tg,useDeferredValue:function(t){var e=Nn();return QE(e,ht.memoizedState,t)},useTransition:function(){var t=tf(ll)[0],e=Nn().memoizedState;return[t,e]},useMutableSource:LE,useSyncExternalStore:OE,useId:YE,unstable_isNewReconciler:!1},pk={readContext:bn,useCallback:GE,useContext:bn,useEffect:eg,useImperativeHandle:HE,useInsertionEffect:zE,useLayoutEffect:qE,useMemo:KE,useReducer:nf,useRef:BE,useState:function(){return nf(ll)},useDebugValue:tg,useDeferredValue:function(t){var e=Nn();return ht===null?e.memoizedState=t:QE(e,ht.memoizedState,t)},useTransition:function(){var t=nf(ll)[0],e=Nn().memoizedState;return[t,e]},useMutableSource:LE,useSyncExternalStore:OE,useId:YE,unstable_isNewReconciler:!1};function Pn(t,e){if(t&&t.defaultProps){e=Je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function cp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Td={isMounted:function(t){return(t=t._reactInternals)?mi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Yt(),s=cs(t),i=xr(r,s);i.payload=e,n!=null&&(i.callback=n),e=as(t,i,s),e!==null&&(Fn(e,t,s,r),Qc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Yt(),s=cs(t),i=xr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=as(t,i,s),e!==null&&(Fn(e,t,s,r),Qc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Yt(),r=cs(t),s=xr(n,r);s.tag=2,e!=null&&(s.callback=e),e=as(t,s,r),e!==null&&(Fn(e,t,r,n),Qc(e,t,r))}};function L_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!tl(n,r)||!tl(s,i):!0}function eS(t,e,n){var r=!1,s=ws,i=e.contextType;return typeof i=="object"&&i!==null?i=bn(i):(s=an(e)?ei:zt.current,r=e.contextTypes,i=(r=r!=null)?lo(t,s):ws),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Td,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function O_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Td.enqueueReplaceState(e,e.state,null)}function up(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Gm(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=bn(i):(i=an(e)?ei:zt.current,s.context=lo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(cp(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Td.enqueueReplaceState(s,s.state,null),bu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function fo(t,e){try{var n="",r=e;do n+=Bb(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function rf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function dp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var mk=typeof WeakMap=="function"?WeakMap:Map;function tS(t,e,n){n=xr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Pu||(Pu=!0,xp=r),dp(t,e)},n}function nS(t,e,n){n=xr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){dp(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){dp(t,e),typeof r!="function"&&(ls===null?ls=new Set([this]):ls.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function M_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new mk;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=kk.bind(null,t,e,n),e.then(t,t))}function F_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function V_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xr(-1,1),e.tag=2,as(n,e,1))),n.lanes|=1),t)}var gk=Dr.ReactCurrentOwner,rn=!1;function Kt(t,e,n,r){e.child=t===null?AE(e,null,n,r):uo(e,t.child,n,r)}function U_(t,e,n,r,s){n=n.render;var i=e.ref;return Zi(e,s),r=Xm(t,e,n,r,i,s),n=Zm(),t!==null&&!rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Nr(t,e,s)):(Ge&&n&&Um(e),e.flags|=1,Kt(t,e,r,s),e.child)}function $_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!cg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,rS(t,e,i,r,s)):(t=tu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:tl,n(o,r)&&t.ref===e.ref)return Nr(t,e,s)}return e.flags|=1,t=us(i,r),t.ref=e.ref,t.return=e,e.child=t}function rS(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(tl(i,r)&&t.ref===e.ref)if(rn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(rn=!0);else return e.lanes=t.lanes,Nr(t,e,s)}return hp(t,e,n,r,s)}function sS(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(qi,un),un|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Be(qi,un),un|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Be(qi,un),un|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Be(qi,un),un|=r;return Kt(t,e,s,n),e.child}function iS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function hp(t,e,n,r,s){var i=an(n)?ei:zt.current;return i=lo(e,i),Zi(e,s),n=Xm(t,e,n,r,i,s),r=Zm(),t!==null&&!rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Nr(t,e,s)):(Ge&&r&&Um(e),e.flags|=1,Kt(t,e,n,s),e.child)}function B_(t,e,n,r,s){if(an(n)){var i=!0;Eu(e)}else i=!1;if(Zi(e,s),e.stateNode===null)Xc(t,e),eS(e,n,r),up(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=bn(d):(d=an(n)?ei:zt.current,d=lo(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&O_(e,o,r,d),Wr=!1;var m=e.memoizedState;o.state=m,bu(e,r,o,s),c=e.memoizedState,l!==r||m!==c||on.current||Wr?(typeof h=="function"&&(cp(e,n,h,r),c=e.memoizedState),(l=Wr||L_(e,n,l,r,m,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,jE(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Pn(e.type,l),o.props=d,f=e.pendingProps,m=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=bn(c):(c=an(n)?ei:zt.current,c=lo(e,c));var y=n.getDerivedStateFromProps;(h=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||m!==c)&&O_(e,o,r,c),Wr=!1,m=e.memoizedState,o.state=m,bu(e,r,o,s);var C=e.memoizedState;l!==f||m!==C||on.current||Wr?(typeof y=="function"&&(cp(e,n,y,r),C=e.memoizedState),(d=Wr||L_(e,n,d,r,m,C,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),o.props=r,o.state=C,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return fp(t,e,n,r,i,s)}function fp(t,e,n,r,s,i){iS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&b_(e,n,!1),Nr(t,e,i);r=e.stateNode,gk.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=uo(e,t.child,null,i),e.child=uo(e,null,l,i)):Kt(t,e,l,i),e.memoizedState=r.state,s&&b_(e,n,!0),e.child}function oS(t){var e=t.stateNode;e.pendingContext?T_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&T_(t,e.context,!1),Km(t,e.containerInfo)}function z_(t,e,n,r,s){return co(),Bm(s),e.flags|=256,Kt(t,e,n,r),e.child}var pp={dehydrated:null,treeContext:null,retryLane:0};function mp(t){return{baseLanes:t,cachePool:null,transitions:null}}function aS(t,e,n){var r=e.pendingProps,s=Ke.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Be(Ke,s&1),t===null)return ap(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=kd(o,r,0,null),t=Qs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=mp(n),e.memoizedState=pp,t):ng(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return yk(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=us(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=us(l,i):(i=Qs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?mp(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=pp,r}return i=t.child,t=i.sibling,r=us(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ng(t,e){return e=kd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Pc(t,e,n,r){return r!==null&&Bm(r),uo(e,t.child,null,n),t=ng(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function yk(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=rf(Error(te(422))),Pc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=kd({mode:"visible",children:r.children},s,0,null),i=Qs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&uo(e,t.child,null,o),e.child.memoizedState=mp(o),e.memoizedState=pp,i);if(!(e.mode&1))return Pc(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(te(419)),r=rf(i,r,void 0),Pc(t,e,o,r)}if(l=(o&t.childLanes)!==0,rn||l){if(r=St,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,br(t,s),Fn(r,t,s,-1))}return lg(),r=rf(Error(te(421))),Pc(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Rk.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,dn=os(s.nextSibling),fn=e,Ge=!0,Dn=null,t!==null&&(_n[wn++]=fr,_n[wn++]=pr,_n[wn++]=ti,fr=t.id,pr=t.overflow,ti=e),e=ng(e,r.children),e.flags|=4096,e)}function q_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),lp(t.return,e,n)}function sf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function lS(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Kt(t,e,r.children,n),r=Ke.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&q_(t,n,e);else if(t.tag===19)q_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Be(Ke,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Nu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),sf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Nu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}sf(e,!0,n,null,i);break;case"together":sf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Xc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Nr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ri|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(te(153));if(e.child!==null){for(t=e.child,n=us(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=us(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function vk(t,e,n){switch(e.tag){case 3:oS(e),co();break;case 5:DE(e);break;case 1:an(e.type)&&Eu(e);break;case 4:Km(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Be(Iu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Be(Ke,Ke.current&1),e.flags|=128,null):n&e.child.childLanes?aS(t,e,n):(Be(Ke,Ke.current&1),t=Nr(t,e,n),t!==null?t.sibling:null);Be(Ke,Ke.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return lS(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Be(Ke,Ke.current),r)break;return null;case 22:case 23:return e.lanes=0,sS(t,e,n)}return Nr(t,e,n)}var cS,gp,uS,dS;cS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gp=function(){};uS=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ws(Yn.current);var i=null;switch(n){case"input":s=Ff(t,s),r=Ff(t,r),i=[];break;case"select":s=Je({},s,{value:void 0}),r=Je({},r,{value:void 0}),i=[];break;case"textarea":s=$f(t,s),r=$f(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=wu)}zf(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ka.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ka.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&qe("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};dS=function(t,e,n,r){n!==r&&(e.flags|=4)};function ua(t,e){if(!Ge)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ft(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function _k(t,e,n){var r=e.pendingProps;switch($m(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(e),null;case 1:return an(e.type)&&xu(),Ft(e),null;case 3:return r=e.stateNode,ho(),He(on),He(zt),Ym(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Rc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Dn!==null&&(Cp(Dn),Dn=null))),gp(t,e),Ft(e),null;case 5:Qm(e);var s=Ws(ol.current);if(n=e.type,t!==null&&e.stateNode!=null)uS(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(te(166));return Ft(e),null}if(t=Ws(Yn.current),Rc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Gn]=e,r[sl]=i,t=(e.mode&1)!==0,n){case"dialog":qe("cancel",r),qe("close",r);break;case"iframe":case"object":case"embed":qe("load",r);break;case"video":case"audio":for(s=0;s<xa.length;s++)qe(xa[s],r);break;case"source":qe("error",r);break;case"img":case"image":case"link":qe("error",r),qe("load",r);break;case"details":qe("toggle",r);break;case"input":Zv(r,i),qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},qe("invalid",r);break;case"textarea":t_(r,i),qe("invalid",r)}zf(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&kc(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&kc(r.textContent,l,t),s=["children",""+l]):Ka.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&qe("scroll",r)}switch(n){case"input":xc(r),e_(r,i,!0);break;case"textarea":xc(r),n_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=wu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Vx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Gn]=e,t[sl]=r,cS(t,e,!1,!1),e.stateNode=t;e:{switch(o=qf(n,r),n){case"dialog":qe("cancel",t),qe("close",t),s=r;break;case"iframe":case"object":case"embed":qe("load",t),s=r;break;case"video":case"audio":for(s=0;s<xa.length;s++)qe(xa[s],t);s=r;break;case"source":qe("error",t),s=r;break;case"img":case"image":case"link":qe("error",t),qe("load",t),s=r;break;case"details":qe("toggle",t),s=r;break;case"input":Zv(t,r),s=Ff(t,r),qe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Je({},r,{value:void 0}),qe("invalid",t);break;case"textarea":t_(t,r),s=$f(t,r),qe("invalid",t);break;default:s=r}zf(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Bx(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ux(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Qa(t,c):typeof c=="number"&&Qa(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ka.hasOwnProperty(i)?c!=null&&i==="onScroll"&&qe("scroll",t):c!=null&&Tm(t,i,c,o))}switch(n){case"input":xc(t),e_(t,r,!1);break;case"textarea":xc(t),n_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+_s(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Qi(t,!!r.multiple,i,!1):r.defaultValue!=null&&Qi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=wu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ft(e),null;case 6:if(t&&e.stateNode!=null)dS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(te(166));if(n=Ws(ol.current),Ws(Yn.current),Rc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Gn]=e,(i=r.nodeValue!==n)&&(t=fn,t!==null))switch(t.tag){case 3:kc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&kc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Gn]=e,e.stateNode=r}return Ft(e),null;case 13:if(He(Ke),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ge&&dn!==null&&e.mode&1&&!(e.flags&128))kE(),co(),e.flags|=98560,i=!1;else if(i=Rc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(te(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(te(317));i[Gn]=e}else co(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ft(e),i=!1}else Dn!==null&&(Cp(Dn),Dn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ke.current&1?mt===0&&(mt=3):lg())),e.updateQueue!==null&&(e.flags|=4),Ft(e),null);case 4:return ho(),gp(t,e),t===null&&nl(e.stateNode.containerInfo),Ft(e),null;case 10:return Wm(e.type._context),Ft(e),null;case 17:return an(e.type)&&xu(),Ft(e),null;case 19:if(He(Ke),i=e.memoizedState,i===null)return Ft(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ua(i,!1);else{if(mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Nu(t),o!==null){for(e.flags|=128,ua(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Be(Ke,Ke.current&1|2),e.child}t=t.sibling}i.tail!==null&&st()>po&&(e.flags|=128,r=!0,ua(i,!1),e.lanes=4194304)}else{if(!r)if(t=Nu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ua(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ge)return Ft(e),null}else 2*st()-i.renderingStartTime>po&&n!==1073741824&&(e.flags|=128,r=!0,ua(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=st(),e.sibling=null,n=Ke.current,Be(Ke,r?n&1|2:n&1),e):(Ft(e),null);case 22:case 23:return ag(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?un&1073741824&&(Ft(e),e.subtreeFlags&6&&(e.flags|=8192)):Ft(e),null;case 24:return null;case 25:return null}throw Error(te(156,e.tag))}function wk(t,e){switch($m(e),e.tag){case 1:return an(e.type)&&xu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ho(),He(on),He(zt),Ym(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Qm(e),null;case 13:if(He(Ke),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(te(340));co()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return He(Ke),null;case 4:return ho(),null;case 10:return Wm(e.type._context),null;case 22:case 23:return ag(),null;case 24:return null;default:return null}}var jc=!1,$t=!1,xk=typeof WeakSet=="function"?WeakSet:Set,ae=null;function zi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){et(t,e,r)}else n.current=null}function yp(t,e,n){try{n()}catch(r){et(t,e,r)}}var W_=!1;function Ek(t,e){if(ep=yu,t=gE(),Vm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var y;f!==n||s!==0&&f.nodeType!==3||(l=o+s),f!==i||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(y=f.firstChild)!==null;)m=f,f=y;for(;;){if(f===t)break t;if(m===n&&++d===s&&(l=o),m===i&&++h===r&&(c=o),(y=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=y}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tp={focusedElem:t,selectionRange:n},yu=!1,ae=e;ae!==null;)if(e=ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ae=t;else for(;ae!==null;){e=ae;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var w=C.memoizedProps,R=C.memoizedState,T=e.stateNode,x=T.getSnapshotBeforeUpdate(e.elementType===e.type?w:Pn(e.type,w),R);T.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(O){et(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,ae=t;break}ae=e.return}return C=W_,W_=!1,C}function La(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&yp(e,n,i)}s=s.next}while(s!==r)}}function bd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function vp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function hS(t){var e=t.alternate;e!==null&&(t.alternate=null,hS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Gn],delete e[sl],delete e[sp],delete e[sk],delete e[ik])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function fS(t){return t.tag===5||t.tag===3||t.tag===4}function H_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||fS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _p(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=wu));else if(r!==4&&(t=t.child,t!==null))for(_p(t,e,n),t=t.sibling;t!==null;)_p(t,e,n),t=t.sibling}function wp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(wp(t,e,n),t=t.sibling;t!==null;)wp(t,e,n),t=t.sibling}var Tt=null,jn=!1;function Br(t,e,n){for(n=n.child;n!==null;)pS(t,e,n),n=n.sibling}function pS(t,e,n){if(Qn&&typeof Qn.onCommitFiberUnmount=="function")try{Qn.onCommitFiberUnmount(_d,n)}catch{}switch(n.tag){case 5:$t||zi(n,e);case 6:var r=Tt,s=jn;Tt=null,Br(t,e,n),Tt=r,jn=s,Tt!==null&&(jn?(t=Tt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Tt.removeChild(n.stateNode));break;case 18:Tt!==null&&(jn?(t=Tt,n=n.stateNode,t.nodeType===8?Jh(t.parentNode,n):t.nodeType===1&&Jh(t,n),Za(t)):Jh(Tt,n.stateNode));break;case 4:r=Tt,s=jn,Tt=n.stateNode.containerInfo,jn=!0,Br(t,e,n),Tt=r,jn=s;break;case 0:case 11:case 14:case 15:if(!$t&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&yp(n,e,o),s=s.next}while(s!==r)}Br(t,e,n);break;case 1:if(!$t&&(zi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){et(n,e,l)}Br(t,e,n);break;case 21:Br(t,e,n);break;case 22:n.mode&1?($t=(r=$t)||n.memoizedState!==null,Br(t,e,n),$t=r):Br(t,e,n);break;default:Br(t,e,n)}}function G_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new xk),e.forEach(function(r){var s=Ak.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function An(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Tt=l.stateNode,jn=!1;break e;case 3:Tt=l.stateNode.containerInfo,jn=!0;break e;case 4:Tt=l.stateNode.containerInfo,jn=!0;break e}l=l.return}if(Tt===null)throw Error(te(160));pS(i,o,s),Tt=null,jn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){et(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mS(e,t),e=e.sibling}function mS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(An(e,t),qn(t),r&4){try{La(3,t,t.return),bd(3,t)}catch(w){et(t,t.return,w)}try{La(5,t,t.return)}catch(w){et(t,t.return,w)}}break;case 1:An(e,t),qn(t),r&512&&n!==null&&zi(n,n.return);break;case 5:if(An(e,t),qn(t),r&512&&n!==null&&zi(n,n.return),t.flags&32){var s=t.stateNode;try{Qa(s,"")}catch(w){et(t,t.return,w)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Mx(s,i),qf(l,o);var d=qf(l,i);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?Bx(s,f):h==="dangerouslySetInnerHTML"?Ux(s,f):h==="children"?Qa(s,f):Tm(s,h,f,d)}switch(l){case"input":Vf(s,i);break;case"textarea":Fx(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?Qi(s,!!i.multiple,y,!1):m!==!!i.multiple&&(i.defaultValue!=null?Qi(s,!!i.multiple,i.defaultValue,!0):Qi(s,!!i.multiple,i.multiple?[]:"",!1))}s[sl]=i}catch(w){et(t,t.return,w)}}break;case 6:if(An(e,t),qn(t),r&4){if(t.stateNode===null)throw Error(te(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(w){et(t,t.return,w)}}break;case 3:if(An(e,t),qn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Za(e.containerInfo)}catch(w){et(t,t.return,w)}break;case 4:An(e,t),qn(t);break;case 13:An(e,t),qn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(ig=st())),r&4&&G_(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?($t=(d=$t)||h,An(e,t),$t=d):An(e,t),qn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ae=t,h=t.child;h!==null;){for(f=ae=h;ae!==null;){switch(m=ae,y=m.child,m.tag){case 0:case 11:case 14:case 15:La(4,m,m.return);break;case 1:zi(m,m.return);var C=m.stateNode;if(typeof C.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(w){et(r,n,w)}}break;case 5:zi(m,m.return);break;case 22:if(m.memoizedState!==null){Q_(f);continue}}y!==null?(y.return=m,ae=y):Q_(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=$x("display",o))}catch(w){et(t,t.return,w)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(w){et(t,t.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:An(e,t),qn(t),r&4&&G_(t);break;case 21:break;default:An(e,t),qn(t)}}function qn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(fS(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Qa(s,""),r.flags&=-33);var i=H_(t);wp(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=H_(t);_p(t,l,o);break;default:throw Error(te(161))}}catch(c){et(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Sk(t,e,n){ae=t,gS(t)}function gS(t,e,n){for(var r=(t.mode&1)!==0;ae!==null;){var s=ae,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||jc;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||$t;l=jc;var d=$t;if(jc=o,($t=c)&&!d)for(ae=s;ae!==null;)o=ae,c=o.child,o.tag===22&&o.memoizedState!==null?Y_(s):c!==null?(c.return=o,ae=c):Y_(s);for(;i!==null;)ae=i,gS(i),i=i.sibling;ae=s,jc=l,$t=d}K_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ae=i):K_(t)}}function K_(t){for(;ae!==null;){var e=ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$t||bd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$t)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Pn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&P_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}P_(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Za(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}$t||e.flags&512&&vp(e)}catch(m){et(e,e.return,m)}}if(e===t){ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,ae=n;break}ae=e.return}}function Q_(t){for(;ae!==null;){var e=ae;if(e===t){ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ae=n;break}ae=e.return}}function Y_(t){for(;ae!==null;){var e=ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bd(4,e)}catch(c){et(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){et(e,s,c)}}var i=e.return;try{vp(e)}catch(c){et(e,i,c)}break;case 5:var o=e.return;try{vp(e)}catch(c){et(e,o,c)}}}catch(c){et(e,e.return,c)}if(e===t){ae=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ae=l;break}ae=e.return}}var Ck=Math.ceil,Au=Dr.ReactCurrentDispatcher,rg=Dr.ReactCurrentOwner,Cn=Dr.ReactCurrentBatchConfig,Ne=0,St=null,lt=null,kt=0,un=0,qi=Rs(0),mt=0,ul=null,ri=0,Nd=0,sg=0,Oa=null,tn=null,ig=0,po=1/0,dr=null,Pu=!1,xp=null,ls=null,Dc=!1,Zr=null,ju=0,Ma=0,Ep=null,Zc=-1,eu=0;function Yt(){return Ne&6?st():Zc!==-1?Zc:Zc=st()}function cs(t){return t.mode&1?Ne&2&&kt!==0?kt&-kt:ak.transition!==null?(eu===0&&(eu=eE()),eu):(t=Le,t!==0||(t=window.event,t=t===void 0?16:aE(t.type)),t):1}function Fn(t,e,n,r){if(50<Ma)throw Ma=0,Ep=null,Error(te(185));Al(t,n,r),(!(Ne&2)||t!==St)&&(t===St&&(!(Ne&2)&&(Nd|=n),mt===4&&Gr(t,kt)),ln(t,r),n===1&&Ne===0&&!(e.mode&1)&&(po=st()+500,Cd&&As()))}function ln(t,e){var n=t.callbackNode;aN(t,e);var r=gu(t,t===St?kt:0);if(r===0)n!==null&&i_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&i_(n),e===1)t.tag===0?ok(J_.bind(null,t)):TE(J_.bind(null,t)),nk(function(){!(Ne&6)&&As()}),n=null;else{switch(tE(r)){case 1:n=Am;break;case 4:n=Xx;break;case 16:n=mu;break;case 536870912:n=Zx;break;default:n=mu}n=CS(n,yS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function yS(t,e){if(Zc=-1,eu=0,Ne&6)throw Error(te(327));var n=t.callbackNode;if(eo()&&t.callbackNode!==n)return null;var r=gu(t,t===St?kt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Du(t,r);else{e=r;var s=Ne;Ne|=2;var i=_S();(St!==t||kt!==e)&&(dr=null,po=st()+500,Ks(t,e));do try{bk();break}catch(l){vS(t,l)}while(!0);qm(),Au.current=i,Ne=s,lt!==null?e=0:(St=null,kt=0,e=mt)}if(e!==0){if(e===2&&(s=Qf(t),s!==0&&(r=s,e=Sp(t,s))),e===1)throw n=ul,Ks(t,0),Gr(t,r),ln(t,st()),n;if(e===6)Gr(t,r);else{if(s=t.current.alternate,!(r&30)&&!Ik(s)&&(e=Du(t,r),e===2&&(i=Qf(t),i!==0&&(r=i,e=Sp(t,i))),e===1))throw n=ul,Ks(t,0),Gr(t,r),ln(t,st()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(te(345));case 2:Us(t,tn,dr);break;case 3:if(Gr(t,r),(r&130023424)===r&&(e=ig+500-st(),10<e)){if(gu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Yt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=rp(Us.bind(null,t,tn,dr),e);break}Us(t,tn,dr);break;case 4:if(Gr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Mn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=st()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ck(r/1960))-r,10<r){t.timeoutHandle=rp(Us.bind(null,t,tn,dr),r);break}Us(t,tn,dr);break;case 5:Us(t,tn,dr);break;default:throw Error(te(329))}}}return ln(t,st()),t.callbackNode===n?yS.bind(null,t):null}function Sp(t,e){var n=Oa;return t.current.memoizedState.isDehydrated&&(Ks(t,e).flags|=256),t=Du(t,e),t!==2&&(e=tn,tn=n,e!==null&&Cp(e)),t}function Cp(t){tn===null?tn=t:tn.push.apply(tn,t)}function Ik(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!$n(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Gr(t,e){for(e&=~sg,e&=~Nd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Mn(e),r=1<<n;t[n]=-1,e&=~r}}function J_(t){if(Ne&6)throw Error(te(327));eo();var e=gu(t,0);if(!(e&1))return ln(t,st()),null;var n=Du(t,e);if(t.tag!==0&&n===2){var r=Qf(t);r!==0&&(e=r,n=Sp(t,r))}if(n===1)throw n=ul,Ks(t,0),Gr(t,e),ln(t,st()),n;if(n===6)throw Error(te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Us(t,tn,dr),ln(t,st()),null}function og(t,e){var n=Ne;Ne|=1;try{return t(e)}finally{Ne=n,Ne===0&&(po=st()+500,Cd&&As())}}function si(t){Zr!==null&&Zr.tag===0&&!(Ne&6)&&eo();var e=Ne;Ne|=1;var n=Cn.transition,r=Le;try{if(Cn.transition=null,Le=1,t)return t()}finally{Le=r,Cn.transition=n,Ne=e,!(Ne&6)&&As()}}function ag(){un=qi.current,He(qi)}function Ks(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,tk(n)),lt!==null)for(n=lt.return;n!==null;){var r=n;switch($m(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&xu();break;case 3:ho(),He(on),He(zt),Ym();break;case 5:Qm(r);break;case 4:ho();break;case 13:He(Ke);break;case 19:He(Ke);break;case 10:Wm(r.type._context);break;case 22:case 23:ag()}n=n.return}if(St=t,lt=t=us(t.current,null),kt=un=e,mt=0,ul=null,sg=Nd=ri=0,tn=Oa=null,qs!==null){for(e=0;e<qs.length;e++)if(n=qs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}qs=null}return t}function vS(t,e){do{var n=lt;try{if(qm(),Yc.current=Ru,ku){for(var r=Ye.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ku=!1}if(ni=0,xt=ht=Ye=null,Da=!1,al=0,rg.current=null,n===null||n.return===null){mt=1,ul=e,lt=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=kt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var y=F_(o);if(y!==null){y.flags&=-257,V_(y,o,l,i,e),y.mode&1&&M_(i,d,e),e=y,c=d;var C=e.updateQueue;if(C===null){var w=new Set;w.add(c),e.updateQueue=w}else C.add(c);break e}else{if(!(e&1)){M_(i,d,e),lg();break e}c=Error(te(426))}}else if(Ge&&l.mode&1){var R=F_(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),V_(R,o,l,i,e),Bm(fo(c,l));break e}}i=c=fo(c,l),mt!==4&&(mt=2),Oa===null?Oa=[i]:Oa.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=tS(i,c,e);A_(i,T);break e;case 1:l=c;var x=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(ls===null||!ls.has(_)))){i.flags|=65536,e&=-e,i.lanes|=e;var O=nS(i,l,e);A_(i,O);break e}}i=i.return}while(i!==null)}xS(n)}catch(j){e=j,lt===n&&n!==null&&(lt=n=n.return);continue}break}while(!0)}function _S(){var t=Au.current;return Au.current=Ru,t===null?Ru:t}function lg(){(mt===0||mt===3||mt===2)&&(mt=4),St===null||!(ri&268435455)&&!(Nd&268435455)||Gr(St,kt)}function Du(t,e){var n=Ne;Ne|=2;var r=_S();(St!==t||kt!==e)&&(dr=null,Ks(t,e));do try{Tk();break}catch(s){vS(t,s)}while(!0);if(qm(),Ne=n,Au.current=r,lt!==null)throw Error(te(261));return St=null,kt=0,mt}function Tk(){for(;lt!==null;)wS(lt)}function bk(){for(;lt!==null&&!Xb();)wS(lt)}function wS(t){var e=SS(t.alternate,t,un);t.memoizedProps=t.pendingProps,e===null?xS(t):lt=e,rg.current=null}function xS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=wk(n,e),n!==null){n.flags&=32767,lt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{mt=6,lt=null;return}}else if(n=_k(n,e,un),n!==null){lt=n;return}if(e=e.sibling,e!==null){lt=e;return}lt=e=t}while(e!==null);mt===0&&(mt=5)}function Us(t,e,n){var r=Le,s=Cn.transition;try{Cn.transition=null,Le=1,Nk(t,e,n,r)}finally{Cn.transition=s,Le=r}return null}function Nk(t,e,n,r){do eo();while(Zr!==null);if(Ne&6)throw Error(te(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(te(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(lN(t,i),t===St&&(lt=St=null,kt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Dc||(Dc=!0,CS(mu,function(){return eo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Cn.transition,Cn.transition=null;var o=Le;Le=1;var l=Ne;Ne|=4,rg.current=null,Ek(t,n),mS(n,t),KN(tp),yu=!!ep,tp=ep=null,t.current=n,Sk(n),Zb(),Ne=l,Le=o,Cn.transition=i}else t.current=n;if(Dc&&(Dc=!1,Zr=t,ju=s),i=t.pendingLanes,i===0&&(ls=null),nN(n.stateNode),ln(t,st()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Pu)throw Pu=!1,t=xp,xp=null,t;return ju&1&&t.tag!==0&&eo(),i=t.pendingLanes,i&1?t===Ep?Ma++:(Ma=0,Ep=t):Ma=0,As(),null}function eo(){if(Zr!==null){var t=tE(ju),e=Cn.transition,n=Le;try{if(Cn.transition=null,Le=16>t?16:t,Zr===null)var r=!1;else{if(t=Zr,Zr=null,ju=0,Ne&6)throw Error(te(331));var s=Ne;for(Ne|=4,ae=t.current;ae!==null;){var i=ae,o=i.child;if(ae.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ae=d;ae!==null;){var h=ae;switch(h.tag){case 0:case 11:case 15:La(8,h,i)}var f=h.child;if(f!==null)f.return=h,ae=f;else for(;ae!==null;){h=ae;var m=h.sibling,y=h.return;if(hS(h),h===d){ae=null;break}if(m!==null){m.return=y,ae=m;break}ae=y}}}var C=i.alternate;if(C!==null){var w=C.child;if(w!==null){C.child=null;do{var R=w.sibling;w.sibling=null,w=R}while(w!==null)}}ae=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ae=o;else e:for(;ae!==null;){if(i=ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:La(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,ae=T;break e}ae=i.return}}var x=t.current;for(ae=x;ae!==null;){o=ae;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,ae=_;else e:for(o=x;ae!==null;){if(l=ae,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:bd(9,l)}}catch(j){et(l,l.return,j)}if(l===o){ae=null;break e}var O=l.sibling;if(O!==null){O.return=l.return,ae=O;break e}ae=l.return}}if(Ne=s,As(),Qn&&typeof Qn.onPostCommitFiberRoot=="function")try{Qn.onPostCommitFiberRoot(_d,t)}catch{}r=!0}return r}finally{Le=n,Cn.transition=e}}return!1}function X_(t,e,n){e=fo(n,e),e=tS(t,e,1),t=as(t,e,1),e=Yt(),t!==null&&(Al(t,1,e),ln(t,e))}function et(t,e,n){if(t.tag===3)X_(t,t,n);else for(;e!==null;){if(e.tag===3){X_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ls===null||!ls.has(r))){t=fo(n,t),t=nS(e,t,1),e=as(e,t,1),t=Yt(),e!==null&&(Al(e,1,t),ln(e,t));break}}e=e.return}}function kk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Yt(),t.pingedLanes|=t.suspendedLanes&n,St===t&&(kt&n)===n&&(mt===4||mt===3&&(kt&130023424)===kt&&500>st()-ig?Ks(t,0):sg|=n),ln(t,e)}function ES(t,e){e===0&&(t.mode&1?(e=Cc,Cc<<=1,!(Cc&130023424)&&(Cc=4194304)):e=1);var n=Yt();t=br(t,e),t!==null&&(Al(t,e,n),ln(t,n))}function Rk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ES(t,n)}function Ak(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(e),ES(t,n)}var SS;SS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||on.current)rn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return rn=!1,vk(t,e,n);rn=!!(t.flags&131072)}else rn=!1,Ge&&e.flags&1048576&&bE(e,Cu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Xc(t,e),t=e.pendingProps;var s=lo(e,zt.current);Zi(e,n),s=Xm(null,e,r,t,s,n);var i=Zm();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,an(r)?(i=!0,Eu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Gm(e),s.updater=Td,e.stateNode=s,s._reactInternals=e,up(e,r,t,n),e=fp(null,e,r,!0,i,n)):(e.tag=0,Ge&&i&&Um(e),Kt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Xc(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=jk(r),t=Pn(r,t),s){case 0:e=hp(null,e,r,t,n);break e;case 1:e=B_(null,e,r,t,n);break e;case 11:e=U_(null,e,r,t,n);break e;case 14:e=$_(null,e,r,Pn(r.type,t),n);break e}throw Error(te(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),hp(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),B_(t,e,r,s,n);case 3:e:{if(oS(e),t===null)throw Error(te(387));r=e.pendingProps,i=e.memoizedState,s=i.element,jE(t,e),bu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=fo(Error(te(423)),e),e=z_(t,e,r,n,s);break e}else if(r!==s){s=fo(Error(te(424)),e),e=z_(t,e,r,n,s);break e}else for(dn=os(e.stateNode.containerInfo.firstChild),fn=e,Ge=!0,Dn=null,n=AE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(co(),r===s){e=Nr(t,e,n);break e}Kt(t,e,r,n)}e=e.child}return e;case 5:return DE(e),t===null&&ap(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,np(r,s)?o=null:i!==null&&np(r,i)&&(e.flags|=32),iS(t,e),Kt(t,e,o,n),e.child;case 6:return t===null&&ap(e),null;case 13:return aS(t,e,n);case 4:return Km(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=uo(e,null,r,n):Kt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),U_(t,e,r,s,n);case 7:return Kt(t,e,e.pendingProps,n),e.child;case 8:return Kt(t,e,e.pendingProps.children,n),e.child;case 12:return Kt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Be(Iu,r._currentValue),r._currentValue=o,i!==null)if($n(i.value,o)){if(i.children===s.children&&!on.current){e=Nr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=xr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),lp(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(te(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),lp(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Kt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Zi(e,n),s=bn(s),r=r(s),e.flags|=1,Kt(t,e,r,n),e.child;case 14:return r=e.type,s=Pn(r,e.pendingProps),s=Pn(r.type,s),$_(t,e,r,s,n);case 15:return rS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),Xc(t,e),e.tag=1,an(r)?(t=!0,Eu(e)):t=!1,Zi(e,n),eS(e,r,s),up(e,r,s,n),fp(null,e,r,!0,t,n);case 19:return lS(t,e,n);case 22:return sS(t,e,n)}throw Error(te(156,e.tag))};function CS(t,e){return Jx(t,e)}function Pk(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(t,e,n,r){return new Pk(t,e,n,r)}function cg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function jk(t){if(typeof t=="function")return cg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Nm)return 11;if(t===km)return 14}return 2}function us(t,e){var n=t.alternate;return n===null?(n=xn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function tu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")cg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Di:return Qs(n.children,s,i,e);case bm:o=8,s|=8;break;case Df:return t=xn(12,n,e,s|2),t.elementType=Df,t.lanes=i,t;case Lf:return t=xn(13,n,e,s),t.elementType=Lf,t.lanes=i,t;case Of:return t=xn(19,n,e,s),t.elementType=Of,t.lanes=i,t;case Dx:return kd(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Px:o=10;break e;case jx:o=9;break e;case Nm:o=11;break e;case km:o=14;break e;case qr:o=16,r=null;break e}throw Error(te(130,t==null?t:typeof t,""))}return e=xn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Qs(t,e,n,r){return t=xn(7,t,r,e),t.lanes=n,t}function kd(t,e,n,r){return t=xn(22,t,r,e),t.elementType=Dx,t.lanes=n,t.stateNode={isHidden:!1},t}function of(t,e,n){return t=xn(6,t,null,e),t.lanes=n,t}function af(t,e,n){return e=xn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Dk(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Uh(0),this.expirationTimes=Uh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ug(t,e,n,r,s,i,o,l,c){return t=new Dk(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=xn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gm(i),t}function Lk(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ji,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function IS(t){if(!t)return ws;t=t._reactInternals;e:{if(mi(t)!==t||t.tag!==1)throw Error(te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(an(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(te(171))}if(t.tag===1){var n=t.type;if(an(n))return IE(t,n,e)}return e}function TS(t,e,n,r,s,i,o,l,c){return t=ug(n,r,!0,t,s,i,o,l,c),t.context=IS(null),n=t.current,r=Yt(),s=cs(n),i=xr(r,s),i.callback=e??null,as(n,i,s),t.current.lanes=s,Al(t,s,r),ln(t,r),t}function Rd(t,e,n,r){var s=e.current,i=Yt(),o=cs(s);return n=IS(n),e.context===null?e.context=n:e.pendingContext=n,e=xr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=as(s,e,o),t!==null&&(Fn(t,s,o,i),Qc(t,s,o)),o}function Lu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Z_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function dg(t,e){Z_(t,e),(t=t.alternate)&&Z_(t,e)}function Ok(){return null}var bS=typeof reportError=="function"?reportError:function(t){console.error(t)};function hg(t){this._internalRoot=t}Ad.prototype.render=hg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(te(409));Rd(t,e,null,null)};Ad.prototype.unmount=hg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;si(function(){Rd(null,t,null,null)}),e[Tr]=null}};function Ad(t){this._internalRoot=t}Ad.prototype.unstable_scheduleHydration=function(t){if(t){var e=sE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hr.length&&e!==0&&e<Hr[n].priority;n++);Hr.splice(n,0,t),n===0&&oE(t)}};function fg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Pd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function e0(){}function Mk(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Lu(o);i.call(d)}}var o=TS(e,r,t,0,null,!1,!1,"",e0);return t._reactRootContainer=o,t[Tr]=o.current,nl(t.nodeType===8?t.parentNode:t),si(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=Lu(c);l.call(d)}}var c=ug(t,0,!1,null,null,!1,!1,"",e0);return t._reactRootContainer=c,t[Tr]=c.current,nl(t.nodeType===8?t.parentNode:t),si(function(){Rd(e,c,n,r)}),c}function jd(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Lu(o);l.call(c)}}Rd(e,o,t,s)}else o=Mk(n,e,t,s,r);return Lu(o)}nE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=wa(e.pendingLanes);n!==0&&(Pm(e,n|1),ln(e,st()),!(Ne&6)&&(po=st()+500,As()))}break;case 13:si(function(){var r=br(t,1);if(r!==null){var s=Yt();Fn(r,t,1,s)}}),dg(t,1)}};jm=function(t){if(t.tag===13){var e=br(t,134217728);if(e!==null){var n=Yt();Fn(e,t,134217728,n)}dg(t,134217728)}};rE=function(t){if(t.tag===13){var e=cs(t),n=br(t,e);if(n!==null){var r=Yt();Fn(n,t,e,r)}dg(t,e)}};sE=function(){return Le};iE=function(t,e){var n=Le;try{return Le=t,e()}finally{Le=n}};Hf=function(t,e,n){switch(e){case"input":if(Vf(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Sd(r);if(!s)throw Error(te(90));Ox(r),Vf(r,s)}}}break;case"textarea":Fx(t,n);break;case"select":e=n.value,e!=null&&Qi(t,!!n.multiple,e,!1)}};Wx=og;Hx=si;var Fk={usingClientEntryPoint:!1,Events:[jl,Fi,Sd,zx,qx,og]},da={findFiberByHostInstance:zs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Vk={bundleType:da.bundleType,version:da.version,rendererPackageName:da.rendererPackageName,rendererConfig:da.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Dr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Qx(t),t===null?null:t.stateNode},findFiberByHostInstance:da.findFiberByHostInstance||Ok,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lc.isDisabled&&Lc.supportsFiber)try{_d=Lc.inject(Vk),Qn=Lc}catch{}}mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fk;mn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fg(e))throw Error(te(200));return Lk(t,e,null,n)};mn.createRoot=function(t,e){if(!fg(t))throw Error(te(299));var n=!1,r="",s=bS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ug(t,1,!1,null,null,n,!1,r,s),t[Tr]=e.current,nl(t.nodeType===8?t.parentNode:t),new hg(e)};mn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(te(188)):(t=Object.keys(t).join(","),Error(te(268,t)));return t=Qx(e),t=t===null?null:t.stateNode,t};mn.flushSync=function(t){return si(t)};mn.hydrate=function(t,e,n){if(!Pd(e))throw Error(te(200));return jd(null,t,e,!0,n)};mn.hydrateRoot=function(t,e,n){if(!fg(t))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=bS;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=TS(e,null,t,1,n??null,s,!1,i,o),t[Tr]=e.current,nl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ad(e)};mn.render=function(t,e,n){if(!Pd(e))throw Error(te(200));return jd(null,t,e,!1,n)};mn.unmountComponentAtNode=function(t){if(!Pd(t))throw Error(te(40));return t._reactRootContainer?(si(function(){jd(null,null,t,!1,function(){t._reactRootContainer=null,t[Tr]=null})}),!0):!1};mn.unstable_batchedUpdates=og;mn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Pd(n))throw Error(te(200));if(t==null||t._reactInternals===void 0)throw Error(te(38));return jd(t,e,n,!1,r)};mn.version="18.3.1-next-f1338f8080-20240426";function NS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(NS)}catch(t){console.error(t)}}NS(),Nx.exports=mn;var Uk=Nx.exports,t0=Uk;Pf.createRoot=t0.createRoot,Pf.hydrateRoot=t0.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dl(){return dl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dl.apply(this,arguments)}var es;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(es||(es={}));const n0="popstate";function $k(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Ip("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Ou(s)}return zk(e,n,null,t)}function it(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function kS(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Bk(){return Math.random().toString(36).substr(2,8)}function r0(t,e){return{usr:t.state,key:t.key,idx:e}}function Ip(t,e,n,r){return n===void 0&&(n=null),dl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ao(e):e,{state:n,key:e&&e.key||r||Bk()})}function Ou(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ao(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function zk(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=es.Pop,c=null,d=h();d==null&&(d=0,o.replaceState(dl({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function f(){l=es.Pop;let R=h(),T=R==null?null:R-d;d=R,c&&c({action:l,location:w.location,delta:T})}function m(R,T){l=es.Push;let x=Ip(w.location,R,T);d=h()+1;let _=r0(x,d),O=w.createHref(x);try{o.pushState(_,"",O)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(O)}i&&c&&c({action:l,location:w.location,delta:1})}function y(R,T){l=es.Replace;let x=Ip(w.location,R,T);d=h();let _=r0(x,d),O=w.createHref(x);o.replaceState(_,"",O),i&&c&&c({action:l,location:w.location,delta:0})}function C(R){let T=s.location.origin!=="null"?s.location.origin:s.location.href,x=typeof R=="string"?R:Ou(R);return x=x.replace(/ $/,"%20"),it(T,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,T)}let w={get action(){return l},get location(){return t(s,o)},listen(R){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(n0,f),c=R,()=>{s.removeEventListener(n0,f),c=null}},createHref(R){return e(s,R)},createURL:C,encodeLocation(R){let T=C(R);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:m,replace:y,go(R){return o.go(R)}};return w}var s0;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(s0||(s0={}));function qk(t,e,n){return n===void 0&&(n="/"),Wk(t,e,n)}function Wk(t,e,n,r){let s=typeof e=="string"?Ao(e):e,i=pg(s.pathname||"/",n);if(i==null)return null;let o=RS(t);Hk(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=sR(i);l=tR(o[c],d)}return l}function RS(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(it(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=ds([r,c.relativePath]),h=n.concat(c);i.children&&i.children.length>0&&(it(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),RS(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:Zk(d,i.index),routesMeta:h})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of AS(i.path))s(i,o,c)}),e}function AS(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=AS(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function Hk(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:eR(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Gk=/^:[\w-]+$/,Kk=3,Qk=2,Yk=1,Jk=10,Xk=-2,i0=t=>t==="*";function Zk(t,e){let n=t.split("/"),r=n.length;return n.some(i0)&&(r+=Xk),e&&(r+=Qk),n.filter(s=>!i0(s)).reduce((s,i)=>s+(Gk.test(i)?Kk:i===""?Yk:Jk),r)}function eR(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function tR(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=nR({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),m=c.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:ds([i,f.pathname]),pathnameBase:lR(ds([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=ds([i,f.pathnameBase]))}return o}function nR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=rR(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,h,f)=>{let{paramName:m,isOptional:y}=h;if(m==="*"){let w=l[f]||"";o=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const C=l[f];return y&&!C?d[m]=void 0:d[m]=(C||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function rR(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),kS(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function sR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return kS(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function pg(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function iR(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Ao(t):t;return{pathname:n?n.startsWith("/")?n:oR(n,e):e,search:cR(r),hash:uR(s)}}function oR(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function lf(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function aR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function mg(t,e){let n=aR(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function gg(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Ao(t):(s=dl({},t),it(!s.pathname||!s.pathname.includes("?"),lf("?","pathname","search",s)),it(!s.pathname||!s.pathname.includes("#"),lf("#","pathname","hash",s)),it(!s.search||!s.search.includes("#"),lf("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;s.pathname=m.join("/")}l=f>=0?e[f]:"/"}let c=iR(s,l),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const ds=t=>t.join("/").replace(/\/\/+/g,"/"),lR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),cR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,uR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function dR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const PS=["post","put","patch","delete"];new Set(PS);const hR=["get",...PS];new Set(hR);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hl(){return hl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hl.apply(this,arguments)}const yg=k.createContext(null),fR=k.createContext(null),Ps=k.createContext(null),Dd=k.createContext(null),Lr=k.createContext({outlet:null,matches:[],isDataRoute:!1}),jS=k.createContext(null);function pR(t,e){let{relative:n}=e===void 0?{}:e;Po()||it(!1);let{basename:r,navigator:s}=k.useContext(Ps),{hash:i,pathname:o,search:l}=OS(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:ds([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Po(){return k.useContext(Dd)!=null}function gi(){return Po()||it(!1),k.useContext(Dd).location}function DS(t){k.useContext(Ps).static||k.useLayoutEffect(t)}function sr(){let{isDataRoute:t}=k.useContext(Lr);return t?bR():mR()}function mR(){Po()||it(!1);let t=k.useContext(yg),{basename:e,future:n,navigator:r}=k.useContext(Ps),{matches:s}=k.useContext(Lr),{pathname:i}=gi(),o=JSON.stringify(mg(s,n.v7_relativeSplatPath)),l=k.useRef(!1);return DS(()=>{l.current=!0}),k.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let f=gg(d,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:ds([e,f.pathname])),(h.replace?r.replace:r.push)(f,h.state,h)},[e,r,o,i,t])}function LS(){let{matches:t}=k.useContext(Lr),e=t[t.length-1];return e?e.params:{}}function OS(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=k.useContext(Ps),{matches:s}=k.useContext(Lr),{pathname:i}=gi(),o=JSON.stringify(mg(s,r.v7_relativeSplatPath));return k.useMemo(()=>gg(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function gR(t,e){return yR(t,e)}function yR(t,e,n,r){Po()||it(!1);let{navigator:s,static:i}=k.useContext(Ps),{matches:o}=k.useContext(Lr),l=o[o.length-1],c=l?l.params:{};l&&l.pathname;let d=l?l.pathnameBase:"/";l&&l.route;let h=gi(),f;if(e){var m;let T=typeof e=="string"?Ao(e):e;d==="/"||(m=T.pathname)!=null&&m.startsWith(d)||it(!1),f=T}else f=h;let y=f.pathname||"/",C=y;if(d!=="/"){let T=d.replace(/^\//,"").split("/");C="/"+y.replace(/^\//,"").split("/").slice(T.length).join("/")}let w=qk(t,{pathname:C}),R=ER(w&&w.map(T=>Object.assign({},T,{params:Object.assign({},c,T.params),pathname:ds([d,s.encodeLocation?s.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?d:ds([d,s.encodeLocation?s.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),o,n,r);return e&&R?k.createElement(Dd.Provider,{value:{location:hl({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:es.Pop}},R):R}function vR(){let t=TR(),e=dR(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:s},n):null,null)}const _R=k.createElement(vR,null);class wR extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?k.createElement(Lr.Provider,{value:this.props.routeContext},k.createElement(jS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function xR(t){let{routeContext:e,match:n,children:r}=t,s=k.useContext(yg);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),k.createElement(Lr.Provider,{value:e},r)}function ER(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let h=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);h>=0||it(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:m,errors:y}=n,C=f.route.loader&&m[f.route.id]===void 0&&(!y||y[f.route.id]===void 0);if(f.route.lazy||C){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,f,m)=>{let y,C=!1,w=null,R=null;n&&(y=l&&f.route.id?l[f.route.id]:void 0,w=f.route.errorElement||_R,c&&(d<0&&m===0?(NR("route-fallback"),C=!0,R=null):d===m&&(C=!0,R=f.route.hydrateFallbackElement||null)));let T=e.concat(o.slice(0,m+1)),x=()=>{let _;return y?_=w:C?_=R:f.route.Component?_=k.createElement(f.route.Component,null):f.route.element?_=f.route.element:_=h,k.createElement(xR,{match:f,routeContext:{outlet:h,matches:T,isDataRoute:n!=null},children:_})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?k.createElement(wR,{location:n.location,revalidation:n.revalidation,component:w,error:y,children:x(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):x()},null)}var MS=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(MS||{}),FS=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(FS||{});function SR(t){let e=k.useContext(yg);return e||it(!1),e}function CR(t){let e=k.useContext(fR);return e||it(!1),e}function IR(t){let e=k.useContext(Lr);return e||it(!1),e}function VS(t){let e=IR(),n=e.matches[e.matches.length-1];return n.route.id||it(!1),n.route.id}function TR(){var t;let e=k.useContext(jS),n=CR(),r=VS();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function bR(){let{router:t}=SR(MS.UseNavigateStable),e=VS(FS.UseNavigateStable),n=k.useRef(!1);return DS(()=>{n.current=!0}),k.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,hl({fromRouteId:e},i)))},[t,e])}const o0={};function NR(t,e,n){o0[t]||(o0[t]=!0)}function kR(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Ea(t){let{to:e,replace:n,state:r,relative:s}=t;Po()||it(!1);let{future:i,static:o}=k.useContext(Ps),{matches:l}=k.useContext(Lr),{pathname:c}=gi(),d=sr(),h=gg(e,mg(l,i.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(h);return k.useEffect(()=>d(JSON.parse(f),{replace:n,state:r,relative:s}),[d,f,s,n,r]),null}function Ze(t){it(!1)}function RR(t){let{basename:e="/",children:n=null,location:r,navigationType:s=es.Pop,navigator:i,static:o=!1,future:l}=t;Po()&&it(!1);let c=e.replace(/^\/*/,"/"),d=k.useMemo(()=>({basename:c,navigator:i,static:o,future:hl({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=Ao(r));let{pathname:h="/",search:f="",hash:m="",state:y=null,key:C="default"}=r,w=k.useMemo(()=>{let R=pg(h,c);return R==null?null:{location:{pathname:R,search:f,hash:m,state:y,key:C},navigationType:s}},[c,h,f,m,y,C,s]);return w==null?null:k.createElement(Ps.Provider,{value:d},k.createElement(Dd.Provider,{children:n,value:w}))}function AR(t){let{children:e,location:n}=t;return gR(Tp(e),n)}new Promise(()=>{});function Tp(t,e){e===void 0&&(e=[]);let n=[];return k.Children.forEach(t,(r,s)=>{if(!k.isValidElement(r))return;let i=[...e,s];if(r.type===k.Fragment){n.push.apply(n,Tp(r.props.children,i));return}r.type!==Ze&&it(!1),!r.props.index||!r.props.children||it(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Tp(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bp(){return bp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},bp.apply(this,arguments)}function PR(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function jR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function DR(t,e){return t.button===0&&(!e||e==="_self")&&!jR(t)}function Np(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function LR(t,e){let n=Np(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const OR=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],MR="6";try{window.__reactRouterVersion=MR}catch{}const FR="startTransition",a0=kb[FR];function VR(t){let{basename:e,children:n,future:r,window:s}=t,i=k.useRef();i.current==null&&(i.current=$k({window:s,v5Compat:!0}));let o=i.current,[l,c]=k.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=k.useCallback(f=>{d&&a0?a0(()=>c(f)):c(f)},[c,d]);return k.useLayoutEffect(()=>o.listen(h),[o,h]),k.useEffect(()=>kR(r),[r]),k.createElement(RR,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const UR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$R=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mr=k.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:h,viewTransition:f}=e,m=PR(e,OR),{basename:y}=k.useContext(Ps),C,w=!1;if(typeof d=="string"&&$R.test(d)&&(C=d,UR))try{let _=new URL(window.location.href),O=d.startsWith("//")?new URL(_.protocol+d):new URL(d),j=pg(O.pathname,y);O.origin===_.origin&&j!=null?d=j+O.search+O.hash:w=!0}catch{}let R=pR(d,{relative:s}),T=BR(d,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:f});function x(_){r&&r(_),_.defaultPrevented||T(_)}return k.createElement("a",bp({},m,{href:C||R,onClick:w||i?r:x,ref:n,target:c}))});var l0;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(l0||(l0={}));var c0;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(c0||(c0={}));function BR(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=sr(),d=gi(),h=OS(t,{relative:o});return k.useCallback(f=>{if(DR(f,n)){f.preventDefault();let m=r!==void 0?r:Ou(d)===Ou(h);c(t,{replace:m,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,h,r,s,n,t,i,o,l])}function zR(t){let e=k.useRef(Np(t)),n=k.useRef(!1),r=gi(),s=k.useMemo(()=>LR(r.search,n.current?null:e.current),[r.search]),i=sr(),o=k.useCallback((l,c)=>{const d=Np(typeof l=="function"?l(s):l);n.current=!0,i("?"+d,c)},[i,s]);return[s,o]}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ct=(t,e)=>{const n=k.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},h)=>k.createElement("svg",{ref:h,...qR,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${WR(t)}`,l].join(" "),...d},[...e.map(([f,m])=>k.createElement(f,m)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=Ct("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=Ct("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=Ct("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=Ct("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=Ct("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=Ct("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=Ct("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=Ct("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BS=Ct("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=Ct("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=Ct("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=Ct("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _g=Ct("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=Ct("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=Ct("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=Ct("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=Ct("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=Ct("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ZR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20version='1.1'%20viewBox='0%200%201594.2671%20430.7484'%3e%3cdefs%3e%3cstyle%3e%20.cls-1%20{%20fill:%20%23f1e967;%20}%20%3c/style%3e%3c/defs%3e%3c!--%20Generator:%20Adobe%20Illustrator%2028.6.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%201.2.0%20Build%20709)%20--%3e%3cg%3e%3cg%20id='Layer_1'%3e%3cpath%20class='cls-1'%20d='M228.2804,430.7484h-71.9075v-49.4715C67.4484,364.3943,0,286.0849,0,192.3209,0,86.2737,86.2796,0,192.3267,0v71.9075c-66.4009,0-120.4192,54.0184-120.4192,120.4134,0,53.8779,35.5734,99.6101,84.4655,114.9361l.0585-118.6812c1.9838-61.2103,52.3916-110.395,114.0758-110.395,62.9366,0,114.1402,51.2036,114.1402,114.1402,0,93.7641-67.4425,172.0735-156.3671,188.956v49.4715ZM228.2804,192.3209v114.9361c48.8863-15.326,84.4597-61.0581,84.4597-114.9361,0-23.2845-18.9483-42.2328-42.2328-42.2328s-42.2269,18.9483-42.2269,42.2328Z'/%3e%3cpath%20class='cls-1'%20d='M476.9267,90.092h76.6864v43.0631c18.2836-30.0894,51.3229-48.963,89.0761-48.963,68.4265,0,102.6398,44.2431,102.6398,112.0796v188.766h-76.6864v-179.9161c0-38.3432-16.5197-58.9927-46.603-58.9927h-4.7199c-35.3932,0-63.7066,34.2133-63.7066,74.9164v163.9925h-76.6864V90.092Z'/%3e%3cpath%20class='cls-1'%20d='M912.6026,84.1921c86.7101,0,134.4931,63.1166,134.4931,149.8328,0,5.8999-.59,15.3397-1.18,27.7234h-199.3857c2.36,39.5232,35.3932,67.2466,66.6626,67.2466h4.7199c27.7234,0,46.597-15.9236,51.9069-37.1632h76.0964c-14.1537,58.4028-61.3467,99.1059-133.3131,99.1059-76.0964,0-140.399-57.8128-140.399-153.3727,0-88.4861,53.6829-153.3727,140.399-153.3727ZM972.7693,202.7616c-2.36-34.8033-28.3134-56.6328-60.7567-56.6328h-4.7199c-32.4433,0-58.4028,21.8295-60.7627,56.6328h126.2393Z'/%3e%3cpath%20class='cls-1'%20d='M1250.6113,385.0377c-1.7639-8.2598-2.9439-20.0536-3.5339-35.9832-18.2896,25.9534-49.5529,41.8831-87.3061,41.8831-53.0929,0-96.7459-34.2133-96.7459-86.7162,0-59.5767,44.833-92.02,107.9557-97.3299l74.3264-6.4899v-7.0799c0-27.1334-18.8796-47.193-47.193-47.193h-4.7199c-28.3134,0-45.423,17.1096-47.783,35.3932h-76.6864c5.8999-56.0368,54.2728-97.3299,126.8293-97.3299,74.3264,0,123.8794,38.3432,123.8794,106.1797v129.7792c0,29.4934,1.18,51.3169,2.9499,64.8866h-71.9725ZM1245.3075,256.4384l-63.7127,6.4899c-23.0035,1.77-43.0631,14.1597-43.0631,35.9832,0,18.2896,15.3397,30.0834,36.5732,30.0834h4.7199c34.2133,0,65.4826-27.1334,65.4826-64.2966v-8.2598Z'/%3e%3cpath%20class='cls-1'%20d='M1421.4248,287.7078c0,26.5434,19.4696,44.237,49.5529,44.237h4.7199c23.5935,0,38.9332-11.7937,38.9332-28.9034,0-15.9236-8.8498-24.7735-30.0834-29.4934l-38.3432-9.4398c-63.1227-15.9236-91.4361-41.8831-91.4361-89.0701,0-53.6829,46.013-90.8461,119.1595-90.8461,76.0964,0,120.3394,38.9332,120.3394,103.2298h-76.6864c-2.9499-28.3134-18.2896-44.2431-44.2431-44.2431h-4.7199c-21.2335,0-37.1632,11.7998-37.1632,28.9094,0,15.9236,12.3897,23.5935,37.7532,30.0834l39.5232,10.0298c56.6328,14.1537,82.5862,41.2871,82.5862,87.8901,0,50.7329-43.0631,90.8461-120.9294,90.8461-79.6363,0-127.4133-38.9332-127.4133-103.2298h78.4503Z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";var u0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re=function(t,e){if(!t)throw jo(e)},jo=function(t){return new Error("Firebase Database ("+HS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},eA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},wg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,y=d&63;c||(y=64,o||(m=64)),r.push(n[h],n[f],n[m],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(GS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):eA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||f==null)throw new tA;const m=i<<2|l>>4;if(r.push(m),d!==64){const y=l<<4&240|d>>2;if(r.push(y),f!==64){const C=d<<6&192|f;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class tA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KS=function(t){const e=GS(t);return wg.encodeByteArray(e,!0)},Fu=function(t){return KS(t).replace(/\./g,"")},Vu=function(t){try{return wg.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(t){return QS(void 0,t)}function QS(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!rA(n)||(t[n]=QS(t[n],e[n]));return t}function rA(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA=()=>sA().__FIREBASE_DEFAULTS__,oA=()=>{if(typeof process>"u"||typeof u0>"u")return;const t=u0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},aA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Vu(t[1]);return e&&JSON.parse(e)},Ld=()=>{try{return iA()||oA()||aA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},YS=t=>{var e,n;return(n=(e=Ld())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},JS=t=>{const e=YS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},XS=()=>{var t;return(t=Ld())===null||t===void 0?void 0:t.config},ZS=t=>{var e;return(e=Ld())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Fu(JSON.stringify(n)),Fu(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qt())}function lA(){var t;const e=(t=Ld())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uA(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function tC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dA(){const t=qt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function hA(){return HS.NODE_ADMIN===!0}function fA(){return!lA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pA(){try{return typeof indexedDB=="object"}catch{return!1}}function mA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA="FirebaseError";class Or extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=gA,Object.setPrototypeOf(this,Or.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ol.prototype.create)}}class Ol{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?yA(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Or(s,l,r)}}function yA(t,e){return t.replace(vA,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const vA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(t){return JSON.parse(t)}function pt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nC=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=fl(Vu(i[0])||""),n=fl(Vu(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},_A=function(t){const e=nC(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},wA=function(t){const e=nC(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function mo(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Rp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Uu(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function $u(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(d0(i)&&d0(o)){if(!$u(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function d0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Sa(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ca(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)r[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)r[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const m=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=(m<<1|m>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4],d,h;for(let f=0;f<80;f++){f<40?f<20?(d=l^i&(o^l),h=1518500249):(d=i^o^l,h=1859775393):f<60?(d=i&o|l&(i|o),h=2400959708):(d=i^o^l,h=3395469782);const m=(s<<5|s>>>27)+d+c+h+r[f]&4294967295;c=l,l=o,o=(i<<30|i>>>2)&4294967295,i=s,s=m}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function EA(t,e){const n=new SA(t,e);return n.subscribe.bind(n)}class SA{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");CA(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=cf),s.error===void 0&&(s.error=cf),s.complete===void 0&&(s.complete=cf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function CA(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function cf(){}function Od(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,re(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Md=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(t){return t&&t._delegate?t._delegate:t}class xs{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ll;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NA(e))try{this.getOrInitializeService({instanceIdentifier:$s})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=$s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$s){return this.instances.has(e)}getOptions(e=$s){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:bA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$s){return this.component?this.component.multipleInstances?e:$s:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bA(t){return t===$s?void 0:t}function NA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new TA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ie||(Ie={}));const RA={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},AA=Ie.INFO,PA={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},jA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=PA[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Fd{constructor(e){this.name=e,this._logLevel=AA,this._logHandler=jA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const DA=(t,e)=>e.some(n=>t instanceof n);let h0,f0;function LA(){return h0||(h0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function OA(){return f0||(f0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const rC=new WeakMap,Ap=new WeakMap,sC=new WeakMap,uf=new WeakMap,Eg=new WeakMap;function MA(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(hs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&rC.set(n,t)}).catch(()=>{}),Eg.set(e,t),e}function FA(t){if(Ap.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Ap.set(t,e)}let Pp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ap.get(t);if(e==="objectStoreNames")return t.objectStoreNames||sC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return hs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function VA(t){Pp=t(Pp)}function UA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(df(this),e,...n);return sC.set(r,e.sort?e.sort():[e]),hs(r)}:OA().includes(t)?function(...e){return t.apply(df(this),e),hs(rC.get(this))}:function(...e){return hs(t.apply(df(this),e))}}function $A(t){return typeof t=="function"?UA(t):(t instanceof IDBTransaction&&FA(t),DA(t,LA())?new Proxy(t,Pp):t)}function hs(t){if(t instanceof IDBRequest)return MA(t);if(uf.has(t))return uf.get(t);const e=$A(t);return e!==t&&(uf.set(t,e),Eg.set(e,t)),e}const df=t=>Eg.get(t);function BA(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=hs(o);return r&&o.addEventListener("upgradeneeded",c=>{r(hs(o.result),c.oldVersion,c.newVersion,hs(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const zA=["get","getKey","getAll","getAllKeys","count"],qA=["put","add","delete","clear"],hf=new Map;function p0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(hf.get(e))return hf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=qA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||zA.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&c.done]))[0]};return hf.set(e,i),i}VA(t=>({...t,get:(e,n,r)=>p0(e,n)||t.get(e,n,r),has:(e,n)=>!!p0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(HA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function HA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const jp="@firebase/app",m0="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr=new Fd("@firebase/app"),GA="@firebase/app-compat",KA="@firebase/analytics-compat",QA="@firebase/analytics",YA="@firebase/app-check-compat",JA="@firebase/app-check",XA="@firebase/auth",ZA="@firebase/auth-compat",e2="@firebase/database",t2="@firebase/data-connect",n2="@firebase/database-compat",r2="@firebase/functions",s2="@firebase/functions-compat",i2="@firebase/installations",o2="@firebase/installations-compat",a2="@firebase/messaging",l2="@firebase/messaging-compat",c2="@firebase/performance",u2="@firebase/performance-compat",d2="@firebase/remote-config",h2="@firebase/remote-config-compat",f2="@firebase/storage",p2="@firebase/storage-compat",m2="@firebase/firestore",g2="@firebase/vertexai-preview",y2="@firebase/firestore-compat",v2="firebase",_2="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp="[DEFAULT]",w2={[jp]:"fire-core",[GA]:"fire-core-compat",[QA]:"fire-analytics",[KA]:"fire-analytics-compat",[JA]:"fire-app-check",[YA]:"fire-app-check-compat",[XA]:"fire-auth",[ZA]:"fire-auth-compat",[e2]:"fire-rtdb",[t2]:"fire-data-connect",[n2]:"fire-rtdb-compat",[r2]:"fire-fn",[s2]:"fire-fn-compat",[i2]:"fire-iid",[o2]:"fire-iid-compat",[a2]:"fire-fcm",[l2]:"fire-fcm-compat",[c2]:"fire-perf",[u2]:"fire-perf-compat",[d2]:"fire-rc",[h2]:"fire-rc-compat",[f2]:"fire-gcs",[p2]:"fire-gcs-compat",[m2]:"fire-fst",[y2]:"fire-fst-compat",[g2]:"fire-vertex","fire-js":"fire-js",[v2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu=new Map,x2=new Map,Lp=new Map;function g0(t,e){try{t.container.addComponent(e)}catch(n){kr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ii(t){const e=t.name;if(Lp.has(e))return kr.debug(`There were multiple attempts to register component ${e}.`),!1;Lp.set(e,t);for(const n of Bu.values())g0(n,t);for(const n of x2.values())g0(n,t);return!0}function Vd(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Kn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fs=new Ol("app","Firebase",E2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new xs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi=_2;function iC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Dp,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw fs.create("bad-app-name",{appName:String(s)});if(n||(n=XS()),!n)throw fs.create("no-options");const i=Bu.get(s);if(i){if($u(n,i.options)&&$u(r,i.config))return i;throw fs.create("duplicate-app",{appName:s})}const o=new kA(s);for(const c of Lp.values())o.addComponent(c);const l=new S2(n,r,o);return Bu.set(s,l),l}function Sg(t=Dp){const e=Bu.get(t);if(!e&&t===Dp&&XS())return iC();if(!e)throw fs.create("no-app",{appName:t});return e}function Jn(t,e,n){var r;let s=(r=w2[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),kr.warn(l.join(" "));return}ii(new xs(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2="firebase-heartbeat-database",I2=1,pl="firebase-heartbeat-store";let ff=null;function oC(){return ff||(ff=BA(C2,I2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(pl)}catch(n){console.warn(n)}}}}).catch(t=>{throw fs.create("idb-open",{originalErrorMessage:t.message})})),ff}async function T2(t){try{const n=(await oC()).transaction(pl),r=await n.objectStore(pl).get(aC(t));return await n.done,r}catch(e){if(e instanceof Or)kr.warn(e.message);else{const n=fs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});kr.warn(n.message)}}}async function y0(t,e){try{const r=(await oC()).transaction(pl,"readwrite");await r.objectStore(pl).put(e,aC(t)),await r.done}catch(n){if(n instanceof Or)kr.warn(n.message);else{const r=fs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});kr.warn(r.message)}}}function aC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2=1024,N2=30*24*60*60*1e3;class k2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new A2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=v0();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=N2}),this._storage.overwrite(this._heartbeatsCache))}catch(r){kr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=v0(),{heartbeatsToSend:r,unsentEntries:s}=R2(this._heartbeatsCache.heartbeats),i=Fu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return kr.warn(n),""}}}function v0(){return new Date().toISOString().substring(0,10)}function R2(t,e=b2){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),_0(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),_0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class A2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pA()?mA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await T2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return y0(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return y0(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function _0(t){return Fu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(t){ii(new xs("platform-logger",e=>new WA(e),"PRIVATE")),ii(new xs("heartbeat",e=>new k2(e),"PRIVATE")),Jn(jp,m0,t),Jn(jp,m0,"esm2017"),Jn("fire-js","")}P2("");var w0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ys,lC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,v){function I(){}I.prototype=v.prototype,E.D=v.prototype,E.prototype=new I,E.prototype.constructor=E,E.C=function(A,P,M){for(var S=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)S[Z-2]=arguments[Z];return v.prototype[P].apply(A,S)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,v,I){I||(I=0);var A=Array(16);if(typeof v=="string")for(var P=0;16>P;++P)A[P]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(P=0;16>P;++P)A[P]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=E.g[0],I=E.g[1],P=E.g[2];var M=E.g[3],S=v+(M^I&(P^M))+A[0]+3614090360&4294967295;v=I+(S<<7&4294967295|S>>>25),S=M+(P^v&(I^P))+A[1]+3905402710&4294967295,M=v+(S<<12&4294967295|S>>>20),S=P+(I^M&(v^I))+A[2]+606105819&4294967295,P=M+(S<<17&4294967295|S>>>15),S=I+(v^P&(M^v))+A[3]+3250441966&4294967295,I=P+(S<<22&4294967295|S>>>10),S=v+(M^I&(P^M))+A[4]+4118548399&4294967295,v=I+(S<<7&4294967295|S>>>25),S=M+(P^v&(I^P))+A[5]+1200080426&4294967295,M=v+(S<<12&4294967295|S>>>20),S=P+(I^M&(v^I))+A[6]+2821735955&4294967295,P=M+(S<<17&4294967295|S>>>15),S=I+(v^P&(M^v))+A[7]+4249261313&4294967295,I=P+(S<<22&4294967295|S>>>10),S=v+(M^I&(P^M))+A[8]+1770035416&4294967295,v=I+(S<<7&4294967295|S>>>25),S=M+(P^v&(I^P))+A[9]+2336552879&4294967295,M=v+(S<<12&4294967295|S>>>20),S=P+(I^M&(v^I))+A[10]+4294925233&4294967295,P=M+(S<<17&4294967295|S>>>15),S=I+(v^P&(M^v))+A[11]+2304563134&4294967295,I=P+(S<<22&4294967295|S>>>10),S=v+(M^I&(P^M))+A[12]+1804603682&4294967295,v=I+(S<<7&4294967295|S>>>25),S=M+(P^v&(I^P))+A[13]+4254626195&4294967295,M=v+(S<<12&4294967295|S>>>20),S=P+(I^M&(v^I))+A[14]+2792965006&4294967295,P=M+(S<<17&4294967295|S>>>15),S=I+(v^P&(M^v))+A[15]+1236535329&4294967295,I=P+(S<<22&4294967295|S>>>10),S=v+(P^M&(I^P))+A[1]+4129170786&4294967295,v=I+(S<<5&4294967295|S>>>27),S=M+(I^P&(v^I))+A[6]+3225465664&4294967295,M=v+(S<<9&4294967295|S>>>23),S=P+(v^I&(M^v))+A[11]+643717713&4294967295,P=M+(S<<14&4294967295|S>>>18),S=I+(M^v&(P^M))+A[0]+3921069994&4294967295,I=P+(S<<20&4294967295|S>>>12),S=v+(P^M&(I^P))+A[5]+3593408605&4294967295,v=I+(S<<5&4294967295|S>>>27),S=M+(I^P&(v^I))+A[10]+38016083&4294967295,M=v+(S<<9&4294967295|S>>>23),S=P+(v^I&(M^v))+A[15]+3634488961&4294967295,P=M+(S<<14&4294967295|S>>>18),S=I+(M^v&(P^M))+A[4]+3889429448&4294967295,I=P+(S<<20&4294967295|S>>>12),S=v+(P^M&(I^P))+A[9]+568446438&4294967295,v=I+(S<<5&4294967295|S>>>27),S=M+(I^P&(v^I))+A[14]+3275163606&4294967295,M=v+(S<<9&4294967295|S>>>23),S=P+(v^I&(M^v))+A[3]+4107603335&4294967295,P=M+(S<<14&4294967295|S>>>18),S=I+(M^v&(P^M))+A[8]+1163531501&4294967295,I=P+(S<<20&4294967295|S>>>12),S=v+(P^M&(I^P))+A[13]+2850285829&4294967295,v=I+(S<<5&4294967295|S>>>27),S=M+(I^P&(v^I))+A[2]+4243563512&4294967295,M=v+(S<<9&4294967295|S>>>23),S=P+(v^I&(M^v))+A[7]+1735328473&4294967295,P=M+(S<<14&4294967295|S>>>18),S=I+(M^v&(P^M))+A[12]+2368359562&4294967295,I=P+(S<<20&4294967295|S>>>12),S=v+(I^P^M)+A[5]+4294588738&4294967295,v=I+(S<<4&4294967295|S>>>28),S=M+(v^I^P)+A[8]+2272392833&4294967295,M=v+(S<<11&4294967295|S>>>21),S=P+(M^v^I)+A[11]+1839030562&4294967295,P=M+(S<<16&4294967295|S>>>16),S=I+(P^M^v)+A[14]+4259657740&4294967295,I=P+(S<<23&4294967295|S>>>9),S=v+(I^P^M)+A[1]+2763975236&4294967295,v=I+(S<<4&4294967295|S>>>28),S=M+(v^I^P)+A[4]+1272893353&4294967295,M=v+(S<<11&4294967295|S>>>21),S=P+(M^v^I)+A[7]+4139469664&4294967295,P=M+(S<<16&4294967295|S>>>16),S=I+(P^M^v)+A[10]+3200236656&4294967295,I=P+(S<<23&4294967295|S>>>9),S=v+(I^P^M)+A[13]+681279174&4294967295,v=I+(S<<4&4294967295|S>>>28),S=M+(v^I^P)+A[0]+3936430074&4294967295,M=v+(S<<11&4294967295|S>>>21),S=P+(M^v^I)+A[3]+3572445317&4294967295,P=M+(S<<16&4294967295|S>>>16),S=I+(P^M^v)+A[6]+76029189&4294967295,I=P+(S<<23&4294967295|S>>>9),S=v+(I^P^M)+A[9]+3654602809&4294967295,v=I+(S<<4&4294967295|S>>>28),S=M+(v^I^P)+A[12]+3873151461&4294967295,M=v+(S<<11&4294967295|S>>>21),S=P+(M^v^I)+A[15]+530742520&4294967295,P=M+(S<<16&4294967295|S>>>16),S=I+(P^M^v)+A[2]+3299628645&4294967295,I=P+(S<<23&4294967295|S>>>9),S=v+(P^(I|~M))+A[0]+4096336452&4294967295,v=I+(S<<6&4294967295|S>>>26),S=M+(I^(v|~P))+A[7]+1126891415&4294967295,M=v+(S<<10&4294967295|S>>>22),S=P+(v^(M|~I))+A[14]+2878612391&4294967295,P=M+(S<<15&4294967295|S>>>17),S=I+(M^(P|~v))+A[5]+4237533241&4294967295,I=P+(S<<21&4294967295|S>>>11),S=v+(P^(I|~M))+A[12]+1700485571&4294967295,v=I+(S<<6&4294967295|S>>>26),S=M+(I^(v|~P))+A[3]+2399980690&4294967295,M=v+(S<<10&4294967295|S>>>22),S=P+(v^(M|~I))+A[10]+4293915773&4294967295,P=M+(S<<15&4294967295|S>>>17),S=I+(M^(P|~v))+A[1]+2240044497&4294967295,I=P+(S<<21&4294967295|S>>>11),S=v+(P^(I|~M))+A[8]+1873313359&4294967295,v=I+(S<<6&4294967295|S>>>26),S=M+(I^(v|~P))+A[15]+4264355552&4294967295,M=v+(S<<10&4294967295|S>>>22),S=P+(v^(M|~I))+A[6]+2734768916&4294967295,P=M+(S<<15&4294967295|S>>>17),S=I+(M^(P|~v))+A[13]+1309151649&4294967295,I=P+(S<<21&4294967295|S>>>11),S=v+(P^(I|~M))+A[4]+4149444226&4294967295,v=I+(S<<6&4294967295|S>>>26),S=M+(I^(v|~P))+A[11]+3174756917&4294967295,M=v+(S<<10&4294967295|S>>>22),S=P+(v^(M|~I))+A[2]+718787259&4294967295,P=M+(S<<15&4294967295|S>>>17),S=I+(M^(P|~v))+A[9]+3951481745&4294967295,E.g[0]=E.g[0]+v&4294967295,E.g[1]=E.g[1]+(P+(S<<21&4294967295|S>>>11))&4294967295,E.g[2]=E.g[2]+P&4294967295,E.g[3]=E.g[3]+M&4294967295}r.prototype.u=function(E,v){v===void 0&&(v=E.length);for(var I=v-this.blockSize,A=this.B,P=this.h,M=0;M<v;){if(P==0)for(;M<=I;)s(this,E,M),M+=this.blockSize;if(typeof E=="string"){for(;M<v;)if(A[P++]=E.charCodeAt(M++),P==this.blockSize){s(this,A),P=0;break}}else for(;M<v;)if(A[P++]=E[M++],P==this.blockSize){s(this,A),P=0;break}}this.h=P,this.o+=v},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var v=1;v<E.length-8;++v)E[v]=0;var I=8*this.o;for(v=E.length-8;v<E.length;++v)E[v]=I&255,I/=256;for(this.u(E),E=Array(16),v=I=0;4>v;++v)for(var A=0;32>A;A+=8)E[I++]=this.g[v]>>>A&255;return E};function i(E,v){var I=l;return Object.prototype.hasOwnProperty.call(I,E)?I[E]:I[E]=v(E)}function o(E,v){this.h=v;for(var I=[],A=!0,P=E.length-1;0<=P;P--){var M=E[P]|0;A&&M==v||(I[P]=M,A=!1)}this.g=I}var l={};function c(E){return-128<=E&&128>E?i(E,function(v){return new o([v|0],0>v?-1:0)}):new o([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return f;if(0>E)return R(d(-E));for(var v=[],I=1,A=0;E>=I;A++)v[A]=E/I|0,I*=4294967296;return new o(v,0)}function h(E,v){if(E.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(E.charAt(0)=="-")return R(h(E.substring(1),v));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=d(Math.pow(v,8)),A=f,P=0;P<E.length;P+=8){var M=Math.min(8,E.length-P),S=parseInt(E.substring(P,P+M),v);8>M?(M=d(Math.pow(v,M)),A=A.j(M).add(d(S))):(A=A.j(I),A=A.add(d(S)))}return A}var f=c(0),m=c(1),y=c(16777216);t=o.prototype,t.m=function(){if(w(this))return-R(this).m();for(var E=0,v=1,I=0;I<this.g.length;I++){var A=this.i(I);E+=(0<=A?A:4294967296+A)*v,v*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(C(this))return"0";if(w(this))return"-"+R(this).toString(E);for(var v=d(Math.pow(E,6)),I=this,A="";;){var P=O(I,v).g;I=T(I,P.j(v));var M=((0<I.g.length?I.g[0]:I.h)>>>0).toString(E);if(I=P,C(I))return M+A;for(;6>M.length;)M="0"+M;A=M+A}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function C(E){if(E.h!=0)return!1;for(var v=0;v<E.g.length;v++)if(E.g[v]!=0)return!1;return!0}function w(E){return E.h==-1}t.l=function(E){return E=T(this,E),w(E)?-1:C(E)?0:1};function R(E){for(var v=E.g.length,I=[],A=0;A<v;A++)I[A]=~E.g[A];return new o(I,~E.h).add(m)}t.abs=function(){return w(this)?R(this):this},t.add=function(E){for(var v=Math.max(this.g.length,E.g.length),I=[],A=0,P=0;P<=v;P++){var M=A+(this.i(P)&65535)+(E.i(P)&65535),S=(M>>>16)+(this.i(P)>>>16)+(E.i(P)>>>16);A=S>>>16,M&=65535,S&=65535,I[P]=S<<16|M}return new o(I,I[I.length-1]&-2147483648?-1:0)};function T(E,v){return E.add(R(v))}t.j=function(E){if(C(this)||C(E))return f;if(w(this))return w(E)?R(this).j(R(E)):R(R(this).j(E));if(w(E))return R(this.j(R(E)));if(0>this.l(y)&&0>E.l(y))return d(this.m()*E.m());for(var v=this.g.length+E.g.length,I=[],A=0;A<2*v;A++)I[A]=0;for(A=0;A<this.g.length;A++)for(var P=0;P<E.g.length;P++){var M=this.i(A)>>>16,S=this.i(A)&65535,Z=E.i(P)>>>16,U=E.i(P)&65535;I[2*A+2*P]+=S*U,x(I,2*A+2*P),I[2*A+2*P+1]+=M*U,x(I,2*A+2*P+1),I[2*A+2*P+1]+=S*Z,x(I,2*A+2*P+1),I[2*A+2*P+2]+=M*Z,x(I,2*A+2*P+2)}for(A=0;A<v;A++)I[A]=I[2*A+1]<<16|I[2*A];for(A=v;A<2*v;A++)I[A]=0;return new o(I,0)};function x(E,v){for(;(E[v]&65535)!=E[v];)E[v+1]+=E[v]>>>16,E[v]&=65535,v++}function _(E,v){this.g=E,this.h=v}function O(E,v){if(C(v))throw Error("division by zero");if(C(E))return new _(f,f);if(w(E))return v=O(R(E),v),new _(R(v.g),R(v.h));if(w(v))return v=O(E,R(v)),new _(R(v.g),v.h);if(30<E.g.length){if(w(E)||w(v))throw Error("slowDivide_ only works with positive integers.");for(var I=m,A=v;0>=A.l(E);)I=j(I),A=j(A);var P=L(I,1),M=L(A,1);for(A=L(A,2),I=L(I,2);!C(A);){var S=M.add(A);0>=S.l(E)&&(P=P.add(I),M=S),A=L(A,1),I=L(I,1)}return v=T(E,P.j(v)),new _(P,v)}for(P=f;0<=E.l(v);){for(I=Math.max(1,Math.floor(E.m()/v.m())),A=Math.ceil(Math.log(I)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),M=d(I),S=M.j(v);w(S)||0<S.l(E);)I-=A,M=d(I),S=M.j(v);C(M)&&(M=m),P=P.add(M),E=T(E,S)}return new _(P,E)}t.A=function(E){return O(this,E).h},t.and=function(E){for(var v=Math.max(this.g.length,E.g.length),I=[],A=0;A<v;A++)I[A]=this.i(A)&E.i(A);return new o(I,this.h&E.h)},t.or=function(E){for(var v=Math.max(this.g.length,E.g.length),I=[],A=0;A<v;A++)I[A]=this.i(A)|E.i(A);return new o(I,this.h|E.h)},t.xor=function(E){for(var v=Math.max(this.g.length,E.g.length),I=[],A=0;A<v;A++)I[A]=this.i(A)^E.i(A);return new o(I,this.h^E.h)};function j(E){for(var v=E.g.length+1,I=[],A=0;A<v;A++)I[A]=E.i(A)<<1|E.i(A-1)>>>31;return new o(I,E.h)}function L(E,v){var I=v>>5;v%=32;for(var A=E.g.length-I,P=[],M=0;M<A;M++)P[M]=0<v?E.i(M+I)>>>v|E.i(M+I+1)<<32-v:E.i(M+I);return new o(P,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,lC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Ys=o}).apply(typeof w0<"u"?w0:typeof self<"u"?self:typeof window<"u"?window:{});var Mc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var cC,Ia,uC,nu,Op,dC,hC,fC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,g){return u==Array.prototype||u==Object.prototype||(u[p]=g.value),u};function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Mc=="object"&&Mc];for(var p=0;p<u.length;++p){var g=u[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(u,p){if(p)e:{var g=r;u=u.split(".");for(var N=0;N<u.length-1;N++){var B=u[N];if(!(B in g))break e;g=g[B]}u=u[u.length-1],N=g[u],p=p(N),p!=N&&p!=null&&e(g,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var g=0,N=!1,B={next:function(){if(!N&&g<u.length){var G=g++;return{value:p(G,u[G]),done:!1}}return N=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function d(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function h(u,p,g){return u.call.apply(u.bind,arguments)}function f(u,p,g){if(!u)throw Error();if(2<arguments.length){var N=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,N),u.apply(p,B)}}return function(){return u.apply(p,arguments)}}function m(u,p,g){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,m.apply(null,arguments)}function y(u,p){var g=Array.prototype.slice.call(arguments,1);return function(){var N=g.slice();return N.push.apply(N,arguments),u.apply(this,N)}}function C(u,p){function g(){}g.prototype=p.prototype,u.aa=p.prototype,u.prototype=new g,u.prototype.constructor=u,u.Qb=function(N,B,G){for(var oe=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)oe[Fe-2]=arguments[Fe];return p.prototype[B].apply(N,oe)}}function w(u){const p=u.length;if(0<p){const g=Array(p);for(let N=0;N<p;N++)g[N]=u[N];return g}return[]}function R(u,p){for(let g=1;g<arguments.length;g++){const N=arguments[g];if(c(N)){const B=u.length||0,G=N.length||0;u.length=B+G;for(let oe=0;oe<G;oe++)u[B+oe]=N[oe]}else u.push(N)}}class T{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function x(u){return/^[\s\xa0]*$/.test(u)}function _(){var u=l.navigator;return u&&(u=u.userAgent)?u:""}function O(u){return O[" "](u),u}O[" "]=function(){};var j=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function L(u,p,g){for(const N in u)p.call(g,u[N],N,u)}function E(u,p){for(const g in u)p.call(void 0,u[g],g,u)}function v(u){const p={};for(const g in u)p[g]=u[g];return p}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(u,p){let g,N;for(let B=1;B<arguments.length;B++){N=arguments[B];for(g in N)u[g]=N[g];for(let G=0;G<I.length;G++)g=I[G],Object.prototype.hasOwnProperty.call(N,g)&&(u[g]=N[g])}}function P(u){var p=1;u=u.split(":");const g=[];for(;0<p&&u.length;)g.push(u.shift()),p--;return u.length&&g.push(u.join(":")),g}function M(u){l.setTimeout(()=>{throw u},0)}function S(){var u=$;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class Z{constructor(){this.h=this.g=null}add(p,g){const N=U.get();N.set(p,g),this.h?this.h.next=N:this.g=N,this.h=N}}var U=new T(()=>new q,u=>u.reset());class q{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let V,D=!1,$=new Z,W=()=>{const u=l.Promise.resolve(void 0);V=()=>{u.then(ne)}};var ne=()=>{for(var u;u=S();){try{u.h.call(u.g)}catch(g){M(g)}var p=U;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}D=!1};function se(){this.s=this.s,this.C=this.C}se.prototype.s=!1,se.prototype.ma=function(){this.s||(this.s=!0,this.N())},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ce(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}ce.prototype.h=function(){this.defaultPrevented=!0};var F=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const g=()=>{};l.addEventListener("test",g,p),l.removeEventListener("test",g,p)}catch{}return u}();function H(u,p){if(ce.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var g=this.type=u.type,N=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(j){e:{try{O(p.nodeName);var B=!0;break e}catch{}B=!1}B||(p=null)}}else g=="mouseover"?p=u.fromElement:g=="mouseout"&&(p=u.toElement);this.relatedTarget=p,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:b[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&H.aa.h.call(this)}}C(H,ce);var b={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Q="closure_listenable_"+(1e6*Math.random()|0),z=0;function J(u,p,g,N,B){this.listener=u,this.proxy=null,this.src=p,this.type=g,this.capture=!!N,this.ha=B,this.key=++z,this.da=this.fa=!1}function ee(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function K(u){this.src=u,this.g={},this.h=0}K.prototype.add=function(u,p,g,N,B){var G=u.toString();u=this.g[G],u||(u=this.g[G]=[],this.h++);var oe=_e(u,p,N,B);return-1<oe?(p=u[oe],g||(p.fa=!1)):(p=new J(p,this.src,G,!!N,B),p.fa=g,u.push(p)),p};function ie(u,p){var g=p.type;if(g in u.g){var N=u.g[g],B=Array.prototype.indexOf.call(N,p,void 0),G;(G=0<=B)&&Array.prototype.splice.call(N,B,1),G&&(ee(p),u.g[g].length==0&&(delete u.g[g],u.h--))}}function _e(u,p,g,N){for(var B=0;B<u.length;++B){var G=u[B];if(!G.da&&G.listener==p&&G.capture==!!g&&G.ha==N)return B}return-1}var Pe="closure_lm_"+(1e6*Math.random()|0),De={};function vt(u,p,g,N,B){if(Array.isArray(p)){for(var G=0;G<p.length;G++)vt(u,p[G],g,N,B);return null}return g=Jy(g),u&&u[Q]?u.K(p,g,d(N)?!!N.capture:!1,B):vn(u,p,g,!1,N,B)}function vn(u,p,g,N,B,G){if(!p)throw Error("Invalid event type");var oe=d(B)?!!B.capture:!!B,Fe=yh(u);if(Fe||(u[Pe]=Fe=new K(u)),g=Fe.add(p,g,N,oe,G),g.proxy)return g;if(N=ar(),g.proxy=N,N.src=u,N.listener=g,u.addEventListener)F||(B=oe),B===void 0&&(B=!1),u.addEventListener(p.toString(),N,B);else if(u.attachEvent)u.attachEvent(nc(p.toString()),N);else if(u.addListener&&u.removeListener)u.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return g}function ar(){function u(g){return p.call(u.src,u.listener,g)}const p=VT;return u}function Ds(u,p,g,N,B){if(Array.isArray(p))for(var G=0;G<p.length;G++)Ds(u,p[G],g,N,B);else N=d(N)?!!N.capture:!!N,g=Jy(g),u&&u[Q]?(u=u.i,p=String(p).toString(),p in u.g&&(G=u.g[p],g=_e(G,g,N,B),-1<g&&(ee(G[g]),Array.prototype.splice.call(G,g,1),G.length==0&&(delete u.g[p],u.h--)))):u&&(u=yh(u))&&(p=u.g[p.toString()],u=-1,p&&(u=_e(p,g,N,B)),(g=-1<u?p[u]:null)&&qo(g))}function qo(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[Q])ie(p.i,u);else{var g=u.type,N=u.proxy;p.removeEventListener?p.removeEventListener(g,N,u.capture):p.detachEvent?p.detachEvent(nc(g),N):p.addListener&&p.removeListener&&p.removeListener(N),(g=yh(p))?(ie(g,u),g.h==0&&(g.src=null,p[Pe]=null)):ee(u)}}}function nc(u){return u in De?De[u]:De[u]="on"+u}function VT(u,p){if(u.da)u=!0;else{p=new H(p,this);var g=u.listener,N=u.ha||u.src;u.fa&&qo(u),u=g.call(N,p)}return u}function yh(u){return u=u[Pe],u instanceof K?u:null}var vh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Jy(u){return typeof u=="function"?u:(u[vh]||(u[vh]=function(p){return u.handleEvent(p)}),u[vh])}function Dt(){se.call(this),this.i=new K(this),this.M=this,this.F=null}C(Dt,se),Dt.prototype[Q]=!0,Dt.prototype.removeEventListener=function(u,p,g,N){Ds(this,u,p,g,N)};function Ht(u,p){var g,N=u.F;if(N)for(g=[];N;N=N.F)g.push(N);if(u=u.M,N=p.type||p,typeof p=="string")p=new ce(p,u);else if(p instanceof ce)p.target=p.target||u;else{var B=p;p=new ce(N,u),A(p,B)}if(B=!0,g)for(var G=g.length-1;0<=G;G--){var oe=p.g=g[G];B=rc(oe,N,!0,p)&&B}if(oe=p.g=u,B=rc(oe,N,!0,p)&&B,B=rc(oe,N,!1,p)&&B,g)for(G=0;G<g.length;G++)oe=p.g=g[G],B=rc(oe,N,!1,p)&&B}Dt.prototype.N=function(){if(Dt.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var g=u.g[p],N=0;N<g.length;N++)ee(g[N]);delete u.g[p],u.h--}}this.F=null},Dt.prototype.K=function(u,p,g,N){return this.i.add(String(u),p,!1,g,N)},Dt.prototype.L=function(u,p,g,N){return this.i.add(String(u),p,!0,g,N)};function rc(u,p,g,N){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var B=!0,G=0;G<p.length;++G){var oe=p[G];if(oe&&!oe.da&&oe.capture==g){var Fe=oe.listener,It=oe.ha||oe.src;oe.fa&&ie(u.i,oe),B=Fe.call(It,N)!==!1&&B}}return B&&!N.defaultPrevented}function Xy(u,p,g){if(typeof u=="function")g&&(u=m(u,g));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:l.setTimeout(u,p||0)}function Zy(u){u.g=Xy(()=>{u.g=null,u.i&&(u.i=!1,Zy(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class UT extends se{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Zy(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wo(u){se.call(this),this.h=u,this.g={}}C(Wo,se);var ev=[];function tv(u){L(u.g,function(p,g){this.g.hasOwnProperty(g)&&qo(p)},u),u.g={}}Wo.prototype.N=function(){Wo.aa.N.call(this),tv(this)},Wo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _h=l.JSON.stringify,$T=l.JSON.parse,BT=class{stringify(u){return l.JSON.stringify(u,void 0)}parse(u){return l.JSON.parse(u,void 0)}};function wh(){}wh.prototype.h=null;function nv(u){return u.h||(u.h=u.i())}function rv(){}var Ho={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xh(){ce.call(this,"d")}C(xh,ce);function Eh(){ce.call(this,"c")}C(Eh,ce);var Ls={},sv=null;function sc(){return sv=sv||new Dt}Ls.La="serverreachability";function iv(u){ce.call(this,Ls.La,u)}C(iv,ce);function Go(u){const p=sc();Ht(p,new iv(p))}Ls.STAT_EVENT="statevent";function ov(u,p){ce.call(this,Ls.STAT_EVENT,u),this.stat=p}C(ov,ce);function Gt(u){const p=sc();Ht(p,new ov(p,u))}Ls.Ma="timingevent";function av(u,p){ce.call(this,Ls.Ma,u),this.size=p}C(av,ce);function Ko(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){u()},p)}function Qo(){this.g=!0}Qo.prototype.xa=function(){this.g=!1};function zT(u,p,g,N,B,G){u.info(function(){if(u.g)if(G)for(var oe="",Fe=G.split("&"),It=0;It<Fe.length;It++){var ke=Fe[It].split("=");if(1<ke.length){var Lt=ke[0];ke=ke[1];var Ot=Lt.split("_");oe=2<=Ot.length&&Ot[1]=="type"?oe+(Lt+"="+ke+"&"):oe+(Lt+"=redacted&")}}else oe=null;else oe=G;return"XMLHTTP REQ ("+N+") [attempt "+B+"]: "+p+`
`+g+`
`+oe})}function qT(u,p,g,N,B,G,oe){u.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+B+"]: "+p+`
`+g+`
`+G+" "+oe})}function Ci(u,p,g,N){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+HT(u,g)+(N?" "+N:"")})}function WT(u,p){u.info(function(){return"TIMEOUT: "+p})}Qo.prototype.info=function(){};function HT(u,p){if(!u.g)return p;if(!p)return null;try{var g=JSON.parse(p);if(g){for(u=0;u<g.length;u++)if(Array.isArray(g[u])){var N=g[u];if(!(2>N.length)){var B=N[1];if(Array.isArray(B)&&!(1>B.length)){var G=B[0];if(G!="noop"&&G!="stop"&&G!="close")for(var oe=1;oe<B.length;oe++)B[oe]=""}}}}return _h(g)}catch{return p}}var ic={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},lv={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Sh;function oc(){}C(oc,wh),oc.prototype.g=function(){return new XMLHttpRequest},oc.prototype.i=function(){return{}},Sh=new oc;function Vr(u,p,g,N){this.j=u,this.i=p,this.l=g,this.R=N||1,this.U=new Wo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new cv}function cv(){this.i=null,this.g="",this.h=!1}var uv={},Ch={};function Ih(u,p,g){u.L=1,u.v=uc(lr(p)),u.m=g,u.P=!0,dv(u,null)}function dv(u,p){u.F=Date.now(),ac(u),u.A=lr(u.v);var g=u.A,N=u.R;Array.isArray(N)||(N=[String(N)]),Iv(g.i,"t",N),u.C=0,g=u.j.J,u.h=new cv,u.g=zv(u.j,g?p:null,!u.m),0<u.O&&(u.M=new UT(m(u.Y,u,u.g),u.O)),p=u.U,g=u.g,N=u.ca;var B="readystatechange";Array.isArray(B)||(B&&(ev[0]=B.toString()),B=ev);for(var G=0;G<B.length;G++){var oe=vt(g,B[G],N||p.handleEvent,!1,p.h||p);if(!oe)break;p.g[oe.key]=oe}p=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),Go(),zT(u.i,u.u,u.A,u.l,u.R,u.m)}Vr.prototype.ca=function(u){u=u.target;const p=this.M;p&&cr(u)==3?p.j():this.Y(u)},Vr.prototype.Y=function(u){try{if(u==this.g)e:{const Ot=cr(this.g);var p=this.g.Ba();const bi=this.g.Z();if(!(3>Ot)&&(Ot!=3||this.g&&(this.h.h||this.g.oa()||Pv(this.g)))){this.J||Ot!=4||p==7||(p==8||0>=bi?Go(3):Go(2)),Th(this);var g=this.g.Z();this.X=g;t:if(hv(this)){var N=Pv(this.g);u="";var B=N.length,G=cr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Os(this),Yo(this);var oe="";break t}this.h.i=new l.TextDecoder}for(p=0;p<B;p++)this.h.h=!0,u+=this.h.i.decode(N[p],{stream:!(G&&p==B-1)});N.length=0,this.h.g+=u,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=g==200,qT(this.i,this.u,this.A,this.l,this.R,Ot,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Fe,It=this.g;if((Fe=It.g?It.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(Fe)){var ke=Fe;break t}}ke=null}if(g=ke)Ci(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,bh(this,g);else{this.o=!1,this.s=3,Gt(12),Os(this),Yo(this);break e}}if(this.P){g=!0;let Rn;for(;!this.J&&this.C<oe.length;)if(Rn=GT(this,oe),Rn==Ch){Ot==4&&(this.s=4,Gt(14),g=!1),Ci(this.i,this.l,null,"[Incomplete Response]");break}else if(Rn==uv){this.s=4,Gt(15),Ci(this.i,this.l,oe,"[Invalid Chunk]"),g=!1;break}else Ci(this.i,this.l,Rn,null),bh(this,Rn);if(hv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ot!=4||oe.length!=0||this.h.h||(this.s=1,Gt(16),g=!1),this.o=this.o&&g,!g)Ci(this.i,this.l,oe,"[Invalid Chunked Response]"),Os(this),Yo(this);else if(0<oe.length&&!this.W){this.W=!0;var Lt=this.j;Lt.g==this&&Lt.ba&&!Lt.M&&(Lt.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),jh(Lt),Lt.M=!0,Gt(11))}}else Ci(this.i,this.l,oe,null),bh(this,oe);Ot==4&&Os(this),this.o&&!this.J&&(Ot==4?Vv(this.j,this):(this.o=!1,ac(this)))}else ub(this.g),g==400&&0<oe.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),Os(this),Yo(this)}}}catch{}finally{}};function hv(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function GT(u,p){var g=u.C,N=p.indexOf(`
`,g);return N==-1?Ch:(g=Number(p.substring(g,N)),isNaN(g)?uv:(N+=1,N+g>p.length?Ch:(p=p.slice(N,N+g),u.C=N+g,p)))}Vr.prototype.cancel=function(){this.J=!0,Os(this)};function ac(u){u.S=Date.now()+u.I,fv(u,u.I)}function fv(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ko(m(u.ba,u),p)}function Th(u){u.B&&(l.clearTimeout(u.B),u.B=null)}Vr.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(WT(this.i,this.A),this.L!=2&&(Go(),Gt(17)),Os(this),this.s=2,Yo(this)):fv(this,this.S-u)};function Yo(u){u.j.G==0||u.J||Vv(u.j,u)}function Os(u){Th(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,tv(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function bh(u,p){try{var g=u.j;if(g.G!=0&&(g.g==u||Nh(g.h,u))){if(!u.K&&Nh(g.h,u)&&g.G==3){try{var N=g.Da.g.parse(p)}catch{N=null}if(Array.isArray(N)&&N.length==3){var B=N;if(B[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<u.F)gc(g),pc(g);else break e;Ph(g),Gt(18)}}else g.za=B[1],0<g.za-g.T&&37500>B[2]&&g.F&&g.v==0&&!g.C&&(g.C=Ko(m(g.Za,g),6e3));if(1>=gv(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Fs(g,11)}else if((u.K||g.g==u)&&gc(g),!x(p))for(B=g.Da.g.parse(p),p=0;p<B.length;p++){let ke=B[p];if(g.T=ke[0],ke=ke[1],g.G==2)if(ke[0]=="c"){g.K=ke[1],g.ia=ke[2];const Lt=ke[3];Lt!=null&&(g.la=Lt,g.j.info("VER="+g.la));const Ot=ke[4];Ot!=null&&(g.Aa=Ot,g.j.info("SVER="+g.Aa));const bi=ke[5];bi!=null&&typeof bi=="number"&&0<bi&&(N=1.5*bi,g.L=N,g.j.info("backChannelRequestTimeoutMs_="+N)),N=g;const Rn=u.g;if(Rn){const vc=Rn.g?Rn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vc){var G=N.h;G.g||vc.indexOf("spdy")==-1&&vc.indexOf("quic")==-1&&vc.indexOf("h2")==-1||(G.j=G.l,G.g=new Set,G.h&&(kh(G,G.h),G.h=null))}if(N.D){const Dh=Rn.g?Rn.g.getResponseHeader("X-HTTP-Session-Id"):null;Dh&&(N.ya=Dh,ze(N.I,N.D,Dh))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-u.F,g.j.info("Handshake RTT: "+g.R+"ms")),N=g;var oe=u;if(N.qa=Bv(N,N.J?N.ia:null,N.W),oe.K){yv(N.h,oe);var Fe=oe,It=N.L;It&&(Fe.I=It),Fe.B&&(Th(Fe),ac(Fe)),N.g=oe}else Mv(N);0<g.i.length&&mc(g)}else ke[0]!="stop"&&ke[0]!="close"||Fs(g,7);else g.G==3&&(ke[0]=="stop"||ke[0]=="close"?ke[0]=="stop"?Fs(g,7):Ah(g):ke[0]!="noop"&&g.l&&g.l.ta(ke),g.v=0)}}Go(4)}catch{}}var KT=class{constructor(u,p){this.g=u,this.map=p}};function pv(u){this.l=u||10,l.PerformanceNavigationTiming?(u=l.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mv(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function gv(u){return u.h?1:u.g?u.g.size:0}function Nh(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function kh(u,p){u.g?u.g.add(p):u.h=p}function yv(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}pv.prototype.cancel=function(){if(this.i=vv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function vv(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const g of u.g.values())p=p.concat(g.D);return p}return w(u.i)}function QT(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var p=[],g=u.length,N=0;N<g;N++)p.push(u[N]);return p}p=[],g=0;for(N in u)p[g++]=u[N];return p}function YT(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var p=[];u=u.length;for(var g=0;g<u;g++)p.push(g);return p}p=[],g=0;for(const N in u)p[g++]=N;return p}}}function _v(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var g=YT(u),N=QT(u),B=N.length,G=0;G<B;G++)p.call(void 0,N[G],g&&g[G],u)}var wv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function JT(u,p){if(u){u=u.split("&");for(var g=0;g<u.length;g++){var N=u[g].indexOf("="),B=null;if(0<=N){var G=u[g].substring(0,N);B=u[g].substring(N+1)}else G=u[g];p(G,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function Ms(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Ms){this.h=u.h,lc(this,u.j),this.o=u.o,this.g=u.g,cc(this,u.s),this.l=u.l;var p=u.i,g=new Zo;g.i=p.i,p.g&&(g.g=new Map(p.g),g.h=p.h),xv(this,g),this.m=u.m}else u&&(p=String(u).match(wv))?(this.h=!1,lc(this,p[1]||"",!0),this.o=Jo(p[2]||""),this.g=Jo(p[3]||"",!0),cc(this,p[4]),this.l=Jo(p[5]||"",!0),xv(this,p[6]||"",!0),this.m=Jo(p[7]||"")):(this.h=!1,this.i=new Zo(null,this.h))}Ms.prototype.toString=function(){var u=[],p=this.j;p&&u.push(Xo(p,Ev,!0),":");var g=this.g;return(g||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Xo(p,Ev,!0),"@"),u.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&u.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&u.push("/"),u.push(Xo(g,g.charAt(0)=="/"?eb:ZT,!0))),(g=this.i.toString())&&u.push("?",g),(g=this.m)&&u.push("#",Xo(g,nb)),u.join("")};function lr(u){return new Ms(u)}function lc(u,p,g){u.j=g?Jo(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function cc(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function xv(u,p,g){p instanceof Zo?(u.i=p,rb(u.i,u.h)):(g||(p=Xo(p,tb)),u.i=new Zo(p,u.h))}function ze(u,p,g){u.i.set(p,g)}function uc(u){return ze(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Jo(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Xo(u,p,g){return typeof u=="string"?(u=encodeURI(u).replace(p,XT),g&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function XT(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Ev=/[#\/\?@]/g,ZT=/[#\?:]/g,eb=/[#\?]/g,tb=/[#\?@]/g,nb=/#/g;function Zo(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Ur(u){u.g||(u.g=new Map,u.h=0,u.i&&JT(u.i,function(p,g){u.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}t=Zo.prototype,t.add=function(u,p){Ur(this),this.i=null,u=Ii(this,u);var g=this.g.get(u);return g||this.g.set(u,g=[]),g.push(p),this.h+=1,this};function Sv(u,p){Ur(u),p=Ii(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function Cv(u,p){return Ur(u),p=Ii(u,p),u.g.has(p)}t.forEach=function(u,p){Ur(this),this.g.forEach(function(g,N){g.forEach(function(B){u.call(p,B,N,this)},this)},this)},t.na=function(){Ur(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),g=[];for(let N=0;N<p.length;N++){const B=u[N];for(let G=0;G<B.length;G++)g.push(p[N])}return g},t.V=function(u){Ur(this);let p=[];if(typeof u=="string")Cv(this,u)&&(p=p.concat(this.g.get(Ii(this,u))));else{u=Array.from(this.g.values());for(let g=0;g<u.length;g++)p=p.concat(u[g])}return p},t.set=function(u,p){return Ur(this),this.i=null,u=Ii(this,u),Cv(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function Iv(u,p,g){Sv(u,p),0<g.length&&(u.i=null,u.g.set(Ii(u,p),w(g)),u.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var g=0;g<p.length;g++){var N=p[g];const G=encodeURIComponent(String(N)),oe=this.V(N);for(N=0;N<oe.length;N++){var B=G;oe[N]!==""&&(B+="="+encodeURIComponent(String(oe[N]))),u.push(B)}}return this.i=u.join("&")};function Ii(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function rb(u,p){p&&!u.j&&(Ur(u),u.i=null,u.g.forEach(function(g,N){var B=N.toLowerCase();N!=B&&(Sv(this,N),Iv(this,B,g))},u)),u.j=p}function sb(u,p){const g=new Qo;if(l.Image){const N=new Image;N.onload=y($r,g,"TestLoadImage: loaded",!0,p,N),N.onerror=y($r,g,"TestLoadImage: error",!1,p,N),N.onabort=y($r,g,"TestLoadImage: abort",!1,p,N),N.ontimeout=y($r,g,"TestLoadImage: timeout",!1,p,N),l.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=u}else p(!1)}function ib(u,p){const g=new Qo,N=new AbortController,B=setTimeout(()=>{N.abort(),$r(g,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:N.signal}).then(G=>{clearTimeout(B),G.ok?$r(g,"TestPingServer: ok",!0,p):$r(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(B),$r(g,"TestPingServer: error",!1,p)})}function $r(u,p,g,N,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),N(g)}catch{}}function ob(){this.g=new BT}function ab(u,p,g){const N=g||"";try{_v(u,function(B,G){let oe=B;d(B)&&(oe=_h(B)),p.push(N+G+"="+encodeURIComponent(oe))})}catch(B){throw p.push(N+"type="+encodeURIComponent("_badmap")),B}}function dc(u){this.l=u.Ub||null,this.j=u.eb||!1}C(dc,wh),dc.prototype.g=function(){return new hc(this.l,this.j)},dc.prototype.i=function(u){return function(){return u}}({});function hc(u,p){Dt.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(hc,Dt),t=hc.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,ta(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||l).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ea(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,ta(this)),this.g&&(this.readyState=3,ta(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Tv(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Tv(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?ea(this):ta(this),this.readyState==3&&Tv(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,ea(this))},t.Qa=function(u){this.g&&(this.response=u,ea(this))},t.ga=function(){this.g&&ea(this)};function ea(u){u.readyState=4,u.l=null,u.j=null,u.v=null,ta(u)}t.setRequestHeader=function(u,p){this.u.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,u.push(g[0]+": "+g[1]),g=p.next();return u.join(`\r
`)};function ta(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(hc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function bv(u){let p="";return L(u,function(g,N){p+=N,p+=":",p+=g,p+=`\r
`}),p}function Rh(u,p,g){e:{for(N in g){var N=!1;break e}N=!0}N||(g=bv(g),typeof u=="string"?g!=null&&encodeURIComponent(String(g)):ze(u,p,g))}function Xe(u){Dt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Xe,Dt);var lb=/^https?$/i,cb=["POST","PUT"];t=Xe.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,p,g,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Sh.g(),this.v=this.o?nv(this.o):nv(Sh),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(G){Nv(this,G);return}if(u=g||"",g=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var B in N)g.set(B,N[B]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const G of N.keys())g.set(G,N.get(G));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(g.keys()).find(G=>G.toLowerCase()=="content-type"),B=l.FormData&&u instanceof l.FormData,!(0<=Array.prototype.indexOf.call(cb,p,void 0))||N||B||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[G,oe]of g)this.g.setRequestHeader(G,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Av(this),this.u=!0,this.g.send(u),this.u=!1}catch(G){Nv(this,G)}};function Nv(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,kv(u),fc(u)}function kv(u){u.A||(u.A=!0,Ht(u,"complete"),Ht(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ht(this,"complete"),Ht(this,"abort"),fc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fc(this,!0)),Xe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rv(this):this.bb())},t.bb=function(){Rv(this)};function Rv(u){if(u.h&&typeof o<"u"&&(!u.v[1]||cr(u)!=4||u.Z()!=2)){if(u.u&&cr(u)==4)Xy(u.Ea,0,u);else if(Ht(u,"readystatechange"),cr(u)==4){u.h=!1;try{const oe=u.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var N;if(N=oe===0){var B=String(u.D).match(wv)[1]||null;!B&&l.self&&l.self.location&&(B=l.self.location.protocol.slice(0,-1)),N=!lb.test(B?B.toLowerCase():"")}g=N}if(g)Ht(u,"complete"),Ht(u,"success");else{u.m=6;try{var G=2<cr(u)?u.g.statusText:""}catch{G=""}u.l=G+" ["+u.Z()+"]",kv(u)}}finally{fc(u)}}}}function fc(u,p){if(u.g){Av(u);const g=u.g,N=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||Ht(u,"ready");try{g.onreadystatechange=N}catch{}}}function Av(u){u.I&&(l.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function cr(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<cr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),$T(p)}};function Pv(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function ub(u){const p={};u=(u.g&&2<=cr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<u.length;N++){if(x(u[N]))continue;var g=P(u[N]);const B=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const G=p[B]||[];p[B]=G,G.push(g)}E(p,function(N){return N.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function na(u,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[u]||p}function jv(u){this.Aa=0,this.i=[],this.j=new Qo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=na("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=na("baseRetryDelayMs",5e3,u),this.cb=na("retryDelaySeedMs",1e4,u),this.Wa=na("forwardChannelMaxRetries",2,u),this.wa=na("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new pv(u&&u.concurrentRequestLimit),this.Da=new ob,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=jv.prototype,t.la=8,t.G=1,t.connect=function(u,p,g,N){Gt(0),this.W=u,this.H=p||{},g&&N!==void 0&&(this.H.OSID=g,this.H.OAID=N),this.F=this.X,this.I=Bv(this,null,this.W),mc(this)};function Ah(u){if(Dv(u),u.G==3){var p=u.U++,g=lr(u.I);if(ze(g,"SID",u.K),ze(g,"RID",p),ze(g,"TYPE","terminate"),ra(u,g),p=new Vr(u,u.j,p),p.L=2,p.v=uc(lr(g)),g=!1,l.navigator&&l.navigator.sendBeacon)try{g=l.navigator.sendBeacon(p.v.toString(),"")}catch{}!g&&l.Image&&(new Image().src=p.v,g=!0),g||(p.g=zv(p.j,null),p.g.ea(p.v)),p.F=Date.now(),ac(p)}$v(u)}function pc(u){u.g&&(jh(u),u.g.cancel(),u.g=null)}function Dv(u){pc(u),u.u&&(l.clearTimeout(u.u),u.u=null),gc(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&l.clearTimeout(u.s),u.s=null)}function mc(u){if(!mv(u.h)&&!u.s){u.s=!0;var p=u.Ga;V||W(),D||(V(),D=!0),$.add(p,u),u.B=0}}function db(u,p){return gv(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ko(m(u.Ga,u,p),Uv(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const B=new Vr(this,this.j,u);let G=this.o;if(this.S&&(G?(G=v(G),A(G,this.S)):G=this.S),this.m!==null||this.O||(B.H=G,G=null),this.P)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var N=this.i[g];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(p+=N,4096<p){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=Ov(this,B,p),g=lr(this.I),ze(g,"RID",u),ze(g,"CVER",22),this.D&&ze(g,"X-HTTP-Session-Id",this.D),ra(this,g),G&&(this.O?p="headers="+encodeURIComponent(String(bv(G)))+"&"+p:this.m&&Rh(g,this.m,G)),kh(this.h,B),this.Ua&&ze(g,"TYPE","init"),this.P?(ze(g,"$req",p),ze(g,"SID","null"),B.T=!0,Ih(B,g,null)):Ih(B,g,p),this.G=2}}else this.G==3&&(u?Lv(this,u):this.i.length==0||mv(this.h)||Lv(this))};function Lv(u,p){var g;p?g=p.l:g=u.U++;const N=lr(u.I);ze(N,"SID",u.K),ze(N,"RID",g),ze(N,"AID",u.T),ra(u,N),u.m&&u.o&&Rh(N,u.m,u.o),g=new Vr(u,u.j,g,u.B+1),u.m===null&&(g.H=u.o),p&&(u.i=p.D.concat(u.i)),p=Ov(u,g,1e3),g.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),kh(u.h,g),Ih(g,N,p)}function ra(u,p){u.H&&L(u.H,function(g,N){ze(p,N,g)}),u.l&&_v({},function(g,N){ze(p,N,g)})}function Ov(u,p,g){g=Math.min(u.i.length,g);var N=u.l?m(u.l.Na,u.l,u):null;e:{var B=u.i;let G=-1;for(;;){const oe=["count="+g];G==-1?0<g?(G=B[0].g,oe.push("ofs="+G)):G=0:oe.push("ofs="+G);let Fe=!0;for(let It=0;It<g;It++){let ke=B[It].g;const Lt=B[It].map;if(ke-=G,0>ke)G=Math.max(0,B[It].g-100),Fe=!1;else try{ab(Lt,oe,"req"+ke+"_")}catch{N&&N(Lt)}}if(Fe){N=oe.join("&");break e}}}return u=u.i.splice(0,g),p.D=u,N}function Mv(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;V||W(),D||(V(),D=!0),$.add(p,u),u.v=0}}function Ph(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ko(m(u.Fa,u),Uv(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Fv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ko(m(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Gt(10),pc(this),Fv(this))};function jh(u){u.A!=null&&(l.clearTimeout(u.A),u.A=null)}function Fv(u){u.g=new Vr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=lr(u.qa);ze(p,"RID","rpc"),ze(p,"SID",u.K),ze(p,"AID",u.T),ze(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&ze(p,"TO",u.ja),ze(p,"TYPE","xmlhttp"),ra(u,p),u.m&&u.o&&Rh(p,u.m,u.o),u.L&&(u.g.I=u.L);var g=u.g;u=u.ia,g.L=1,g.v=uc(lr(p)),g.m=null,g.P=!0,dv(g,u)}t.Za=function(){this.C!=null&&(this.C=null,pc(this),Ph(this),Gt(19))};function gc(u){u.C!=null&&(l.clearTimeout(u.C),u.C=null)}function Vv(u,p){var g=null;if(u.g==p){gc(u),jh(u),u.g=null;var N=2}else if(Nh(u.h,p))g=p.D,yv(u.h,p),N=1;else return;if(u.G!=0){if(p.o)if(N==1){g=p.m?p.m.length:0,p=Date.now()-p.F;var B=u.B;N=sc(),Ht(N,new av(N,g)),mc(u)}else Mv(u);else if(B=p.s,B==3||B==0&&0<p.X||!(N==1&&db(u,p)||N==2&&Ph(u)))switch(g&&0<g.length&&(p=u.h,p.i=p.i.concat(g)),B){case 1:Fs(u,5);break;case 4:Fs(u,10);break;case 3:Fs(u,6);break;default:Fs(u,2)}}}function Uv(u,p){let g=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(g*=2),g*p}function Fs(u,p){if(u.j.info("Error code "+p),p==2){var g=m(u.fb,u),N=u.Xa;const B=!N;N=new Ms(N||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||lc(N,"https"),uc(N),B?sb(N.toString(),g):ib(N.toString(),g)}else Gt(2);u.G=0,u.l&&u.l.sa(p),$v(u),Dv(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function $v(u){if(u.G=0,u.ka=[],u.l){const p=vv(u.h);(p.length!=0||u.i.length!=0)&&(R(u.ka,p),R(u.ka,u.i),u.h.i.length=0,w(u.i),u.i.length=0),u.l.ra()}}function Bv(u,p,g){var N=g instanceof Ms?lr(g):new Ms(g);if(N.g!="")p&&(N.g=p+"."+N.g),cc(N,N.s);else{var B=l.location;N=B.protocol,p=p?p+"."+B.hostname:B.hostname,B=+B.port;var G=new Ms(null);N&&lc(G,N),p&&(G.g=p),B&&cc(G,B),g&&(G.l=g),N=G}return g=u.D,p=u.ya,g&&p&&ze(N,g,p),ze(N,"VER",u.la),ra(u,N),N}function zv(u,p,g){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new Xe(new dc({eb:g})):new Xe(u.pa),p.Ha(u.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function qv(){}t=qv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function yc(){}yc.prototype.g=function(u,p){return new cn(u,p)};function cn(u,p){Dt.call(this),this.g=new jv(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!x(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!x(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Ti(this)}C(cn,Dt),cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Ah(this.g)},cn.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var g={};g.__data__=u,u=g}else this.u&&(g={},g.__data__=_h(u),u=g);p.i.push(new KT(p.Ya++,u)),p.G==3&&mc(p)},cn.prototype.N=function(){this.g.l=null,delete this.j,Ah(this.g),delete this.g,cn.aa.N.call(this)};function Wv(u){xh.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const g in p){u=g;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}C(Wv,xh);function Hv(){Eh.call(this),this.status=1}C(Hv,Eh);function Ti(u){this.g=u}C(Ti,qv),Ti.prototype.ua=function(){Ht(this.g,"a")},Ti.prototype.ta=function(u){Ht(this.g,new Wv(u))},Ti.prototype.sa=function(u){Ht(this.g,new Hv)},Ti.prototype.ra=function(){Ht(this.g,"b")},yc.prototype.createWebChannel=yc.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,fC=function(){return new yc},hC=function(){return sc()},dC=Ls,Op={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ic.NO_ERROR=0,ic.TIMEOUT=8,ic.HTTP_ERROR=6,nu=ic,lv.COMPLETE="complete",uC=lv,rv.EventType=Ho,Ho.OPEN="a",Ho.CLOSE="b",Ho.ERROR="c",Ho.MESSAGE="d",Dt.prototype.listen=Dt.prototype.K,Ia=rv,Xe.prototype.listenOnce=Xe.prototype.L,Xe.prototype.getLastError=Xe.prototype.Ka,Xe.prototype.getLastErrorCode=Xe.prototype.Ba,Xe.prototype.getStatus=Xe.prototype.Z,Xe.prototype.getResponseJson=Xe.prototype.Oa,Xe.prototype.getResponseText=Xe.prototype.oa,Xe.prototype.send=Xe.prototype.ea,Xe.prototype.setWithCredentials=Xe.prototype.Ha,cC=Xe}).apply(typeof Mc<"u"?Mc:typeof self<"u"?self:typeof window<"u"?window:{});const x0="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi=new Fd("@firebase/firestore");function ha(){return oi.logLevel}function ue(t,...e){if(oi.logLevel<=Ie.DEBUG){const n=e.map(Cg);oi.debug(`Firestore (${Lo}): ${t}`,...n)}}function Rr(t,...e){if(oi.logLevel<=Ie.ERROR){const n=e.map(Cg);oi.error(`Firestore (${Lo}): ${t}`,...n)}}function go(t,...e){if(oi.logLevel<=Ie.WARN){const n=e.map(Cg);oi.warn(`Firestore (${Lo}): ${t}`,...n)}}function Cg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(t="Unexpected state"){const e=`FIRESTORE (${Lo}) INTERNAL ASSERTION FAILED: `+t;throw Rr(e),new Error(e)}function Oe(t,e){t||ge()}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class le extends Or{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class j2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ut.UNAUTHENTICATED))}shutdown(){}}class D2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class L2{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Oe(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Er,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Er)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Oe(typeof r.accessToken=="string"),new pC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Oe(e===null||typeof e=="string"),new Ut(e)}}class O2{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class M2{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new O2(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class F2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class V2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Oe(this.o===void 0);const r=i=>{i.error!=null&&ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,ue("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Oe(typeof n.token=="string"),this.R=n.token,new F2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=U2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Re(t,e){return t<e?-1:t>e?1:0}function yo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new le(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new le(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new le(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new le(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return yt.fromMillis(Date.now())}static fromDate(e){return yt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new yt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Re(this.nanoseconds,e.nanoseconds):Re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ye(e)}static min(){return new ye(new yt(0,0))}static max(){return new ye(new yt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,n,r){n===void 0?n=0:n>e.length&&ge(),r===void 0?r=e.length-n:r>e.length-n&&ge(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ml.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ml?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class We extends ml{construct(e,n,r){return new We(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new le(Y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new We(n)}static emptyPath(){return new We([])}}const $2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nt extends ml{construct(e,n,r){return new Nt(e,n,r)}static isValidIdentifier(e){return $2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Nt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new le(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new le(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new le(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new le(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nt(n)}static emptyPath(){return new Nt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.path=e}static fromPath(e){return new he(We.fromString(e))}static fromName(e){return new he(We.fromString(e).popFirst(5))}static empty(){return new he(We.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&We.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return We.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new We(e.slice()))}}function B2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ye.fromTimestamp(r===1e9?new yt(n+1,0):new yt(n,r));return new Es(s,he.empty(),e)}function z2(t){return new Es(t.readTime,t.key,-1)}class Es{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Es(ye.min(),he.empty(),-1)}static max(){return new Es(ye.max(),he.empty(),-1)}}function q2(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=he.comparator(t.documentKey,e.documentKey),n!==0?n:Re(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class H2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ml(t){if(t.code!==Y.FAILED_PRECONDITION||t.message!==W2)throw t;ue("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ge(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new X((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof X?n:X.resolve(n)}catch(n){return X.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):X.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):X.reject(n)}static resolve(e){return new X((n,r)=>{n(e)})}static reject(e){return new X((n,r)=>{r(e)})}static waitFor(e){return new X((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=X.resolve(!1);for(const r of e)n=n.next(s=>s?X.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new X((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++l,l===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new X((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function G2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Fl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Ig.oe=-1;function Ud(t){return t==null}function zu(t){return t===0&&1/t==-1/0}function K2(t){return typeof t=="number"&&Number.isInteger(t)&&!zu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function vi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ut=class Mp{constructor(e,n){this.comparator=e,this.root=n||ps.EMPTY}insert(e,n){return new Mp(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ps.BLACK,null,null))}remove(e){return new Mp(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ps.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fc(this.root,e,this.comparator,!0)}},Fc=class{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ps=class ur{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ur.RED,this.left=s??ur.EMPTY,this.right=i??ur.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ur(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ur.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ur.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ur.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ur.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ge();const e=this.left.check();if(e!==this.right.check())throw ge();return e+(this.isRed()?0:1)}};ps.EMPTY=null,ps.RED=!0,ps.BLACK=!1;ps.EMPTY=new class{constructor(){this.size=0}get key(){throw ge()}get value(){throw ge()}get color(){throw ge()}get left(){throw ge()}get right(){throw ge()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ps(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.comparator=e,this.data=new ut(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new S0(this.data.getIterator())}getIteratorFrom(e){return new S0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Rt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Rt(this.comparator);return n.data=e,n}}class S0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.fields=e,e.sort(Nt.comparator)}static empty(){return new hn([])}unionWith(e){let n=new Rt(Nt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new hn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return yo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new yC("Invalid base64 string: "+i):i}}(e);return new Pt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Pt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pt.EMPTY_BYTE_STRING=new Pt("");const Q2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ss(t){if(Oe(!!t),typeof t=="string"){let e=0;const n=Q2.exec(t);if(Oe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:rt(t.seconds),nanos:rt(t.nanos)}}function rt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ai(t){return typeof t=="string"?Pt.fromBase64String(t):Pt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function bg(t){const e=t.mapValue.fields.__previous_value__;return Tg(e)?bg(e):e}function gl(t){const e=Ss(t.mapValue.fields.__local_write_time__.timestampValue);return new yt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,n,r,s,i,o,l,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d}}class yl{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new yl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof yl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc={mapValue:{}};function li(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Tg(t)?4:X2(t)?9007199254740991:J2(t)?10:11:ge()}function nr(t,e){if(t===e)return!0;const n=li(t);if(n!==li(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gl(t).isEqual(gl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ss(s.timestampValue),l=Ss(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ai(s.bytesValue).isEqual(ai(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return rt(s.geoPointValue.latitude)===rt(i.geoPointValue.latitude)&&rt(s.geoPointValue.longitude)===rt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return rt(s.integerValue)===rt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=rt(s.doubleValue),l=rt(i.doubleValue);return o===l?zu(o)===zu(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return yo(t.arrayValue.values||[],e.arrayValue.values||[],nr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(E0(o)!==E0(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!nr(o[c],l[c])))return!1;return!0}(t,e);default:return ge()}}function vl(t,e){return(t.values||[]).find(n=>nr(n,e))!==void 0}function vo(t,e){if(t===e)return 0;const n=li(t),r=li(e);if(n!==r)return Re(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Re(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=rt(i.integerValue||i.doubleValue),c=rt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return C0(t.timestampValue,e.timestampValue);case 4:return C0(gl(t),gl(e));case 5:return Re(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ai(i),c=ai(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let d=0;d<l.length&&d<c.length;d++){const h=Re(l[d],c[d]);if(h!==0)return h}return Re(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Re(rt(i.latitude),rt(o.latitude));return l!==0?l:Re(rt(i.longitude),rt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return I0(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,d,h;const f=i.fields||{},m=o.fields||{},y=(l=f.value)===null||l===void 0?void 0:l.arrayValue,C=(c=m.value)===null||c===void 0?void 0:c.arrayValue,w=Re(((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0,((h=C==null?void 0:C.values)===null||h===void 0?void 0:h.length)||0);return w!==0?w:I0(y,C)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Vc.mapValue&&o===Vc.mapValue)return 0;if(i===Vc.mapValue)return 1;if(o===Vc.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const m=Re(c[f],h[f]);if(m!==0)return m;const y=vo(l[c[f]],d[h[f]]);if(y!==0)return y}return Re(c.length,h.length)}(t.mapValue,e.mapValue);default:throw ge()}}function C0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Re(t,e);const n=Ss(t),r=Ss(e),s=Re(n.seconds,r.seconds);return s!==0?s:Re(n.nanos,r.nanos)}function I0(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=vo(n[s],r[s]);if(i)return i}return Re(n.length,r.length)}function _o(t){return Fp(t)}function Fp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ss(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ai(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return he.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Fp(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Fp(n.fields[o])}`;return s+"}"}(t.mapValue):ge()}function T0(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Vp(t){return!!t&&"integerValue"in t}function Ng(t){return!!t&&"arrayValue"in t}function b0(t){return!!t&&"nullValue"in t}function N0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ru(t){return!!t&&"mapValue"in t}function J2(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Fa(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return vi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Fa(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fa(t.arrayValue.values[n]);return e}return Object.assign({},t)}function X2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.value=e}static empty(){return new nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!ru(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fa(n)}setAll(e){let n=Nt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=Fa(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());ru(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return nr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];ru(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){vi(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new nn(Fa(this.value))}}function vC(t){const e=[];return vi(t.fields,(n,r)=>{const s=new Nt([n]);if(ru(r)){const i=vC(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new hn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Bt(e,0,ye.min(),ye.min(),ye.min(),nn.empty(),0)}static newFoundDocument(e,n,r,s){return new Bt(e,1,n,ye.min(),r,s,0)}static newNoDocument(e,n){return new Bt(e,2,n,ye.min(),ye.min(),nn.empty(),0)}static newUnknownDocument(e,n){return new Bt(e,3,n,ye.min(),ye.min(),nn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e,n){this.position=e,this.inclusive=n}}function k0(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=he.comparator(he.fromName(o.referenceValue),n.key):r=vo(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function R0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!nr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,n="asc"){this.field=e,this.dir=n}}function Z2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{}class ct extends _C{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new tP(e,n,r):n==="array-contains"?new sP(e,r):n==="in"?new iP(e,r):n==="not-in"?new oP(e,r):n==="array-contains-any"?new aP(e,r):new ct(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new nP(e,r):new rP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(vo(n,this.value)):n!==null&&li(this.value)===li(n)&&this.matchesComparison(vo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ge()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Bn extends _C{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Bn(e,n)}matches(e){return wC(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function wC(t){return t.op==="and"}function xC(t){return eP(t)&&wC(t)}function eP(t){for(const e of t.filters)if(e instanceof Bn)return!1;return!0}function Up(t){if(t instanceof ct)return t.field.canonicalString()+t.op.toString()+_o(t.value);if(xC(t))return t.filters.map(e=>Up(e)).join(",");{const e=t.filters.map(n=>Up(n)).join(",");return`${t.op}(${e})`}}function EC(t,e){return t instanceof ct?function(r,s){return s instanceof ct&&r.op===s.op&&r.field.isEqual(s.field)&&nr(r.value,s.value)}(t,e):t instanceof Bn?function(r,s){return s instanceof Bn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&EC(o,s.filters[l]),!0):!1}(t,e):void ge()}function SC(t){return t instanceof ct?function(n){return`${n.field.canonicalString()} ${n.op} ${_o(n.value)}`}(t):t instanceof Bn?function(n){return n.op.toString()+" {"+n.getFilters().map(SC).join(" ,")+"}"}(t):"Filter"}class tP extends ct{constructor(e,n,r){super(e,n,r),this.key=he.fromName(r.referenceValue)}matches(e){const n=he.comparator(e.key,this.key);return this.matchesComparison(n)}}class nP extends ct{constructor(e,n){super(e,"in",n),this.keys=CC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class rP extends ct{constructor(e,n){super(e,"not-in",n),this.keys=CC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function CC(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>he.fromName(r.referenceValue))}class sP extends ct{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ng(n)&&vl(n.arrayValue,this.value)}}class iP extends ct{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&vl(this.value.arrayValue,n)}}class oP extends ct{constructor(e,n){super(e,"not-in",n)}matches(e){if(vl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!vl(this.value.arrayValue,n)}}class aP extends ct{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ng(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>vl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function A0(t,e=null,n=[],r=[],s=null,i=null,o=null){return new lP(t,e,n,r,s,i,o)}function kg(t){const e=ve(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Up(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Ud(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>_o(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>_o(r)).join(",")),e.ue=n}return e.ue}function Rg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Z2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!EC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!R0(t.startAt,e.startAt)&&R0(t.endAt,e.endAt)}function $p(t){return he.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function cP(t,e,n,r,s,i,o,l){return new Vl(t,e,n,r,s,i,o,l)}function Ag(t){return new Vl(t)}function P0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function IC(t){return t.collectionGroup!==null}function Va(t){const e=ve(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Rt(Nt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Wu(i,r))}),n.has(Nt.keyField().canonicalString())||e.ce.push(new Wu(Nt.keyField(),r))}return e.ce}function Xn(t){const e=ve(t);return e.le||(e.le=uP(e,Va(t))),e.le}function uP(t,e){if(t.limitType==="F")return A0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Wu(s.field,i)});const n=t.endAt?new qu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new qu(t.startAt.position,t.startAt.inclusive):null;return A0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Bp(t,e){const n=t.filters.concat([e]);return new Vl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function zp(t,e,n){return new Vl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $d(t,e){return Rg(Xn(t),Xn(e))&&t.limitType===e.limitType}function TC(t){return`${kg(Xn(t))}|lt:${t.limitType}`}function Ri(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>SC(s)).join(", ")}]`),Ud(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>_o(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>_o(s)).join(",")),`Target(${r})`}(Xn(t))}; limitType=${t.limitType})`}function Bd(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):he.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Va(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const d=k0(o,l,c);return o.inclusive?d<=0:d<0}(r.startAt,Va(r),s)||r.endAt&&!function(o,l,c){const d=k0(o,l,c);return o.inclusive?d>=0:d>0}(r.endAt,Va(r),s))}(t,e)}function dP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function bC(t){return(e,n)=>{let r=!1;for(const s of Va(t)){const i=hP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function hP(t,e,n){const r=t.field.isKeyField()?he.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),d=l.data.field(i);return c!==null&&d!==null?vo(c,d):ge()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ge()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){vi(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return gC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fP=new ut(he.comparator);function Ar(){return fP}const NC=new ut(he.comparator);function Ta(...t){let e=NC;for(const n of t)e=e.insert(n.key,n);return e}function kC(t){let e=NC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Hs(){return Ua()}function RC(){return Ua()}function Ua(){return new Oo(t=>t.toString(),(t,e)=>t.isEqual(e))}const pP=new ut(he.comparator),mP=new Rt(he.comparator);function Te(...t){let e=mP;for(const n of t)e=e.add(n);return e}const gP=new Rt(Re);function yP(){return gP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zu(e)?"-0":e}}function AC(t){return{integerValue:""+t}}function vP(t,e){return K2(e)?AC(e):Pg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(){this._=void 0}}function _P(t,e,n){return t instanceof Hu?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Tg(i)&&(i=bg(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof _l?jC(t,e):t instanceof wl?DC(t,e):function(s,i){const o=PC(s,i),l=j0(o)+j0(s.Pe);return Vp(o)&&Vp(s.Pe)?AC(l):Pg(s.serializer,l)}(t,e)}function wP(t,e,n){return t instanceof _l?jC(t,e):t instanceof wl?DC(t,e):n}function PC(t,e){return t instanceof Gu?function(r){return Vp(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Hu extends zd{}class _l extends zd{constructor(e){super(),this.elements=e}}function jC(t,e){const n=LC(e);for(const r of t.elements)n.some(s=>nr(s,r))||n.push(r);return{arrayValue:{values:n}}}class wl extends zd{constructor(e){super(),this.elements=e}}function DC(t,e){let n=LC(e);for(const r of t.elements)n=n.filter(s=>!nr(s,r));return{arrayValue:{values:n}}}class Gu extends zd{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function j0(t){return rt(t.integerValue||t.doubleValue)}function LC(t){return Ng(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function xP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof _l&&s instanceof _l||r instanceof wl&&s instanceof wl?yo(r.elements,s.elements,nr):r instanceof Gu&&s instanceof Gu?nr(r.Pe,s.Pe):r instanceof Hu&&s instanceof Hu}(t.transform,e.transform)}class EP{constructor(e,n){this.version=e,this.transformResults=n}}class Vn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Vn}static exists(e){return new Vn(void 0,e)}static updateTime(e){return new Vn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function su(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qd{}function OC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new jg(t.key,Vn.none()):new Ul(t.key,t.data,Vn.none());{const n=t.data,r=nn.empty();let s=new Rt(Nt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new js(t.key,r,new hn(s.toArray()),Vn.none())}}function SP(t,e,n){t instanceof Ul?function(s,i,o){const l=s.value.clone(),c=L0(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof js?function(s,i,o){if(!su(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=L0(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(MC(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function $a(t,e,n,r){return t instanceof Ul?function(i,o,l,c){if(!su(i.precondition,o))return l;const d=i.value.clone(),h=O0(i.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof js?function(i,o,l,c){if(!su(i.precondition,o))return l;const d=O0(i.fieldTransforms,c,o),h=o.data;return h.setAll(MC(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,l){return su(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function CP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=PC(r.transform,s||null);i!=null&&(n===null&&(n=nn.empty()),n.set(r.field,i))}return n||null}function D0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&yo(r,s,(i,o)=>xP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ul extends qd{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class js extends qd{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function MC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function L0(t,e,n){const r=new Map;Oe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,wP(o,l,n[s]))}return r}function O0(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,_P(i,o,e))}return r}class jg extends qd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class IP extends qd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&SP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=$a(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=$a(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=RC();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=OC(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ye.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Te())}isEqual(e){return this.batchId===e.batchId&&yo(this.mutations,e.mutations,(n,r)=>D0(n,r))&&yo(this.baseMutations,e.baseMutations,(n,r)=>D0(n,r))}}class Dg{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Oe(e.mutations.length===r.length);let s=function(){return pP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Dg(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var at,be;function kP(t){switch(t){default:return ge();case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0}}function FC(t){if(t===void 0)return Rr("GRPC error has no .code"),Y.UNKNOWN;switch(t){case at.OK:return Y.OK;case at.CANCELLED:return Y.CANCELLED;case at.UNKNOWN:return Y.UNKNOWN;case at.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case at.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case at.INTERNAL:return Y.INTERNAL;case at.UNAVAILABLE:return Y.UNAVAILABLE;case at.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case at.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case at.NOT_FOUND:return Y.NOT_FOUND;case at.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case at.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case at.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case at.ABORTED:return Y.ABORTED;case at.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case at.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case at.DATA_LOSS:return Y.DATA_LOSS;default:return ge()}}(be=at||(at={}))[be.OK=0]="OK",be[be.CANCELLED=1]="CANCELLED",be[be.UNKNOWN=2]="UNKNOWN",be[be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",be[be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",be[be.NOT_FOUND=5]="NOT_FOUND",be[be.ALREADY_EXISTS=6]="ALREADY_EXISTS",be[be.PERMISSION_DENIED=7]="PERMISSION_DENIED",be[be.UNAUTHENTICATED=16]="UNAUTHENTICATED",be[be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",be[be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",be[be.ABORTED=10]="ABORTED",be[be.OUT_OF_RANGE=11]="OUT_OF_RANGE",be[be.UNIMPLEMENTED=12]="UNIMPLEMENTED",be[be.INTERNAL=13]="INTERNAL",be[be.UNAVAILABLE=14]="UNAVAILABLE",be[be.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AP=new Ys([4294967295,4294967295],0);function M0(t){const e=RP().encode(t),n=new lC;return n.update(e),new Uint8Array(n.digest())}function F0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ys([n,r],0),new Ys([s,i],0)]}class Lg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ba(`Invalid padding: ${n}`);if(r<0)throw new ba(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ba(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ba(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ys.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ys.fromNumber(r)));return s.compare(AP)===1&&(s=new Ys([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=M0(e),[r,s]=F0(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Lg(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=M0(e),[r,s]=F0(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ba extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,$l.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Wd(ye.min(),s,new ut(Re),Ar(),Te())}}class $l{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new $l(r,n,Te(),Te(),Te())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class VC{constructor(e,n){this.targetId=e,this.me=n}}class UC{constructor(e,n,r=Pt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class V0{constructor(){this.fe=0,this.ge=$0(),this.pe=Pt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Te(),n=Te(),r=Te();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ge()}}),new $l(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=$0()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Oe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class PP{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ar(),this.qe=U0(),this.Qe=new ut(Re)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ge()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if($p(i))if(r===0){const o=new he(i.path);this.Ue(n,o,Bt.newNoDocument(o,ye.min()))}else Oe(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=ai(r).toUint8Array()}catch(c){if(c instanceof yC)return go("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Lg(o,s,i)}catch(c){return go(c instanceof ba?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&$p(l.target)){const c=new he(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Bt.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Te();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Wd(e,n,this.Qe,this.ke,r);return this.ke=Ar(),this.qe=U0(),this.Qe=new ut(Re),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new V0,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Rt(Re),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ue("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new V0),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function U0(){return new ut(he.comparator)}function $0(){return new ut(he.comparator)}const jP={asc:"ASCENDING",desc:"DESCENDING"},DP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LP={and:"AND",or:"OR"};class OP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function qp(t,e){return t.useProto3Json||Ud(e)?e:{value:e}}function Ku(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $C(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function MP(t,e){return Ku(t,e.toTimestamp())}function Zn(t){return Oe(!!t),ye.fromTimestamp(function(n){const r=Ss(n);return new yt(r.seconds,r.nanos)}(t))}function Og(t,e){return Wp(t,e).canonicalString()}function Wp(t,e){const n=function(s){return new We(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function BC(t){const e=We.fromString(t);return Oe(GC(e)),e}function Hp(t,e){return Og(t.databaseId,e.path)}function pf(t,e){const n=BC(e);if(n.get(1)!==t.databaseId.projectId)throw new le(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new le(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new he(qC(n))}function zC(t,e){return Og(t.databaseId,e)}function FP(t){const e=BC(t);return e.length===4?We.emptyPath():qC(e)}function Gp(t){return new We(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function qC(t){return Oe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function B0(t,e,n){return{name:Hp(t,e),fields:n.value.mapValue.fields}}function VP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ge()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(Oe(h===void 0||typeof h=="string"),Pt.fromBase64String(h||"")):(Oe(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Pt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?Y.UNKNOWN:FC(d.code);return new le(h,d.message||"")}(o);n=new UC(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=pf(t,r.document.name),i=Zn(r.document.updateTime),o=r.document.createTime?Zn(r.document.createTime):ye.min(),l=new nn({mapValue:{fields:r.document.fields}}),c=Bt.newFoundDocument(s,i,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new iu(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=pf(t,r.document),i=r.readTime?Zn(r.readTime):ye.min(),o=Bt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new iu([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=pf(t,r.document),i=r.removedTargetIds||[];n=new iu([],i,s,null)}else{if(!("filter"in e))return ge();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new NP(s,i),l=r.targetId;n=new VC(l,o)}}return n}function UP(t,e){let n;if(e instanceof Ul)n={update:B0(t,e.key,e.value)};else if(e instanceof jg)n={delete:Hp(t,e.key)};else if(e instanceof js)n={update:B0(t,e.key,e.data),updateMask:QP(e.fieldMask)};else{if(!(e instanceof IP))return ge();n={verify:Hp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Hu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof _l)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof wl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Gu)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ge()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:MP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ge()}(t,e.precondition)),n}function $P(t,e){return t&&t.length>0?(Oe(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?Zn(s.updateTime):Zn(i);return o.isEqual(ye.min())&&(o=Zn(i)),new EP(o,s.transformResults||[])}(n,e))):[]}function BP(t,e){return{documents:[zC(t,e.path)]}}function zP(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=zC(t,s);const i=function(d){if(d.length!==0)return HC(Bn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Ai(m.field),direction:HP(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=qp(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function qP(t){let e=FP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Oe(r===1);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=WC(f);return m instanceof Bn&&xC(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(C){return new Wu(Pi(C.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(f){let m;return m=typeof f=="object"?f.value:f,Ud(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(f){const m=!!f.before,y=f.values||[];return new qu(y,m)}(n.startAt));let d=null;return n.endAt&&(d=function(f){const m=!f.before,y=f.values||[];return new qu(y,m)}(n.endAt)),cP(e,s,o,i,l,"F",c,d)}function WP(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ge()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function WC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Pi(n.unaryFilter.field);return ct.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Pi(n.unaryFilter.field);return ct.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Pi(n.unaryFilter.field);return ct.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Pi(n.unaryFilter.field);return ct.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ge()}}(t):t.fieldFilter!==void 0?function(n){return ct.create(Pi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ge()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Bn.create(n.compositeFilter.filters.map(r=>WC(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ge()}}(n.compositeFilter.op))}(t):ge()}function HP(t){return jP[t]}function GP(t){return DP[t]}function KP(t){return LP[t]}function Ai(t){return{fieldPath:t.canonicalString()}}function Pi(t){return Nt.fromServerFormat(t.fieldPath)}function HC(t){return t instanceof ct?function(n){if(n.op==="=="){if(N0(n.value))return{unaryFilter:{field:Ai(n.field),op:"IS_NAN"}};if(b0(n.value))return{unaryFilter:{field:Ai(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(N0(n.value))return{unaryFilter:{field:Ai(n.field),op:"IS_NOT_NAN"}};if(b0(n.value))return{unaryFilter:{field:Ai(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ai(n.field),op:GP(n.op),value:n.value}}}(t):t instanceof Bn?function(n){const r=n.getFilters().map(s=>HC(s));return r.length===1?r[0]:{compositeFilter:{op:KP(n.op),filters:r}}}(t):ge()}function QP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function GC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,n,r,s,i=ye.min(),o=ye.min(),l=Pt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this.ct=e}}function JP(t){const e=qP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?zp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(){this.un=new ZP}addToCollectionParentIndex(e,n){return this.un.add(n),X.resolve()}getCollectionParents(e,n){return X.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return X.resolve()}deleteFieldIndex(e,n){return X.resolve()}deleteAllFieldIndexes(e){return X.resolve()}createTargetIndexes(e,n){return X.resolve()}getDocumentsMatchingTarget(e,n){return X.resolve(null)}getIndexType(e,n){return X.resolve(0)}getFieldIndexes(e,n){return X.resolve([])}getNextCollectionGroupToUpdate(e){return X.resolve(null)}getMinOffset(e,n){return X.resolve(Es.min())}getMinOffsetFromCollectionGroup(e,n){return X.resolve(Es.min())}updateCollectionGroup(e,n,r){return X.resolve()}updateIndexEntries(e,n){return X.resolve()}}class ZP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Rt(We.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Rt(We.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new wo(0)}static kn(){return new wo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(){this.changes=new Oo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Bt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?X.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&$a(r.mutation,s,hn.empty(),yt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Te()){const s=Hs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ta();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Hs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Te()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Ar();const o=Ua(),l=function(){return Ua()}();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof js)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),$a(h.mutation,d,h.mutation.getFieldMask(),yt.now())):o.set(d.key,hn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var f;return l.set(d,new tj(h,(f=o.get(d))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Ua();let s=new ut((o,l)=>o-l),i=Te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||hn.empty();h=l.applyToLocalView(d,h),r.set(c,h);const f=(s.get(l.batchId)||Te()).add(c);s=s.insert(l.batchId,f)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,h=c.value,f=RC();h.forEach(m=>{if(!i.has(m)){const y=OC(n.get(m),r.get(m));y!==null&&f.set(m,y),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return X.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return he.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):IC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):X.resolve(Hs());let l=-1,c=i;return o.next(d=>X.forEach(d,(h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(h)?X.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,Te())).next(h=>({batchId:l,changes:kC(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new he(n)).next(r=>{let s=Ta();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ta();return this.indexManager.getCollectionParents(e,i).next(l=>X.forEach(l,c=>{const d=function(f,m){return new Vl(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Bt.newInvalidDocument(h)))});let l=Ta();return o.forEach((c,d)=>{const h=i.get(c);h!==void 0&&$a(h.mutation,d,hn.empty(),yt.now()),Bd(n,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return X.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Zn(s.createTime)}}(n)),X.resolve()}getNamedQuery(e,n){return X.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:JP(s.bundledQuery),readTime:Zn(s.readTime)}}(n)),X.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(){this.overlays=new ut(he.comparator),this.Ir=new Map}getOverlay(e,n){return X.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Hs();return X.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),X.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),X.resolve()}getOverlaysForCollection(e,n,r){const s=Hs(),i=n.length+1,o=new he(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return X.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ut((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Hs(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=Hs(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=s)););return X.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new bP(n,r));let i=this.Ir.get(n);i===void 0&&(i=Te(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return X.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,X.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(){this.Tr=new Rt(wt.Er),this.dr=new Rt(wt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new wt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new wt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new he(new We([])),r=new wt(n,e),s=new wt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new he(new We([])),r=new wt(n,e),s=new wt(n,e+1);let i=Te();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new wt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class wt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return he.comparator(e.key,n.key)||Re(e.wr,n.wr)}static Ar(e,n){return Re(e.wr,n.wr)||he.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Rt(wt.Er)}checkEmpty(e){return X.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new TP(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new wt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return X.resolve(o)}lookupMutationBatch(e,n){return X.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return X.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return X.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return X.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new wt(n,0),s=new wt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),X.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Rt(Re);return n.forEach(s=>{const i=new wt(s,0),o=new wt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),X.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;he.isDocumentKey(i)||(i=i.child(""));const o=new wt(new he(i),0);let l=new Rt(Re);return this.br.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(c.wr)),!0)},o),X.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Oe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return X.forEach(n.mutations,s=>{const i=new wt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new wt(n,0),s=this.br.firstAfterOrEqual(r);return X.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,X.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e){this.Mr=e,this.docs=function(){return new ut(he.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return X.resolve(r?r.document.mutableCopy():Bt.newInvalidDocument(n))}getEntries(e,n){let r=Ar();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Bt.newInvalidDocument(s))}),X.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Ar();const o=n.path,l=new he(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||q2(z2(h),r)<=0||(s.has(h.key)||Bd(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return X.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ge()}Or(e,n){return X.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new lj(this)}getSize(e){return X.resolve(this.size)}}class lj extends ej{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),X.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.persistence=e,this.Nr=new Oo(n=>kg(n),Rg),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Mg,this.targetCount=0,this.kr=wo.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),X.resolve()}getLastRemoteSnapshotVersion(e){return X.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return X.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),X.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),X.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new wo(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,X.resolve()}updateTargetData(e,n){return this.Kn(n),X.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,X.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),X.waitFor(i).next(()=>s)}getTargetCount(e){return X.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return X.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),X.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),X.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),X.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return X.resolve(r)}containsKey(e,n){return X.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Ig(0),this.Kr=!1,this.Kr=!0,this.$r=new ij,this.referenceDelegate=e(this),this.Ur=new cj(this),this.indexManager=new XP,this.remoteDocumentCache=function(s){return new aj(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new YP(n),this.Gr=new rj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new sj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new oj(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ue("MemoryPersistence","Starting transaction:",e);const s=new dj(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return X.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class dj extends H2{constructor(e){super(),this.currentSequenceNumber=e}}class Fg{constructor(e){this.persistence=e,this.Jr=new Mg,this.Yr=null}static Zr(e){return new Fg(e)}get Xr(){if(this.Yr)return this.Yr;throw ge()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),X.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),X.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),X.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return X.forEach(this.Xr,r=>{const s=he.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ye.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return X.or([()=>X.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Te(),s=Te();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Vg(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return fA()?8:G2(qt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new hj;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(ha()<=Ie.DEBUG&&ue("QueryEngine","SDK will not create cache indexes for query:",Ri(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),X.resolve()):(ha()<=Ie.DEBUG&&ue("QueryEngine","Query:",Ri(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(ha()<=Ie.DEBUG&&ue("QueryEngine","The SDK decides to create cache indexes for query:",Ri(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xn(n))):X.resolve())}Yi(e,n){if(P0(n))return X.resolve(null);let r=Xn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=zp(n,null,"F"),r=Xn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Te(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ts(n,l);return this.ns(n,d,o,c.readTime)?this.Yi(e,zp(n,null,"F")):this.rs(e,d,n,c)}))})))}Zi(e,n,r,s){return P0(n)||s.isEqual(ye.min())?X.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?X.resolve(null):(ha()<=Ie.DEBUG&&ue("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ri(n)),this.rs(e,o,n,B2(s,-1)).next(l=>l))})}ts(e,n){let r=new Rt(bC(e));return n.forEach((s,i)=>{Bd(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return ha()<=Ie.DEBUG&&ue("QueryEngine","Using full collection scan to execute query:",Ri(n)),this.Ji.getDocumentsMatchingQuery(e,n,Es.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new ut(Re),this._s=new Oo(i=>kg(i),Rg),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nj(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function mj(t,e,n,r){return new pj(t,e,n,r)}async function KC(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Te();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){l.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function gj(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,d,h){const f=d.batch,m=f.keys();let y=X.resolve();return m.forEach(C=>{y=y.next(()=>h.getEntry(c,C)).next(w=>{const R=d.docVersions.get(C);Oe(R!==null),w.version.compareTo(R)<0&&(f.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Te();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function QC(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function yj(t,e){const n=ve(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((h,f)=>{const m=s.get(f);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,f)));let y=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Pt.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),s=s.insert(f,y),function(w,R,T){return w.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(m,y,h)&&l.push(n.Ur.updateTargetData(i,y))});let c=Ar(),d=Te();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(vj(i,o,e.documentUpdates).next(h=>{c=h.Ps,d=h.Is})),!r.isEqual(ye.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(f=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return X.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.os=s,i))}function vj(t,e,n){let r=Te(),s=Te();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Ar();return n.forEach((l,c)=>{const d=i.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(ye.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):ue("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function _j(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function wj(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,X.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new ts(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Kp(t,e,n){const r=ve(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Fl(o))throw o;ue("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function z0(t,e,n){const r=ve(t);let s=ye.min(),i=Te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,h){const f=ve(c),m=f._s.get(h);return m!==void 0?X.resolve(f.os.get(m)):f.Ur.getTargetData(d,h)}(r,o,Xn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:ye.min(),n?i:Te())).next(l=>(xj(r,dP(e),l),{documents:l,Ts:i})))}function xj(t,e,n){let r=t.us.get(e)||ye.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class q0{constructor(){this.activeTargetIds=yP()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ej{constructor(){this.so=new q0,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new q0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ue("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ue("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uc=null;function mf(){return Uc===null?Uc=function(){return 268435456+Math.round(2147483648*Math.random())}():Uc++,"0x"+Uc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vt="WebChannelConnection";class Tj extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=mf(),c=this.xo(n,r.toUriEncodedString());ue("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(n,c,d,s).then(h=>(ue("RestConnection",`Received RPC '${n}' ${l}: `,h),h),h=>{throw go("RestConnection",`RPC '${n}' ${l} failed with error: `,h,"url: ",c,"request:",s),h})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Lo}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=Cj[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=mf();return new Promise((o,l)=>{const c=new cC;c.setWithCredentials(!0),c.listenOnce(uC.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case nu.NO_ERROR:const h=c.getResponseJson();ue(Vt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case nu.TIMEOUT:ue(Vt,`RPC '${e}' ${i} timed out`),l(new le(Y.DEADLINE_EXCEEDED,"Request time out"));break;case nu.HTTP_ERROR:const f=c.getStatus();if(ue(Vt,`RPC '${e}' ${i} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m==null?void 0:m.error;if(y&&y.status&&y.message){const C=function(R){const T=R.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(T)>=0?T:Y.UNKNOWN}(y.status);l(new le(C,y.message))}else l(new le(Y.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new le(Y.UNAVAILABLE,"Connection failed."));break;default:ge()}}finally{ue(Vt,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);ue(Vt,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=mf(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=fC(),l=hC(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=i.join("");ue(Vt,`Creating RPC '${e}' stream ${s}: ${h}`,c);const f=o.createWebChannel(h,c);let m=!1,y=!1;const C=new Ij({Io:R=>{y?ue(Vt,`Not sending because RPC '${e}' stream ${s} is closed:`,R):(m||(ue(Vt,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),ue(Vt,`RPC '${e}' stream ${s} sending:`,R),f.send(R))},To:()=>f.close()}),w=(R,T,x)=>{R.listen(T,_=>{try{x(_)}catch(O){setTimeout(()=>{throw O},0)}})};return w(f,Ia.EventType.OPEN,()=>{y||(ue(Vt,`RPC '${e}' stream ${s} transport opened.`),C.yo())}),w(f,Ia.EventType.CLOSE,()=>{y||(y=!0,ue(Vt,`RPC '${e}' stream ${s} transport closed`),C.So())}),w(f,Ia.EventType.ERROR,R=>{y||(y=!0,go(Vt,`RPC '${e}' stream ${s} transport errored:`,R),C.So(new le(Y.UNAVAILABLE,"The operation could not be completed")))}),w(f,Ia.EventType.MESSAGE,R=>{var T;if(!y){const x=R.data[0];Oe(!!x);const _=x,O=_.error||((T=_[0])===null||T===void 0?void 0:T.error);if(O){ue(Vt,`RPC '${e}' stream ${s} received error:`,O);const j=O.status;let L=function(I){const A=at[I];if(A!==void 0)return FC(A)}(j),E=O.message;L===void 0&&(L=Y.INTERNAL,E="Unknown error status: "+j+" with message "+O.message),y=!0,C.So(new le(L,E)),f.close()}else ue(Vt,`RPC '${e}' stream ${s} received:`,x),C.bo(x)}}),w(l,dC.STAT_EVENT,R=>{R.stat===Op.PROXY?ue(Vt,`RPC '${e}' stream ${s} detected buffering proxy`):R.stat===Op.NOPROXY&&ue(Vt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}}function gf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(t){return new OP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ue("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e,n,r,s,i,o,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new YC(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Y.RESOURCE_EXHAUSTED?(Rr(n.toString()),Rr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new le(Y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ue("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ue("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class bj extends JC{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=VP(this.serializer,e),r=function(i){if(!("targetChange"in i))return ye.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ye.min():o.readTime?Zn(o.readTime):ye.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Gp(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=$p(c)?{documents:BP(i,c)}:{query:zP(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=$C(i,o.resumeToken);const d=qp(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(ye.min())>0){l.readTime=Ku(i,o.snapshotVersion.toTimestamp());const d=qp(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=WP(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Gp(this.serializer),n.removeTarget=e,this.a_(n)}}class Nj extends JC{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Oe(!!e.streamToken),this.lastStreamToken=e.streamToken,Oe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Oe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=$P(e.writeResults,e.commitTime),r=Zn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Gp(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>UP(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new le(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Wp(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new le(Y.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Wp(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new le(Y.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Rj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Rr(n),this.D_=!1):ue("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{_i(this)&&(ue("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=ve(c);d.L_.add(4),await Bl(d),d.q_.set("Unknown"),d.L_.delete(4),await Gd(d)}(this))})}),this.q_=new Rj(r,s)}}async function Gd(t){if(_i(t))for(const e of t.B_)await e(!0)}async function Bl(t){for(const e of t.B_)await e(!1)}function XC(t,e){const n=ve(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),zg(n)?Bg(n):Mo(n).r_()&&$g(n,e))}function Ug(t,e){const n=ve(t),r=Mo(n);n.N_.delete(e),r.r_()&&ZC(n,e),n.N_.size===0&&(r.r_()?r.o_():_i(n)&&n.q_.set("Unknown"))}function $g(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ye.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Mo(t).A_(e)}function ZC(t,e){t.Q_.xe(e),Mo(t).R_(e)}function Bg(t){t.Q_=new PP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Mo(t).start(),t.q_.v_()}function zg(t){return _i(t)&&!Mo(t).n_()&&t.N_.size>0}function _i(t){return ve(t).L_.size===0}function eI(t){t.Q_=void 0}async function Pj(t){t.q_.set("Online")}async function jj(t){t.N_.forEach((e,n)=>{$g(t,e)})}async function Dj(t,e){eI(t),zg(t)?(t.q_.M_(e),Bg(t)):t.q_.set("Unknown")}async function Lj(t,e,n){if(t.q_.set("Online"),e instanceof UC&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){ue("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qu(t,r)}else if(e instanceof iu?t.Q_.Ke(e):e instanceof VC?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ye.min()))try{const r=await QC(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.N_.get(d);h&&i.N_.set(d,h.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,d)=>{const h=i.N_.get(c);if(!h)return;i.N_.set(c,h.withResumeToken(Pt.EMPTY_BYTE_STRING,h.snapshotVersion)),ZC(i,c);const f=new ts(h.target,c,d,h.sequenceNumber);$g(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ue("RemoteStore","Failed to raise snapshot:",r),await Qu(t,r)}}async function Qu(t,e,n){if(!Fl(e))throw e;t.L_.add(1),await Bl(t),t.q_.set("Offline"),n||(n=()=>QC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ue("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Gd(t)})}function tI(t,e){return e().catch(n=>Qu(t,n,e))}async function Kd(t){const e=ve(t),n=Cs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Oj(e);)try{const s=await _j(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,Mj(e,s)}catch(s){await Qu(e,s)}nI(e)&&rI(e)}function Oj(t){return _i(t)&&t.O_.length<10}function Mj(t,e){t.O_.push(e);const n=Cs(t);n.r_()&&n.V_&&n.m_(e.mutations)}function nI(t){return _i(t)&&!Cs(t).n_()&&t.O_.length>0}function rI(t){Cs(t).start()}async function Fj(t){Cs(t).p_()}async function Vj(t){const e=Cs(t);for(const n of t.O_)e.m_(n.mutations)}async function Uj(t,e,n){const r=t.O_.shift(),s=Dg.from(r,e,n);await tI(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Kd(t)}async function $j(t,e){e&&Cs(t).V_&&await async function(r,s){if(function(o){return kP(o)&&o!==Y.ABORTED}(s.code)){const i=r.O_.shift();Cs(r).s_(),await tI(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Kd(r)}}(t,e),nI(t)&&rI(t)}async function H0(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),ue("RemoteStore","RemoteStore received new credentials");const r=_i(n);n.L_.add(3),await Bl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Gd(n)}async function Bj(t,e){const n=ve(t);e?(n.L_.delete(2),await Gd(n)):e||(n.L_.add(2),await Bl(n),n.q_.set("Unknown"))}function Mo(t){return t.K_||(t.K_=function(n,r,s){const i=ve(n);return i.w_(),new bj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:Pj.bind(null,t),Ro:jj.bind(null,t),mo:Dj.bind(null,t),d_:Lj.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),zg(t)?Bg(t):t.q_.set("Unknown")):(await t.K_.stop(),eI(t))})),t.K_}function Cs(t){return t.U_||(t.U_=function(n,r,s){const i=ve(n);return i.w_(),new Nj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Fj.bind(null,t),mo:$j.bind(null,t),f_:Vj.bind(null,t),g_:Uj.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Kd(t)):(await t.U_.stop(),t.O_.length>0&&(ue("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new qg(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new le(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wg(t,e){if(Rr("AsyncQueue",`${e}: ${t}`),Fl(t))return new le(Y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e){this.comparator=e?(n,r)=>e(n,r)||he.comparator(n.key,r.key):(n,r)=>he.comparator(n.key,r.key),this.keyedMap=Ta(),this.sortedSet=new ut(this.comparator)}static emptySet(e){return new to(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof to)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new to;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(){this.W_=new ut(he.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ge():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class xo{constructor(e,n,r,s,i,o,l,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new xo(e,n,to.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$d(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class qj{constructor(){this.queries=K0(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ve(n),i=s.queries;s.queries=K0(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new le(Y.ABORTED,"Firestore shutting down"))}}function K0(){return new Oo(t=>TC(t),$d)}async function sI(t,e){const n=ve(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new zj,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Wg(o,`Initialization of query '${Ri(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Hg(n)}async function iI(t,e){const n=ve(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Wj(t,e){const n=ve(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Hg(n)}function Hj(t,e,n){const r=ve(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Hg(t){t.Y_.forEach(e=>{e.next()})}var Qp,Q0;(Q0=Qp||(Qp={})).ea="default",Q0.Cache="cache";class oI{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new xo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=xo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Qp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e){this.key=e}}class lI{constructor(e){this.key=e}}class Gj{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Te(),this.mutatedKeys=Te(),this.Aa=bC(e),this.Ra=new to(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new G0,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const m=s.get(h),y=Bd(this.query,f)?f:null,C=!!m&&this.mutatedKeys.has(m.key),w=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let R=!1;m&&y?m.data.isEqual(y.data)?C!==w&&(r.track({type:3,doc:y}),R=!0):this.ga(m,y)||(r.track({type:2,doc:y}),R=!0,(c&&this.Aa(y,c)>0||d&&this.Aa(y,d)<0)&&(l=!0)):!m&&y?(r.track({type:0,doc:y}),R=!0):m&&!y&&(r.track({type:1,doc:m}),R=!0,(c||d)&&(l=!0)),R&&(y?(o=o.add(y),i=w?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,f)=>function(y,C){const w=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge()}};return w(y)-w(C)}(h.type,f.type)||this.Aa(h.doc,f.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,d=c!==this.Ea;return this.Ea=c,o.length!==0||d?{snapshot:new xo(this.query,e.Ra,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new G0,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Te(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new lI(r))}),this.da.forEach(r=>{e.has(r)||n.push(new aI(r))}),n}ba(e){this.Ta=e.Ts,this.da=Te();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return xo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Kj{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Qj{constructor(e){this.key=e,this.va=!1}}class Yj{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Oo(l=>TC(l),$d),this.Ma=new Map,this.xa=new Set,this.Oa=new ut(he.comparator),this.Na=new Map,this.La=new Mg,this.Ba={},this.ka=new Map,this.qa=wo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Jj(t,e,n=!0){const r=pI(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await cI(r,e,n,!0),s}async function Xj(t,e){const n=pI(t);await cI(n,e,!0,!1)}async function cI(t,e,n,r){const s=await wj(t.localStore,Xn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Zj(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&XC(t.remoteStore,s),l}async function Zj(t,e,n,r,s){t.Ka=(f,m,y)=>async function(w,R,T,x){let _=R.view.ma(T);_.ns&&(_=await z0(w.localStore,R.query,!1).then(({documents:E})=>R.view.ma(E,_)));const O=x&&x.targetChanges.get(R.targetId),j=x&&x.targetMismatches.get(R.targetId)!=null,L=R.view.applyChanges(_,w.isPrimaryClient,O,j);return J0(w,R.targetId,L.wa),L.snapshot}(t,f,m,y);const i=await z0(t.localStore,e,!0),o=new Gj(e,i.Ts),l=o.ma(i.documents),c=$l.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,c);J0(t,n,d.wa);const h=new Kj(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function eD(t,e,n){const r=ve(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!$d(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Kp(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Ug(r.remoteStore,s.targetId),Yp(r,s.targetId)}).catch(Ml)):(Yp(r,s.targetId),await Kp(r.localStore,s.targetId,!0))}async function tD(t,e){const n=ve(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ug(n.remoteStore,r.targetId))}async function nD(t,e,n){const r=cD(t);try{const s=await function(o,l){const c=ve(o),d=yt.now(),h=l.reduce((y,C)=>y.add(C.key),Te());let f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let C=Ar(),w=Te();return c.cs.getEntries(y,h).next(R=>{C=R,C.forEach((T,x)=>{x.isValidDocument()||(w=w.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,C)).next(R=>{f=R;const T=[];for(const x of l){const _=CP(x,f.get(x.key).overlayedDocument);_!=null&&T.push(new js(x.key,_,vC(_.value.mapValue),Vn.exists(!0)))}return c.mutationQueue.addMutationBatch(y,d,T,l)}).next(R=>{m=R;const T=R.applyToLocalDocumentSet(f,w);return c.documentOverlayCache.saveOverlays(y,R.batchId,T)})}).then(()=>({batchId:m.batchId,changes:kC(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let d=o.Ba[o.currentUser.toKey()];d||(d=new ut(Re)),d=d.insert(l,c),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,n),await zl(r,s.changes),await Kd(r.remoteStore)}catch(s){const i=Wg(s,"Failed to persist write");n.reject(i)}}async function uI(t,e){const n=ve(t);try{const r=await yj(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Oe(o.va):s.removedDocuments.size>0&&(Oe(o.va),o.va=!1))}),await zl(n,r,e)}catch(r){await Ml(r)}}function Y0(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=ve(o);c.onlineState=l;let d=!1;c.queries.forEach((h,f)=>{for(const m of f.j_)m.Z_(l)&&(d=!0)}),d&&Hg(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function rD(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new ut(he.comparator);o=o.insert(i,Bt.newNoDocument(i,ye.min()));const l=Te().add(i),c=new Wd(ye.min(),new Map,new ut(Re),o,l);await uI(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),Gg(r)}else await Kp(r.localStore,e,!1).then(()=>Yp(r,e,n)).catch(Ml)}async function sD(t,e){const n=ve(t),r=e.batch.batchId;try{const s=await gj(n.localStore,e);hI(n,r,null),dI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await zl(n,s)}catch(s){await Ml(s)}}async function iD(t,e,n){const r=ve(t);try{const s=await function(o,l){const c=ve(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,l).next(f=>(Oe(f!==null),h=f.keys(),c.mutationQueue.removeMutationBatch(d,f))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);hI(r,e,n),dI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await zl(r,s)}catch(s){await Ml(s)}}function dI(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function hI(t,e,n){const r=ve(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Yp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||fI(t,r)})}function fI(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Ug(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Gg(t))}function J0(t,e,n){for(const r of n)r instanceof aI?(t.La.addReference(r.key,e),oD(t,r)):r instanceof lI?(ue("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||fI(t,r.key)):ge()}function oD(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ue("SyncEngine","New document in limbo: "+n),t.xa.add(r),Gg(t))}function Gg(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new he(We.fromString(e)),r=t.qa.next();t.Na.set(r,new Qj(n)),t.Oa=t.Oa.insert(n,r),XC(t.remoteStore,new ts(Xn(Ag(n.path)),r,"TargetPurposeLimboResolution",Ig.oe))}}async function zl(t,e,n){const r=ve(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const f=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(d){s.push(d);const f=Vg.Wi(c.targetId,d);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,d){const h=ve(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>X.forEach(d,m=>X.forEach(m.$i,y=>h.persistence.referenceDelegate.addReference(f,m.targetId,y)).next(()=>X.forEach(m.Ui,y=>h.persistence.referenceDelegate.removeReference(f,m.targetId,y)))))}catch(f){if(!Fl(f))throw f;ue("LocalStore","Failed to update sequence numbers: "+f)}for(const f of d){const m=f.targetId;if(!f.fromCache){const y=h.os.get(m),C=y.snapshotVersion,w=y.withLastLimboFreeSnapshotVersion(C);h.os=h.os.insert(m,w)}}}(r.localStore,i))}async function aD(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){ue("SyncEngine","User change. New user:",e.toKey());const r=await KC(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new le(Y.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await zl(n,r.hs)}}function lD(t,e){const n=ve(t),r=n.Na.get(e);if(r&&r.va)return Te().add(r.key);{let s=Te();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function pI(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=uI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rD.bind(null,e),e.Ca.d_=Wj.bind(null,e.eventManager),e.Ca.$a=Hj.bind(null,e.eventManager),e}function cD(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=iD.bind(null,e),e}class Yu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return mj(this.persistence,new fj,e.initialUser,this.serializer)}Ga(e){return new uj(Fg.Zr,this.serializer)}Wa(e){return new Ej}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Yu.provider={build:()=>new Yu};class Jp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Y0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=aD.bind(null,this.syncEngine),await Bj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new qj}()}createDatastore(e){const n=Hd(e.databaseInfo.databaseId),r=function(i){return new Tj(i)}(e.databaseInfo);return function(i,o,l,c){return new kj(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new Aj(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Y0(this.syncEngine,n,0),function(){return W0.D()?new W0:new Sj}())}createSyncEngine(e,n){return function(s,i,o,l,c,d,h){const f=new Yj(s,i,o,l,c,d);return h&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ve(s);ue("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Bl(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Jp.provider={build:()=>new Jp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Rr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ut.UNAUTHENTICATED,this.clientId=mC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ue("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ue("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Wg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function yf(t,e){t.asyncQueue.verifyOperationInProgress(),ue("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await KC(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function X0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await dD(t);ue("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>H0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>H0(e.remoteStore,s)),t._onlineComponents=e}async function dD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ue("FirestoreClient","Using user provided OfflineComponentProvider");try{await yf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===Y.FAILED_PRECONDITION||s.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;go("Error using user provided cache. Falling back to memory cache: "+n),await yf(t,new Yu)}}else ue("FirestoreClient","Using default OfflineComponentProvider"),await yf(t,new Yu);return t._offlineComponents}async function gI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ue("FirestoreClient","Using user provided OnlineComponentProvider"),await X0(t,t._uninitializedComponentsProvider._online)):(ue("FirestoreClient","Using default OnlineComponentProvider"),await X0(t,new Jp))),t._onlineComponents}function hD(t){return gI(t).then(e=>e.syncEngine)}async function yI(t){const e=await gI(t),n=e.eventManager;return n.onListen=Jj.bind(null,e.syncEngine),n.onUnlisten=eD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Xj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=tD.bind(null,e.syncEngine),n}function fD(t,e,n={}){const r=new Er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const h=new mI({next:m=>{h.Za(),o.enqueueAndForget(()=>iI(i,f));const y=m.docs.has(l);!y&&m.fromCache?d.reject(new le(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&c&&c.source==="server"?d.reject(new le(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new oI(Ag(l.path),h,{includeMetadataChanges:!0,_a:!0});return sI(i,f)}(await yI(t),t.asyncQueue,e,n,r)),r.promise}function pD(t,e,n={}){const r=new Er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const h=new mI({next:m=>{h.Za(),o.enqueueAndForget(()=>iI(i,f)),m.fromCache&&c.source==="server"?d.reject(new le(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),f=new oI(l,h,{includeMetadataChanges:!0,_a:!0});return sI(i,f)}(await yI(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(t,e,n){if(!n)throw new le(Y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function mD(t,e,n,r){if(e===!0&&r===!0)throw new le(Y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ew(t){if(!he.isDocumentKey(t))throw new le(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function tw(t){if(he.isDocumentKey(t))throw new le(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Qd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ge()}function rr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new le(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Qd(t);throw new le(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new le(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new le(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new le(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new le(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new le(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Yd{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nw({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new le(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new le(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nw(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new j2;switch(r.type){case"firstParty":return new M2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new le(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Z0.get(n);r&&(ue("ComponentProvider","Removing Datastore"),Z0.delete(n),r.terminate())}(this),Promise.resolve()}}function gD(t,e,n,r={}){var s;const i=(t=rr(t,Yd))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&go("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Ut.MOCK_USER;else{l=eC(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new le(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ut(d)}t._authCredentials=new D2(new pC(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Fo(this.firestore,e,this._query)}}class Jt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ms(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jt(this.firestore,e,this._key)}}class ms extends Fo{constructor(e,n,r){super(e,n,Ag(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jt(this.firestore,null,new he(e))}withConverter(e){return new ms(this.firestore,e,this._path)}}function nt(t,e,...n){if(t=Ve(t),_I("collection","path",e),t instanceof Yd){const r=We.fromString(e,...n);return tw(r),new ms(t,null,r)}{if(!(t instanceof Jt||t instanceof ms))throw new le(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(We.fromString(e,...n));return tw(r),new ms(t.firestore,null,r)}}function gt(t,e,...n){if(t=Ve(t),arguments.length===1&&(e=mC.newId()),_I("doc","path",e),t instanceof Yd){const r=We.fromString(e,...n);return ew(r),new Jt(t,null,new he(r))}{if(!(t instanceof Jt||t instanceof ms))throw new le(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(We.fromString(e,...n));return ew(r),new Jt(t.firestore,t instanceof ms?t.converter:null,new he(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new YC(this,"async_queue_retry"),this.Vu=()=>{const r=gf();r&&ue("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=gf();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=gf();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Er;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Fl(e))throw e;ue("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Rr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=qg.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ge()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Vo extends Yd{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new rw,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rw(e),this._firestoreClient=void 0,await e}}}function wI(t,e){const n=typeof t=="object"?t:Sg(),r=typeof t=="string"?t:"(default)",s=Vd(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=JS("firestore");i&&gD(s,...i)}return s}function Kg(t){if(t._terminated)throw new le(Y.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||yD(t),t._firestoreClient}function yD(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,d,h){return new Y2(l,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,vI(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new uD(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Eo(Pt.fromBase64String(e))}catch(n){throw new le(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Eo(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new le(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new le(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new le(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Re(this._lat,e._lat)||Re(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=/^__.*__$/;class _D{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new js(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ul(e,this.data,n,this.fieldTransforms)}}class xI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new js(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function EI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge()}}class Xg{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Xg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ju(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(EI(this.Cu)&&vD.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class wD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Hd(e)}Qu(e,n,r,s=!1){return new Xg({Cu:e,methodName:n,qu:r,path:Nt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Zg(t){const e=t._freezeSettings(),n=Hd(t._databaseId);return new wD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function xD(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);ey("Data must be an object, but it was:",o,r);const l=SI(r,o);let c,d;if(i.merge)c=new hn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=Xp(e,f,n);if(!o.contains(m))throw new le(Y.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);II(h,m)||h.push(m)}c=new hn(h),d=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,d=o.fieldTransforms;return new _D(new nn(l),c,d)}class Xd extends Qg{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xd}}function ED(t,e,n,r){const s=t.Qu(1,e,n);ey("Data must be an object, but it was:",s,r);const i=[],o=nn.empty();vi(r,(c,d)=>{const h=ty(e,c,n);d=Ve(d);const f=s.Nu(h);if(d instanceof Xd)i.push(h);else{const m=ql(d,f);m!=null&&(i.push(h),o.set(h,m))}});const l=new hn(i);return new xI(o,l,s.fieldTransforms)}function SD(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[Xp(e,r,n)],c=[s];if(i.length%2!=0)throw new le(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(Xp(e,i[m])),c.push(i[m+1]);const d=[],h=nn.empty();for(let m=l.length-1;m>=0;--m)if(!II(d,l[m])){const y=l[m];let C=c[m];C=Ve(C);const w=o.Nu(y);if(C instanceof Xd)d.push(y);else{const R=ql(C,w);R!=null&&(d.push(y),h.set(y,R))}}const f=new hn(d);return new xI(h,f,o.fieldTransforms)}function CD(t,e,n,r=!1){return ql(n,t.Qu(r?4:3,e))}function ql(t,e){if(CI(t=Ve(t)))return ey("Unsupported field value:",e,t),SI(t,e);if(t instanceof Qg)return function(r,s){if(!EI(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=ql(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ve(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=yt.fromDate(r);return{timestampValue:Ku(s.serializer,i)}}if(r instanceof yt){const i=new yt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ku(s.serializer,i)}}if(r instanceof Yg)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Eo)return{bytesValue:$C(s.serializer,r._byteString)};if(r instanceof Jt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Og(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Jg)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Pg(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Qd(r)}`)}(t,e)}function SI(t,e){const n={};return gC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vi(t,(r,s)=>{const i=ql(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function CI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof yt||t instanceof Yg||t instanceof Eo||t instanceof Jt||t instanceof Qg||t instanceof Jg)}function ey(t,e,n){if(!CI(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Qd(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Xp(t,e,n){if((e=Ve(e))instanceof Jd)return e._internalPath;if(typeof e=="string")return ty(t,e);throw Ju("Field path arguments must be of type string or ",t,!1,void 0,n)}const ID=new RegExp("[~\\*/\\[\\]]");function ty(t,e,n){if(e.search(ID)>=0)throw Ju(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Jd(...e.split("."))._internalPath}catch{throw Ju(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ju(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new le(Y.INVALID_ARGUMENT,l+t+c)}function II(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new TD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ny("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class TD extends TI{data(){return super.data()}}function ny(t,e){return typeof e=="string"?ty(t,e):e instanceof Jd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bD(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new le(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ry{}let ND=class extends ry{};function bI(t,e,...n){let r=[];e instanceof ry&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof sy).length,l=i.filter(c=>c instanceof Zd).length;if(o>1||o>0&&l>0)throw new le(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Zd extends ND{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Zd(e,n,r)}_apply(e){const n=this._parse(e);return NI(e._query,n),new Fo(e.firestore,e.converter,Bp(e._query,n))}_parse(e){const n=Zg(e.firestore);return function(i,o,l,c,d,h,f){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new le(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){iw(f,h);const y=[];for(const C of f)y.push(sw(c,i,C));m={arrayValue:{values:y}}}else m=sw(c,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||iw(f,h),m=CD(l,o,f,h==="in"||h==="not-in");return ct.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Wi(t,e,n){const r=e,s=ny("where",t);return Zd._create(s,r,n)}class sy extends ry{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new sy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Bn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)NI(o,c),o=Bp(o,c)}(e._query,n),new Fo(e.firestore,e.converter,Bp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function sw(t,e,n){if(typeof(n=Ve(n))=="string"){if(n==="")throw new le(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!IC(e)&&n.indexOf("/")!==-1)throw new le(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(We.fromString(n));if(!he.isDocumentKey(r))throw new le(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return T0(t,new he(r))}if(n instanceof Jt)return T0(t,n._key);throw new le(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Qd(n)}.`)}function iw(t,e){if(!Array.isArray(t)||t.length===0)throw new le(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function NI(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new le(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new le(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class kD{convertValue(e,n="none"){switch(li(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ai(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ge()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return vi(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>rt(o.doubleValue));return new Jg(i)}convertGeoPoint(e){return new Yg(rt(e.latitude),rt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=bg(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(gl(e));default:return null}}convertTimestamp(e){const n=Ss(e);return new yt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=We.fromString(e);Oe(GC(r));const s=new yl(r.get(1),r.get(3)),i=new he(r.popFirst(5));return s.isEqual(n)||Rr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class kI extends TI{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ou(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ny("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class ou extends kI{data(e={}){return super.data(e)}}class AD{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Na(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ou(this._firestore,this._userDataWriter,r.key,r,new Na(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new le(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new ou(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Na(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new ou(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Na(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:PD(l.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function PD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(t){t=rr(t,Jt);const e=rr(t.firestore,Vo);return fD(Kg(e),t._key).then(n=>DD(e,t,n))}class RI extends kD{constructor(e){super(),this.firestore=e}convertBytes(e){return new Eo(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Jt(this.firestore,null,n)}}function ot(t){t=rr(t,Fo);const e=rr(t.firestore,Vo),n=Kg(e),r=new RI(e);return bD(t._query),pD(n,t._query).then(s=>new AD(e,r,t,s))}function AI(t,e,n){t=rr(t,Jt);const r=rr(t.firestore,Vo),s=RD(t.converter,e);return iy(r,[xD(Zg(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Vn.none())])}function Js(t,e,n,...r){t=rr(t,Jt);const s=rr(t.firestore,Vo),i=Zg(s);let o;return o=typeof(e=Ve(e))=="string"||e instanceof Jd?SD(i,"updateDoc",t._key,e,n,r):ED(i,"updateDoc",t._key,e),iy(s,[o.toMutation(t._key,Vn.exists(!0))])}function jD(t){return iy(rr(t.firestore,Vo),[new jg(t._key,Vn.none())])}function iy(t,e){return function(r,s){const i=new Er;return r.asyncQueue.enqueueAndForget(async()=>nD(await hD(r),s,i)),i.promise}(Kg(t),e)}function DD(t,e,n){const r=n.docs.get(e._key),s=new RI(t);return new kI(t,s,e._key,r,new Na(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Lo=s})(yi),ii(new xs("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new Vo(new L2(r.getProvider("auth-internal")),new V2(r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new le(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yl(d.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Jn(x0,"4.7.3",e),Jn(x0,"4.7.3","esm2017")})();var LD="firebase",OD="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jn(LD,OD,"app");var ow={};const aw="@firebase/database",lw="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PI="";function MD(t){PI=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),pt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:fl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return ir(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jI=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new FD(e)}}catch{}return new VD},Gs=jI("localStorage"),UD=jI("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no=new Fd("@firebase/database"),$D=function(){let t=1;return function(){return t++}}(),DI=function(t){const e=IA(t),n=new xA;n.update(e);const r=n.digest();return wg.encodeByteArray(r)},Wl=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Wl.apply(null,r):typeof r=="object"?e+=pt(r):e+=r,e+=" "}return e};let Ba=null,cw=!0;const BD=function(t,e){re(!0,"Can't turn on custom loggers persistently."),no.logLevel=Ie.VERBOSE,Ba=no.log.bind(no)},bt=function(...t){if(cw===!0&&(cw=!1,Ba===null&&UD.get("logging_enabled")===!0&&BD()),Ba){const e=Wl.apply(null,t);Ba(e)}},Hl=function(t){return function(...e){bt(t,...e)}},Zp=function(...t){const e="FIREBASE INTERNAL ERROR: "+Wl(...t);no.error(e)},Pr=function(...t){const e=`FIREBASE FATAL ERROR: ${Wl(...t)}`;throw no.error(e),new Error(e)},Xt=function(...t){const e="FIREBASE WARNING: "+Wl(...t);no.warn(e)},zD=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Xt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},oy=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},qD=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ci="[MIN_NAME]",Is="[MAX_NAME]",wi=function(t,e){if(t===e)return 0;if(t===ci||e===Is)return-1;if(e===ci||t===Is)return 1;{const n=uw(t),r=uw(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},WD=function(t,e){return t===e?0:t<e?-1:1},fa=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+pt(e))},ay=function(t){if(typeof t!="object"||t===null)return pt(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=pt(e[r]),n+=":",n+=ay(t[e[r]]);return n+="}",n},LI=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function jt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const OI=function(t){re(!oy(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,l,c;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=l+r,o=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const d=[];for(c=n;c;c-=1)d.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)d.push(i%2?1:0),i=Math.floor(i/2);d.push(s?1:0),d.reverse();const h=d.join("");let f="";for(c=0;c<64;c+=8){let m=parseInt(h.substr(c,8),2).toString(16);m.length===1&&(m="0"+m),f=f+m}return f.toLowerCase()},HD=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},GD=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function KD(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const QD=new RegExp("^-?(0*)\\d{1,10}$"),YD=-2147483648,JD=2147483647,uw=function(t){if(QD.test(t)){const e=Number(t);if(e>=YD&&e<=JD)return e}return null},Uo=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Xt("Exception was thrown by user callback.",n),e},Math.floor(0))}},XD=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},za=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Xt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(bt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Xt(e)}}class au{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}au.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly="5",MI="v",FI="s",VI="r",UI="f",$I=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,BI="ls",zI="p",em="ac",qI="websocket",WI="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e,n,r,s,i=!1,o="",l=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Gs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Gs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function t4(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function GI(t,e,n){re(typeof e=="string","typeof type must == string"),re(typeof n=="object","typeof params must == object");let r;if(e===qI)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===WI)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);t4(t)&&(n.ns=t.namespace);const s=[];return jt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(){this.counters_={}}incrementCounter(e,n=1){ir(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return nA(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf={},_f={};function cy(t){const e=t.toString();return vf[e]||(vf[e]=new n4),vf[e]}function r4(t,e){const n=t.toString();return _f[n]||(_f[n]=e()),_f[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&Uo(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw="start",i4="close",o4="pLPCommand",a4="pRTLPCB",KI="id",QI="pw",YI="ser",l4="cb",c4="seg",u4="ts",d4="d",h4="dframe",JI=1870,XI=30,f4=JI-XI,p4=25e3,m4=3e4;class Hi{constructor(e,n,r,s,i,o,l){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Hl(e),this.stats_=cy(n),this.urlFn=c=>(this.appCheckToken&&(c[em]=this.appCheckToken),GI(n,WI,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new s4(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(m4)),qD(()=>{if(this.isClosed_)return;this.scriptTagHolder=new uy((...i)=>{const[o,l,c,d,h]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===dw)this.id=l,this.password=c;else if(o===i4)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,l]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[dw]="t",r[YI]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[l4]=this.scriptTagHolder.uniqueCallbackIdentifier),r[MI]=ly,this.transportSessionId&&(r[FI]=this.transportSessionId),this.lastSessionId&&(r[BI]=this.lastSessionId),this.applicationId&&(r[zI]=this.applicationId),this.appCheckToken&&(r[em]=this.appCheckToken),typeof location<"u"&&location.hostname&&$I.test(location.hostname)&&(r[VI]=UI);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Hi.forceAllow_=!0}static forceDisallow(){Hi.forceDisallow_=!0}static isAvailable(){return Hi.forceAllow_?!0:!Hi.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!HD()&&!GD()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=pt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=KS(n),s=LI(r,f4);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[h4]="t",r[KI]=e,r[QI]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=pt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class uy{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=$D(),window[o4+this.uniqueCallbackIdentifier]=e,window[a4+this.uniqueCallbackIdentifier]=n,this.myIFrame=uy.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){bt("frame writing exception"),l.stack&&bt(l.stack),bt(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||bt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[KI]=this.myID,e[QI]=this.myPW,e[YI]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+XI+r.length<=JI;){const o=this.pendingSegs.shift();r=r+"&"+c4+s+"="+o.seg+"&"+u4+s+"="+o.ts+"&"+d4+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(p4)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{bt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g4=16384,y4=45e3;let Xu=null;typeof MozWebSocket<"u"?Xu=MozWebSocket:typeof WebSocket<"u"&&(Xu=WebSocket);class Ln{constructor(e,n,r,s,i,o,l){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Hl(this.connId),this.stats_=cy(n),this.connURL=Ln.connectionURL_(n,o,l,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[MI]=ly,typeof location<"u"&&location.hostname&&$I.test(location.hostname)&&(o[VI]=UI),n&&(o[FI]=n),r&&(o[BI]=r),s&&(o[em]=s),i&&(o[zI]=i),GI(e,qI,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Gs.set("previous_websocket_failure",!0);try{let r;hA(),this.mySock=new Xu(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Ln.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Xu!==null&&!Ln.forceDisallow_}static previouslyFailed(){return Gs.isInMemoryStorage||Gs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Gs.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=fl(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(re(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=pt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=LI(n,g4);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(y4))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ln.responsesRequiredToBeHealthy=2;Ln.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Hi,Ln]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=Ln&&Ln.isAvailable();let r=n&&!Ln.previouslyFailed();if(e.webSocketOnly&&(n||Xt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Ln];else{const s=this.transports_=[];for(const i of xl.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);xl.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}xl.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4=6e4,_4=5e3,w4=10*1024,x4=100*1024,wf="t",hw="d",E4="s",fw="r",S4="e",pw="o",mw="a",gw="n",yw="p",C4="h";class I4{constructor(e,n,r,s,i,o,l,c,d,h){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=c,this.onKill_=d,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Hl("c:"+this.id+":"),this.transportManager_=new xl(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=za(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>x4?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>w4?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(wf in e){const n=e[wf];n===mw?this.upgradeIfSecondaryHealthy_():n===fw?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===pw&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=fa("t",e),r=fa("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:yw,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:mw,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:gw,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=fa("t",e),r=fa("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=fa(wf,e);if(hw in e){const r=e[hw];if(n===C4){const s=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===gw){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===E4?this.onConnectionShutdown_(r):n===fw?this.onReset_(r):n===S4?Zp("Server Error: "+r):n===pw?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Zp("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),ly!==r&&Xt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),za(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(v4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):za(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(_4))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:yw,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Gs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e){this.allowedEvents_=e,this.listeners_={},re(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){re(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu extends e1{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!xg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Zu}getInitialEvent(e){return re(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw=32,_w=768;class Me{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Ae(){return new Me("")}function xe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ts(t){return t.pieces_.length-t.pieceNum_}function $e(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Me(t.pieces_,e)}function dy(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function T4(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function El(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function t1(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Me(e,0)}function tt(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Me)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Me(n,0)}function Ee(t){return t.pieceNum_>=t.pieces_.length}function Qt(t,e){const n=xe(t),r=xe(e);if(n===null)return e;if(n===r)return Qt($e(t),$e(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function b4(t,e){const n=El(t,0),r=El(e,0);for(let s=0;s<n.length&&s<r.length;s++){const i=wi(n[s],r[s]);if(i!==0)return i}return n.length===r.length?0:n.length<r.length?-1:1}function hy(t,e){if(Ts(t)!==Ts(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function En(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ts(t)>Ts(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class N4{constructor(e,n){this.errorPrefix_=n,this.parts_=El(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Md(this.parts_[r]);n1(this)}}function k4(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Md(e),n1(t)}function R4(t){const e=t.parts_.pop();t.byteLength_-=Md(e),t.parts_.length>0&&(t.byteLength_-=1)}function n1(t){if(t.byteLength_>_w)throw new Error(t.errorPrefix_+"has a key path longer than "+_w+" bytes ("+t.byteLength_+").");if(t.parts_.length>vw)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+vw+") or object contains a cycle "+Bs(t))}function Bs(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy extends e1{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new fy}getInitialEvent(e){return re(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=1e3,A4=60*5*1e3,ww=30*1e3,P4=1.3,j4=3e4,D4="server_kill",xw=3;class Sr extends ZI{constructor(e,n,r,s,i,o,l,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=Sr.nextPersistentConnectionId_++,this.log_=Hl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=pa,this.maxReconnectDelay_=A4,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");fy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Zu.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(pt(i)),re(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Ll,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),re(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),re(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,l=>{const c=l.d,d=l.s;Sr.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",l),d!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(d,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&ir(e,"w")){const r=mo(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Xt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||wA(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=ww)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=_A(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),re(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+pt(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Zp("Unrecognized action received from server: "+pt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){re(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=pa,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=pa,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>j4&&(this.reconnectDelay_=pa),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*P4)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Sr.nextConnectionId_++,i=this.lastSessionId;let o=!1,l=null;const c=function(){l?l.close():(o=!0,r())},d=function(f){re(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(f)};this.realtime_={close:c,sendRequest:d};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,m]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?bt("getToken() completed but was canceled"):(bt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=m&&m.token,l=new I4(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,y=>{Xt(y+" ("+this.repoInfo_.toString()+")"),this.interrupt(D4)},i))}catch(f){this.log_("Failed to get token: "+f),o||(this.repoInfo_.nodeAdmin&&Xt(f),c())}}}interrupt(e){bt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){bt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Rp(this.interruptReasons_)&&(this.reconnectDelay_=pa,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>ay(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Me(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){bt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=xw&&(this.reconnectDelay_=ww,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){bt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=xw&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+PI.replace(/\./g,"-")]=1,xg()?e["framework.cordova"]=1:tC()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Zu.getInstance().currentlyOnline();return Rp(this.interruptReasons_)&&e}}Sr.nextPersistentConnectionId_=0;Sr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Se(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new Se(ci,e),s=new Se(ci,n);return this.compare(r,s)!==0}minPost(){return Se.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $c;class r1 extends eh{static get __EMPTY_NODE(){return $c}static set __EMPTY_NODE(e){$c=e}compare(e,n){return wi(e.name,n.name)}isDefinedOn(e){throw jo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Se.MIN}maxPost(){return new Se(Is,$c)}makePost(e,n){return re(typeof e=="string","KeyIndex indexValue must always be a string."),new Se(e,$c)}toString(){return".key"}}const Xs=new r1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Et{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Et.RED,this.left=s??sn.EMPTY_NODE,this.right=i??sn.EMPTY_NODE}copy(e,n,r,s,i){return new Et(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return sn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return sn.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Et.RED=!0;Et.BLACK=!1;class L4{copy(e,n,r,s,i){return this}insert(e,n,r){return new Et(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class sn{constructor(e,n=sn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new sn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Et.BLACK,null,null))}remove(e){return new sn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Et.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Bc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Bc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Bc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Bc(this.root_,null,this.comparator_,!0,e)}}sn.EMPTY_NODE=new L4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O4(t,e){return wi(t.name,e.name)}function py(t,e){return wi(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tm;function M4(t){tm=t}const s1=function(t){return typeof t=="number"?"number:"+OI(t):"string:"+t},i1=function(t){if(t.isLeafNode()){const e=t.val();re(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ir(e,".sv"),"Priority must be a string or number.")}else re(t===tm||t.isEmpty(),"priority of unexpected type.");re(t===tm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ew;class _t{constructor(e,n=_t.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,re(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),i1(this.priorityNode_)}static set __childrenNodeConstructor(e){Ew=e}static get __childrenNodeConstructor(){return Ew}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new _t(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:_t.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ee(e)?this:xe(e)===".priority"?this.priorityNode_:_t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:_t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=xe(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(re(r!==".priority"||Ts(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,_t.__childrenNodeConstructor.EMPTY_NODE.updateChild($e(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+s1(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=OI(this.value_):e+=this.value_,this.lazyHash_=DI(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===_t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof _t.__childrenNodeConstructor?-1:(re(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=_t.VALUE_TYPE_ORDER.indexOf(n),i=_t.VALUE_TYPE_ORDER.indexOf(r);return re(s>=0,"Unknown leaf type: "+n),re(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}_t.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let o1,a1;function F4(t){o1=t}function V4(t){a1=t}class U4 extends eh{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?wi(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Se.MIN}maxPost(){return new Se(Is,new _t("[PRIORITY-POST]",a1))}makePost(e,n){const r=o1(e);return new Se(n,new _t("[PRIORITY-POST]",r))}toString(){return".priority"}}const Qe=new U4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $4=Math.log(2);class B4{constructor(e){const n=i=>parseInt(Math.log(i)/$4,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ed=function(t,e,n,r){t.sort(e);const s=function(c,d){const h=d-c;let f,m;if(h===0)return null;if(h===1)return f=t[c],m=n?n(f):f,new Et(m,f.node,Et.BLACK,null,null);{const y=parseInt(h/2,10)+c,C=s(c,y),w=s(y+1,d);return f=t[y],m=n?n(f):f,new Et(m,f.node,Et.BLACK,C,w)}},i=function(c){let d=null,h=null,f=t.length;const m=function(C,w){const R=f-C,T=f;f-=C;const x=s(R+1,T),_=t[R],O=n?n(_):_;y(new Et(O,_.node,w,null,x))},y=function(C){d?(d.left=C,d=C):(h=C,d=C)};for(let C=0;C<c.count;++C){const w=c.nextBitIsOne(),R=Math.pow(2,c.count-(C+1));w?m(R,Et.BLACK):(m(R,Et.BLACK),m(R,Et.RED))}return h},o=new B4(t.length),l=i(o);return new sn(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xf;const ki={};class gr{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return re(ki&&Qe,"ChildrenNode.ts has not been loaded"),xf=xf||new gr({".priority":ki},{".priority":Qe}),xf}get(e){const n=mo(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof sn?n:null}hasIndex(e){return ir(this.indexSet_,e.toString())}addIndex(e,n){re(e!==Xs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(Se.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let l;s?l=ed(r,e.getCompare()):l=ki;const c=e.toString(),d=Object.assign({},this.indexSet_);d[c]=e;const h=Object.assign({},this.indexes_);return h[c]=l,new gr(h,d)}addToIndexes(e,n){const r=Uu(this.indexes_,(s,i)=>{const o=mo(this.indexSet_,i);if(re(o,"Missing index implementation for "+i),s===ki)if(o.isDefinedOn(e.node)){const l=[],c=n.getIterator(Se.Wrap);let d=c.getNext();for(;d;)d.name!==e.name&&l.push(d),d=c.getNext();return l.push(e),ed(l,o.getCompare())}else return ki;else{const l=n.get(e.name);let c=s;return l&&(c=c.remove(new Se(e.name,l))),c.insert(e,e.node)}});return new gr(r,this.indexSet_)}removeFromIndexes(e,n){const r=Uu(this.indexes_,s=>{if(s===ki)return s;{const i=n.get(e.name);return i?s.remove(new Se(e.name,i)):s}});return new gr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ma;class fe{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&i1(this.priorityNode_),this.children_.isEmpty()&&re(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ma||(ma=new fe(new sn(py),null,gr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ma}updatePriority(e){return this.children_.isEmpty()?this:new fe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?ma:n}}getChild(e){const n=xe(e);return n===null?this:this.getImmediateChild(n).getChild($e(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(re(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new Se(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?ma:this.priorityNode_;return new fe(s,o,i)}}updateChild(e,n){const r=xe(e);if(r===null)return n;{re(xe(e)!==".priority"||Ts(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild($e(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(Qe,(o,l)=>{n[o]=l.val(e),r++,i&&fe.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const l in n)o[l]=n[l];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+s1(this.getPriority().val())+":"),this.forEachChild(Qe,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":DI(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new Se(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new Se(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new Se(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,Se.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,Se.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Gl?-1:0}withIndex(e){if(e===Xs||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new fe(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Xs||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Qe),s=n.getIterator(Qe);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Xs?null:this.indexMap_.get(e.toString())}}fe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class z4 extends fe{constructor(){super(new sn(py),fe.EMPTY_NODE,gr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return fe.EMPTY_NODE}isEmpty(){return!1}}const Gl=new z4;Object.defineProperties(Se,{MIN:{value:new Se(ci,fe.EMPTY_NODE)},MAX:{value:new Se(Is,Gl)}});r1.__EMPTY_NODE=fe.EMPTY_NODE;_t.__childrenNodeConstructor=fe;M4(Gl);V4(Gl);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=!0;function ft(t,e=null){if(t===null)return fe.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),re(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new _t(n,ft(e))}if(!(t instanceof Array)&&q4){const n=[];let r=!1;if(jt(t,(o,l)=>{if(o.substring(0,1)!=="."){const c=ft(l);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new Se(o,c)))}}),n.length===0)return fe.EMPTY_NODE;const i=ed(n,O4,o=>o.name,py);if(r){const o=ed(n,Qe.getCompare());return new fe(i,ft(e),new gr({".priority":o},{".priority":Qe}))}else return new fe(i,ft(e),gr.Default)}else{let n=fe.EMPTY_NODE;return jt(t,(r,s)=>{if(ir(t,r)&&r.substring(0,1)!=="."){const i=ft(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(ft(e))}}F4(ft);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my extends eh{constructor(e){super(),this.indexPath_=e,re(!Ee(e)&&xe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?wi(e.name,n.name):i}makePost(e,n){const r=ft(e),s=fe.EMPTY_NODE.updateChild(this.indexPath_,r);return new Se(n,s)}maxPost(){const e=fe.EMPTY_NODE.updateChild(this.indexPath_,Gl);return new Se(Is,e)}toString(){return El(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4 extends eh{compare(e,n){const r=e.node.compareTo(n.node);return r===0?wi(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Se.MIN}maxPost(){return Se.MAX}makePost(e,n){const r=ft(e);return new Se(n,r)}toString(){return".value"}}const l1=new W4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c1(t){return{type:"value",snapshotNode:t}}function So(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Sl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Cl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function H4(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){re(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(s).equals(r.getChild(s))&&l.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Sl(n,l)):re(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(So(n,r)):o.trackChildChange(Cl(n,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Qe,(s,i)=>{n.hasChild(s)||r.trackChildChange(Sl(s,i))}),n.isLeafNode()||n.forEachChild(Qe,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(Cl(s,i,o))}else r.trackChildChange(So(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?fe.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e){this.indexedFilter_=new gy(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Il.getStartPost_(e),this.endPost_=Il.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,o){return this.matches(new Se(n,r))||(r=fe.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=fe.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(fe.EMPTY_NODE);const i=this;return n.forEachChild(Qe,(o,l)=>{i.matches(new Se(o,l))||(s=s.updateImmediateChild(o,fe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Il(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new Se(n,r))||(r=fe.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=fe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=fe.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const l=i.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(fe.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let o=0;for(;i.hasNext();){const l=i.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:s=s.updateImmediateChild(l.name,fe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const f=this.index_.getCompare();o=(m,y)=>f(y,m)}else o=this.index_.getCompare();const l=e;re(l.numChildren()===this.limit_,"");const c=new Se(n,r),d=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(l.hasChild(n)){const f=l.getImmediateChild(n);let m=s.getChildAfterChild(this.index_,d,this.reverse_);for(;m!=null&&(m.name===n||l.hasChild(m.name));)m=s.getChildAfterChild(this.index_,m,this.reverse_);const y=m==null?1:o(m,c);if(h&&!r.isEmpty()&&y>=0)return i!=null&&i.trackChildChange(Cl(n,r,f)),l.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(Sl(n,f));const w=l.updateImmediateChild(n,fe.EMPTY_NODE);return m!=null&&this.rangedFilter_.matches(m)?(i!=null&&i.trackChildChange(So(m.name,m.node)),w.updateImmediateChild(m.name,m.node)):w}}else return r.isEmpty()?e:h&&o(d,c)>=0?(i!=null&&(i.trackChildChange(Sl(d.name,d.node)),i.trackChildChange(So(n,r))),l.updateImmediateChild(n,r).updateImmediateChild(d.name,fe.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Qe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return re(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return re(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ci}hasEnd(){return this.endSet_}getIndexEndValue(){return re(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return re(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Is}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return re(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Qe}copy(){const e=new yy;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function K4(t){return t.loadsAllData()?new gy(t.getIndex()):t.hasLimit()?new G4(t):new Il(t)}function Q4(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Y4(t,e){const n=t.copy();return n.index_=e,n}function Sw(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Qe?n="$priority":t.index_===l1?n="$value":t.index_===Xs?n="$key":(re(t.index_ instanceof my,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=pt(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=pt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+pt(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=pt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+pt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Cw(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Qe&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends ZI{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=Hl("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(re(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=td.getListenId_(e,r),l={};this.listens_[o]=l;const c=Sw(e._queryParams);this.restRequest_(i+".json",c,(d,h)=>{let f=h;if(d===404&&(f=null,d=null),d===null&&this.onDataUpdate_(i,f,!1,r),mo(this.listens_,o)===l){let m;d?d===401?m="permission_denied":m="rest_error:"+d:m="ok",s(m,null)}})}unlisten(e,n){const r=td.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Sw(e._queryParams),r=e._path.toString(),s=new Ll;return this.restRequest_(r+".json",n,(i,o)=>{let l=o;i===404&&(l=null,i=null),i===null?(this.onDataUpdate_(r,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Do(n);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=fl(l.responseText)}catch{Xt("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,c)}else l.status!==401&&l.status!==404&&Xt("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(){this.rootNode_=fe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(){return{value:null,children:new Map}}function u1(t,e,n){if(Ee(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=xe(e);t.children.has(r)||t.children.set(r,nd());const s=t.children.get(r);e=$e(e),u1(s,e,n)}}function nm(t,e,n){t.value!==null?n(e,t.value):X4(t,(r,s)=>{const i=new Me(e.toString()+"/"+r);nm(s,i,n)})}function X4(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&jt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw=10*1e3,eL=30*1e3,tL=5*60*1e3;class nL{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Z4(e);const r=Iw+(eL-Iw)*Math.random();za(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;jt(e,(s,i)=>{i>0&&ir(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),za(this.reportStats_.bind(this),Math.floor(Math.random()*2*tL))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var On;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(On||(On={}));function vy(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function _y(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function wy(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=On.ACK_USER_WRITE,this.source=vy()}operationForChild(e){if(Ee(this.path)){if(this.affectedTree.value!=null)return re(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Me(e));return new rd(Ae(),n,this.revert)}}else return re(xe(this.path)===e,"operationForChild called for unrelated child."),new rd($e(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,n){this.source=e,this.path=n,this.type=On.LISTEN_COMPLETE}operationForChild(e){return Ee(this.path)?new Tl(this.source,Ae()):new Tl(this.source,$e(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=On.OVERWRITE}operationForChild(e){return Ee(this.path)?new ui(this.source,Ae(),this.snap.getImmediateChild(e)):new ui(this.source,$e(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=On.MERGE}operationForChild(e){if(Ee(this.path)){const n=this.children.subtree(new Me(e));return n.isEmpty()?null:n.value?new ui(this.source,Ae(),n.value):new Co(this.source,Ae(),n)}else return re(xe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Co(this.source,$e(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ee(e))return this.isFullyInitialized()&&!this.filtered_;const n=xe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function sL(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(H4(o.childName,o.snapshotNode))}),ga(t,s,"child_removed",e,r,n),ga(t,s,"child_added",e,r,n),ga(t,s,"child_moved",i,r,n),ga(t,s,"child_changed",e,r,n),ga(t,s,"value",e,r,n),s}function ga(t,e,n,r,s,i){const o=r.filter(l=>l.type===n);o.sort((l,c)=>oL(t,l,c)),o.forEach(l=>{const c=iL(t,l,i);s.forEach(d=>{d.respondsTo(l.type)&&e.push(d.createEvent(c,t.query_))})})}function iL(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function oL(t,e,n){if(e.childName==null||n.childName==null)throw jo("Should only compare child_ events.");const r=new Se(e.childName,e.snapshotNode),s=new Se(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(t,e){return{eventCache:t,serverCache:e}}function qa(t,e,n,r){return th(new bs(e,n,r),t.serverCache)}function d1(t,e,n,r){return th(t.eventCache,new bs(e,n,r))}function sd(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function di(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ef;const aL=()=>(Ef||(Ef=new sn(WD)),Ef);class Ue{constructor(e,n=aL()){this.value=e,this.children=n}static fromObject(e){let n=new Ue(null);return jt(e,(r,s)=>{n=n.set(new Me(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Ae(),value:this.value};if(Ee(e))return null;{const r=xe(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue($e(e),n);return i!=null?{path:tt(new Me(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ee(e))return this;{const n=xe(e),r=this.children.get(n);return r!==null?r.subtree($e(e)):new Ue(null)}}set(e,n){if(Ee(e))return new Ue(n,this.children);{const r=xe(e),i=(this.children.get(r)||new Ue(null)).set($e(e),n),o=this.children.insert(r,i);return new Ue(this.value,o)}}remove(e){if(Ee(e))return this.children.isEmpty()?new Ue(null):new Ue(null,this.children);{const n=xe(e),r=this.children.get(n);if(r){const s=r.remove($e(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Ue(null):new Ue(this.value,i)}else return this}}get(e){if(Ee(e))return this.value;{const n=xe(e),r=this.children.get(n);return r?r.get($e(e)):null}}setTree(e,n){if(Ee(e))return n;{const r=xe(e),i=(this.children.get(r)||new Ue(null)).setTree($e(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new Ue(this.value,o)}}fold(e){return this.fold_(Ae(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(tt(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Ae(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(Ee(e))return null;{const i=xe(e),o=this.children.get(i);return o?o.findOnPath_($e(e),tt(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Ae(),n)}foreachOnPath_(e,n,r){if(Ee(e))return this;{this.value&&r(n,this.value);const s=xe(e),i=this.children.get(s);return i?i.foreachOnPath_($e(e),tt(n,s),r):new Ue(null)}}foreach(e){this.foreach_(Ae(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(tt(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.writeTree_=e}static empty(){return new Un(new Ue(null))}}function Wa(t,e,n){if(Ee(e))return new Un(new Ue(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=Qt(s,e);return i=i.updateChild(o,n),new Un(t.writeTree_.set(s,i))}else{const s=new Ue(n),i=t.writeTree_.setTree(e,s);return new Un(i)}}}function rm(t,e,n){let r=t;return jt(n,(s,i)=>{r=Wa(r,tt(e,s),i)}),r}function Tw(t,e){if(Ee(e))return Un.empty();{const n=t.writeTree_.setTree(e,new Ue(null));return new Un(n)}}function sm(t,e){return xi(t,e)!=null}function xi(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Qt(n.path,e)):null}function bw(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Qe,(r,s)=>{e.push(new Se(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new Se(r,s.value))}),e}function gs(t,e){if(Ee(e))return t;{const n=xi(t,e);return n!=null?new Un(new Ue(n)):new Un(t.writeTree_.subtree(e))}}function im(t){return t.writeTree_.isEmpty()}function Io(t,e){return h1(Ae(),t.writeTree_,e)}function h1(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(re(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=h1(tt(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(tt(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(t,e){return g1(e,t)}function lL(t,e,n,r,s){re(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Wa(t.visibleWrites,e,n)),t.lastWriteId=r}function cL(t,e,n,r){re(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=rm(t.visibleWrites,e,n),t.lastWriteId=r}function uL(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function dL(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);re(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const l=t.allWrites[o];l.visible&&(o>=n&&hL(l,r.path)?s=!1:En(r.path,l.path)&&(i=!0)),o--}if(s){if(i)return fL(t),!0;if(r.snap)t.visibleWrites=Tw(t.visibleWrites,r.path);else{const l=r.children;jt(l,c=>{t.visibleWrites=Tw(t.visibleWrites,tt(r.path,c))})}return!0}else return!1}function hL(t,e){if(t.snap)return En(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&En(tt(t.path,n),e))return!0;return!1}function fL(t){t.visibleWrites=f1(t.allWrites,pL,Ae()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function pL(t){return t.visible}function f1(t,e,n){let r=Un.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let l;if(i.snap)En(n,o)?(l=Qt(n,o),r=Wa(r,l,i.snap)):En(o,n)&&(l=Qt(o,n),r=Wa(r,Ae(),i.snap.getChild(l)));else if(i.children){if(En(n,o))l=Qt(n,o),r=rm(r,l,i.children);else if(En(o,n))if(l=Qt(o,n),Ee(l))r=rm(r,Ae(),i.children);else{const c=mo(i.children,xe(l));if(c){const d=c.getChild($e(l));r=Wa(r,Ae(),d)}}}else throw jo("WriteRecord should have .snap or .children")}}return r}function p1(t,e,n,r,s){if(!r&&!s){const i=xi(t.visibleWrites,e);if(i!=null)return i;{const o=gs(t.visibleWrites,e);if(im(o))return n;if(n==null&&!sm(o,Ae()))return null;{const l=n||fe.EMPTY_NODE;return Io(o,l)}}}else{const i=gs(t.visibleWrites,e);if(!s&&im(i))return n;if(!s&&n==null&&!sm(i,Ae()))return null;{const o=function(d){return(d.visible||s)&&(!r||!~r.indexOf(d.writeId))&&(En(d.path,e)||En(e,d.path))},l=f1(t.allWrites,o,e),c=n||fe.EMPTY_NODE;return Io(l,c)}}}function mL(t,e,n){let r=fe.EMPTY_NODE;const s=xi(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Qe,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=gs(t.visibleWrites,e);return n.forEachChild(Qe,(o,l)=>{const c=Io(gs(i,new Me(o)),l);r=r.updateImmediateChild(o,c)}),bw(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=gs(t.visibleWrites,e);return bw(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function gL(t,e,n,r,s){re(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=tt(e,n);if(sm(t.visibleWrites,i))return null;{const o=gs(t.visibleWrites,i);return im(o)?s.getChild(n):Io(o,s.getChild(n))}}function yL(t,e,n,r){const s=tt(e,n),i=xi(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=gs(t.visibleWrites,s);return Io(o,r.getNode().getImmediateChild(n))}else return null}function vL(t,e){return xi(t.visibleWrites,e)}function _L(t,e,n,r,s,i,o){let l;const c=gs(t.visibleWrites,e),d=xi(c,Ae());if(d!=null)l=d;else if(n!=null)l=Io(c,n);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const h=[],f=o.getCompare(),m=i?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let y=m.getNext();for(;y&&h.length<s;)f(y,r)!==0&&h.push(y),y=m.getNext();return h}else return[]}function wL(){return{visibleWrites:Un.empty(),allWrites:[],lastWriteId:-1}}function id(t,e,n,r){return p1(t.writeTree,t.treePath,e,n,r)}function xy(t,e){return mL(t.writeTree,t.treePath,e)}function Nw(t,e,n,r){return gL(t.writeTree,t.treePath,e,n,r)}function od(t,e){return vL(t.writeTree,tt(t.treePath,e))}function xL(t,e,n,r,s,i){return _L(t.writeTree,t.treePath,e,n,r,s,i)}function Ey(t,e,n){return yL(t.writeTree,t.treePath,e,n)}function m1(t,e){return g1(tt(t.treePath,e),t.writeTree)}function g1(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;re(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),re(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Cl(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,Sl(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,So(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Cl(r,e.snapshotNode,s.oldSnap));else throw jo("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const y1=new SL;class Sy{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new bs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ey(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:di(this.viewCache_),i=xL(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CL(t){return{filter:t}}function IL(t,e){re(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),re(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function TL(t,e,n,r,s){const i=new EL;let o,l;if(n.type===On.OVERWRITE){const d=n;d.source.fromUser?o=om(t,e,d.path,d.snap,r,s,i):(re(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered()&&!Ee(d.path),o=ad(t,e,d.path,d.snap,r,s,l,i))}else if(n.type===On.MERGE){const d=n;d.source.fromUser?o=NL(t,e,d.path,d.children,r,s,i):(re(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered(),o=am(t,e,d.path,d.children,r,s,l,i))}else if(n.type===On.ACK_USER_WRITE){const d=n;d.revert?o=AL(t,e,d.path,r,s,i):o=kL(t,e,d.path,d.affectedTree,r,s,i)}else if(n.type===On.LISTEN_COMPLETE)o=RL(t,e,n.path,r,i);else throw jo("Unknown operation type: "+n.type);const c=i.getChanges();return bL(e,o,c),{viewCache:o,changes:c}}function bL(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=sd(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(c1(sd(e)))}}function v1(t,e,n,r,s,i){const o=e.eventCache;if(od(r,n)!=null)return e;{let l,c;if(Ee(n))if(re(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const d=di(e),h=d instanceof fe?d:fe.EMPTY_NODE,f=xy(r,h);l=t.filter.updateFullNode(e.eventCache.getNode(),f,i)}else{const d=id(r,di(e));l=t.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const d=xe(n);if(d===".priority"){re(Ts(n)===1,"Can't have a priority with additional path components");const h=o.getNode();c=e.serverCache.getNode();const f=Nw(r,n,h,c);f!=null?l=t.filter.updatePriority(h,f):l=o.getNode()}else{const h=$e(n);let f;if(o.isCompleteForChild(d)){c=e.serverCache.getNode();const m=Nw(r,n,o.getNode(),c);m!=null?f=o.getNode().getImmediateChild(d).updateChild(h,m):f=o.getNode().getImmediateChild(d)}else f=Ey(r,d,e.serverCache);f!=null?l=t.filter.updateChild(o.getNode(),d,f,h,s,i):l=o.getNode()}}return qa(e,l,o.isFullyInitialized()||Ee(n),t.filter.filtersNodes())}}function ad(t,e,n,r,s,i,o,l){const c=e.serverCache;let d;const h=o?t.filter:t.filter.getIndexedFilter();if(Ee(n))d=h.updateFullNode(c.getNode(),r,null);else if(h.filtersNodes()&&!c.isFiltered()){const y=c.getNode().updateChild(n,r);d=h.updateFullNode(c.getNode(),y,null)}else{const y=xe(n);if(!c.isCompleteForPath(n)&&Ts(n)>1)return e;const C=$e(n),R=c.getNode().getImmediateChild(y).updateChild(C,r);y===".priority"?d=h.updatePriority(c.getNode(),R):d=h.updateChild(c.getNode(),y,R,C,y1,null)}const f=d1(e,d,c.isFullyInitialized()||Ee(n),h.filtersNodes()),m=new Sy(s,f,i);return v1(t,f,n,s,m,l)}function om(t,e,n,r,s,i,o){const l=e.eventCache;let c,d;const h=new Sy(s,e,i);if(Ee(n))d=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=qa(e,d,!0,t.filter.filtersNodes());else{const f=xe(n);if(f===".priority")d=t.filter.updatePriority(e.eventCache.getNode(),r),c=qa(e,d,l.isFullyInitialized(),l.isFiltered());else{const m=$e(n),y=l.getNode().getImmediateChild(f);let C;if(Ee(m))C=r;else{const w=h.getCompleteChild(f);w!=null?dy(m)===".priority"&&w.getChild(t1(m)).isEmpty()?C=w:C=w.updateChild(m,r):C=fe.EMPTY_NODE}if(y.equals(C))c=e;else{const w=t.filter.updateChild(l.getNode(),f,C,m,h,o);c=qa(e,w,l.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function kw(t,e){return t.eventCache.isCompleteForChild(e)}function NL(t,e,n,r,s,i,o){let l=e;return r.foreach((c,d)=>{const h=tt(n,c);kw(e,xe(h))&&(l=om(t,l,h,d,s,i,o))}),r.foreach((c,d)=>{const h=tt(n,c);kw(e,xe(h))||(l=om(t,l,h,d,s,i,o))}),l}function Rw(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function am(t,e,n,r,s,i,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,d;Ee(n)?d=r:d=new Ue(null).setTree(n,r);const h=e.serverCache.getNode();return d.children.inorderTraversal((f,m)=>{if(h.hasChild(f)){const y=e.serverCache.getNode().getImmediateChild(f),C=Rw(t,y,m);c=ad(t,c,new Me(f),C,s,i,o,l)}}),d.children.inorderTraversal((f,m)=>{const y=!e.serverCache.isCompleteForChild(f)&&m.value===null;if(!h.hasChild(f)&&!y){const C=e.serverCache.getNode().getImmediateChild(f),w=Rw(t,C,m);c=ad(t,c,new Me(f),w,s,i,o,l)}}),c}function kL(t,e,n,r,s,i,o){if(od(s,n)!=null)return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Ee(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return ad(t,e,n,c.getNode().getChild(n),s,i,l,o);if(Ee(n)){let d=new Ue(null);return c.getNode().forEachChild(Xs,(h,f)=>{d=d.set(new Me(h),f)}),am(t,e,n,d,s,i,l,o)}else return e}else{let d=new Ue(null);return r.foreach((h,f)=>{const m=tt(n,h);c.isCompleteForPath(m)&&(d=d.set(h,c.getNode().getChild(m)))}),am(t,e,n,d,s,i,l,o)}}function RL(t,e,n,r,s){const i=e.serverCache,o=d1(e,i.getNode(),i.isFullyInitialized()||Ee(n),i.isFiltered());return v1(t,o,n,r,y1,s)}function AL(t,e,n,r,s,i){let o;if(od(r,n)!=null)return e;{const l=new Sy(r,e,s),c=e.eventCache.getNode();let d;if(Ee(n)||xe(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=id(r,di(e));else{const f=e.serverCache.getNode();re(f instanceof fe,"serverChildren would be complete if leaf node"),h=xy(r,f)}h=h,d=t.filter.updateFullNode(c,h,i)}else{const h=xe(n);let f=Ey(r,h,e.serverCache);f==null&&e.serverCache.isCompleteForChild(h)&&(f=c.getImmediateChild(h)),f!=null?d=t.filter.updateChild(c,h,f,$e(n),l,i):e.eventCache.getNode().hasChild(h)?d=t.filter.updateChild(c,h,fe.EMPTY_NODE,$e(n),l,i):d=c,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=id(r,di(e)),o.isLeafNode()&&(d=t.filter.updateFullNode(d,o,i)))}return o=e.serverCache.isFullyInitialized()||od(r,Ae())!=null,qa(e,d,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new gy(r.getIndex()),i=K4(r);this.processor_=CL(i);const o=n.serverCache,l=n.eventCache,c=s.updateFullNode(fe.EMPTY_NODE,o.getNode(),null),d=i.updateFullNode(fe.EMPTY_NODE,l.getNode(),null),h=new bs(c,o.isFullyInitialized(),s.filtersNodes()),f=new bs(d,l.isFullyInitialized(),i.filtersNodes());this.viewCache_=th(f,h),this.eventGenerator_=new rL(this.query_)}get query(){return this.query_}}function jL(t){return t.viewCache_.serverCache.getNode()}function DL(t){return sd(t.viewCache_)}function LL(t,e){const n=di(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Ee(e)&&!n.getImmediateChild(xe(e)).isEmpty())?n.getChild(e):null}function Aw(t){return t.eventRegistrations_.length===0}function OL(t,e){t.eventRegistrations_.push(e)}function Pw(t,e,n){const r=[];if(n){re(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function jw(t,e,n,r){e.type===On.MERGE&&e.source.queryId!==null&&(re(di(t.viewCache_),"We should always have a full cache before handling merges"),re(sd(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=TL(t.processor_,s,e,n,r);return IL(t.processor_,i.viewCache),re(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,_1(t,i.changes,i.viewCache.eventCache.getNode(),null)}function ML(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Qe,(i,o)=>{r.push(So(i,o))}),n.isFullyInitialized()&&r.push(c1(n.getNode())),_1(t,r,n.getNode(),e)}function _1(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return sL(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ld;class w1{constructor(){this.views=new Map}}function FL(t){re(!ld,"__referenceConstructor has already been defined"),ld=t}function VL(){return re(ld,"Reference.ts has not been loaded"),ld}function UL(t){return t.views.size===0}function Cy(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return re(i!=null,"SyncTree gave us an op for an invalid query."),jw(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(jw(o,e,n,r));return i}}function x1(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let l=id(n,s?r:null),c=!1;l?c=!0:r instanceof fe?(l=xy(n,r),c=!1):(l=fe.EMPTY_NODE,c=!1);const d=th(new bs(l,c,!1),new bs(r,s,!1));return new PL(e,d)}return o}function $L(t,e,n,r,s,i){const o=x1(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),OL(o,n),ML(o,n)}function BL(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const l=Ns(t);if(s==="default")for(const[c,d]of t.views.entries())o=o.concat(Pw(d,n,r)),Aw(d)&&(t.views.delete(c),d.query._queryParams.loadsAllData()||i.push(d.query));else{const c=t.views.get(s);c&&(o=o.concat(Pw(c,n,r)),Aw(c)&&(t.views.delete(s),c.query._queryParams.loadsAllData()||i.push(c.query)))}return l&&!Ns(t)&&i.push(new(VL())(e._repo,e._path)),{removed:i,events:o}}function E1(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ys(t,e){let n=null;for(const r of t.views.values())n=n||LL(r,e);return n}function S1(t,e){if(e._queryParams.loadsAllData())return rh(t);{const r=e._queryIdentifier;return t.views.get(r)}}function C1(t,e){return S1(t,e)!=null}function Ns(t){return rh(t)!=null}function rh(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cd;function zL(t){re(!cd,"__referenceConstructor has already been defined"),cd=t}function qL(){return re(cd,"Reference.ts has not been loaded"),cd}let WL=1;class Dw{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ue(null),this.pendingWriteTree_=wL(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function I1(t,e,n,r,s){return lL(t.pendingWriteTree_,e,n,r,s),s?$o(t,new ui(vy(),e,n)):[]}function HL(t,e,n,r){cL(t.pendingWriteTree_,e,n,r);const s=Ue.fromObject(n);return $o(t,new Co(vy(),e,s))}function ns(t,e,n=!1){const r=uL(t.pendingWriteTree_,e);if(dL(t.pendingWriteTree_,e)){let i=new Ue(null);return r.snap!=null?i=i.set(Ae(),!0):jt(r.children,o=>{i=i.set(new Me(o),!0)}),$o(t,new rd(r.path,i,n))}else return[]}function Kl(t,e,n){return $o(t,new ui(_y(),e,n))}function GL(t,e,n){const r=Ue.fromObject(n);return $o(t,new Co(_y(),e,r))}function KL(t,e){return $o(t,new Tl(_y(),e))}function QL(t,e,n){const r=Ty(t,n);if(r){const s=by(r),i=s.path,o=s.queryId,l=Qt(i,e),c=new Tl(wy(o),l);return Ny(t,i,c)}else return[]}function ud(t,e,n,r,s=!1){const i=e._path,o=t.syncPointTree_.get(i);let l=[];if(o&&(e._queryIdentifier==="default"||C1(o,e))){const c=BL(o,e,n,r);UL(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const d=c.removed;if(l=c.events,!s){const h=d.findIndex(m=>m._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(i,(m,y)=>Ns(y));if(h&&!f){const m=t.syncPointTree_.subtree(i);if(!m.isEmpty()){const y=XL(m);for(let C=0;C<y.length;++C){const w=y[C],R=w.query,T=k1(t,w);t.listenProvider_.startListening(Ha(R),bl(t,R),T.hashFn,T.onComplete)}}}!f&&d.length>0&&!r&&(h?t.listenProvider_.stopListening(Ha(e),null):d.forEach(m=>{const y=t.queryToTagMap.get(sh(m));t.listenProvider_.stopListening(Ha(m),y)}))}ZL(t,d)}return l}function T1(t,e,n,r){const s=Ty(t,r);if(s!=null){const i=by(s),o=i.path,l=i.queryId,c=Qt(o,e),d=new ui(wy(l),c,n);return Ny(t,o,d)}else return[]}function YL(t,e,n,r){const s=Ty(t,r);if(s){const i=by(s),o=i.path,l=i.queryId,c=Qt(o,e),d=Ue.fromObject(n),h=new Co(wy(l),c,d);return Ny(t,o,h)}else return[]}function lm(t,e,n,r=!1){const s=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(s,(m,y)=>{const C=Qt(m,s);i=i||ys(y,C),o=o||Ns(y)});let l=t.syncPointTree_.get(s);l?(o=o||Ns(l),i=i||ys(l,Ae())):(l=new w1,t.syncPointTree_=t.syncPointTree_.set(s,l));let c;i!=null?c=!0:(c=!1,i=fe.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((y,C)=>{const w=ys(C,Ae());w&&(i=i.updateImmediateChild(y,w))}));const d=C1(l,e);if(!d&&!e._queryParams.loadsAllData()){const m=sh(e);re(!t.queryToTagMap.has(m),"View does not exist, but we have a tag");const y=eO();t.queryToTagMap.set(m,y),t.tagToQueryMap.set(y,m)}const h=nh(t.pendingWriteTree_,s);let f=$L(l,e,n,h,i,c);if(!d&&!o&&!r){const m=S1(l,e);f=f.concat(tO(t,e,m))}return f}function Iy(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,l)=>{const c=Qt(o,e),d=ys(l,c);if(d)return d});return p1(s,e,i,n,!0)}function JL(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(d,h)=>{const f=Qt(d,n);r=r||ys(h,f)});let s=t.syncPointTree_.get(n);s?r=r||ys(s,Ae()):(s=new w1,t.syncPointTree_=t.syncPointTree_.set(n,s));const i=r!=null,o=i?new bs(r,!0,!1):null,l=nh(t.pendingWriteTree_,e._path),c=x1(s,e,l,i?o.getNode():fe.EMPTY_NODE,i);return DL(c)}function $o(t,e){return b1(e,t.syncPointTree_,null,nh(t.pendingWriteTree_,Ae()))}function b1(t,e,n,r){if(Ee(t.path))return N1(t,e,n,r);{const s=e.get(Ae());n==null&&s!=null&&(n=ys(s,Ae()));let i=[];const o=xe(t.path),l=t.operationForChild(o),c=e.children.get(o);if(c&&l){const d=n?n.getImmediateChild(o):null,h=m1(r,o);i=i.concat(b1(l,c,d,h))}return s&&(i=i.concat(Cy(s,t,r,n))),i}}function N1(t,e,n,r){const s=e.get(Ae());n==null&&s!=null&&(n=ys(s,Ae()));let i=[];return e.children.inorderTraversal((o,l)=>{const c=n?n.getImmediateChild(o):null,d=m1(r,o),h=t.operationForChild(o);h&&(i=i.concat(N1(h,l,c,d)))}),s&&(i=i.concat(Cy(s,t,r,n))),i}function k1(t,e){const n=e.query,r=bl(t,n);return{hashFn:()=>(jL(e)||fe.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?QL(t,n._path,r):KL(t,n._path);{const i=KD(s,n);return ud(t,n,null,i)}}}}function bl(t,e){const n=sh(e);return t.queryToTagMap.get(n)}function sh(t){return t._path.toString()+"$"+t._queryIdentifier}function Ty(t,e){return t.tagToQueryMap.get(e)}function by(t){const e=t.indexOf("$");return re(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Me(t.substr(0,e))}}function Ny(t,e,n){const r=t.syncPointTree_.get(e);re(r,"Missing sync point for query tag that we're tracking");const s=nh(t.pendingWriteTree_,e);return Cy(r,n,s,null)}function XL(t){return t.fold((e,n,r)=>{if(n&&Ns(n))return[rh(n)];{let s=[];return n&&(s=E1(n)),jt(r,(i,o)=>{s=s.concat(o)}),s}})}function Ha(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(qL())(t._repo,t._path):t}function ZL(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=sh(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function eO(){return WL++}function tO(t,e,n){const r=e._path,s=bl(t,e),i=k1(t,n),o=t.listenProvider_.startListening(Ha(e),s,i.hashFn,i.onComplete),l=t.syncPointTree_.subtree(r);if(s)re(!Ns(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((d,h,f)=>{if(!Ee(d)&&h&&Ns(h))return[rh(h).query];{let m=[];return h&&(m=m.concat(E1(h).map(y=>y.query))),jt(f,(y,C)=>{m=m.concat(C)}),m}});for(let d=0;d<c.length;++d){const h=c[d];t.listenProvider_.stopListening(Ha(h),bl(t,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new ky(n)}node(){return this.node_}}class Ry{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=tt(this.path_,e);return new Ry(this.syncTree_,n)}node(){return Iy(this.syncTree_,this.path_)}}const nO=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Lw=function(t,e,n){if(!t||typeof t!="object")return t;if(re(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return rO(t[".sv"],e,n);if(typeof t[".sv"]=="object")return sO(t[".sv"],e);re(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},rO=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:re(!1,"Unexpected server value: "+t)}},sO=function(t,e,n){t.hasOwnProperty("increment")||re(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&re(!1,"Unexpected increment value: "+r);const s=e.node();if(re(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},R1=function(t,e,n,r){return Ay(e,new Ry(n,t),r)},A1=function(t,e,n){return Ay(t,new ky(e),n)};function Ay(t,e,n){const r=t.getPriority().val(),s=Lw(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,l=Lw(o.getValue(),e,n);return l!==o.getValue()||s!==o.getPriority().val()?new _t(l,ft(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new _t(s))),o.forEachChild(Qe,(l,c)=>{const d=Ay(c,e.getImmediateChild(l),n);d!==c&&(i=i.updateImmediateChild(l,d))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function jy(t,e){let n=e instanceof Me?e:new Me(e),r=t,s=xe(n);for(;s!==null;){const i=mo(r.node.children,s)||{children:{},childCount:0};r=new Py(s,r,i),n=$e(n),s=xe(n)}return r}function Bo(t){return t.node.value}function P1(t,e){t.node.value=e,cm(t)}function j1(t){return t.node.childCount>0}function iO(t){return Bo(t)===void 0&&!j1(t)}function ih(t,e){jt(t.node.children,(n,r)=>{e(new Py(n,t,r))})}function D1(t,e,n,r){n&&e(t),ih(t,s=>{D1(s,e,!0)})}function oO(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Ql(t){return new Me(t.parent===null?t.name:Ql(t.parent)+"/"+t.name)}function cm(t){t.parent!==null&&aO(t.parent,t.name,t)}function aO(t,e,n){const r=iO(n),s=ir(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,cm(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,cm(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO=/[\[\].#$\/\u0000-\u001F\u007F]/,cO=/[\[\].#$\u0000-\u001F\u007F]/,Sf=10*1024*1024,Dy=function(t){return typeof t=="string"&&t.length!==0&&!lO.test(t)},L1=function(t){return typeof t=="string"&&t.length!==0&&!cO.test(t)},uO=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),L1(t)},um=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!oy(t)||t&&typeof t=="object"&&ir(t,".sv")},dO=function(t,e,n,r){oh(Od(t,"value"),e,n)},oh=function(t,e,n){const r=n instanceof Me?new N4(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Bs(r));if(typeof e=="function")throw new Error(t+"contains a function "+Bs(r)+" with contents = "+e.toString());if(oy(e))throw new Error(t+"contains "+e.toString()+" "+Bs(r));if(typeof e=="string"&&e.length>Sf/3&&Md(e)>Sf)throw new Error(t+"contains a string greater than "+Sf+" utf8 bytes "+Bs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(jt(e,(o,l)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Dy(o)))throw new Error(t+" contains an invalid key ("+o+") "+Bs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);k4(r,o),oh(t,l,r),R4(r)}),s&&i)throw new Error(t+' contains ".value" child '+Bs(r)+" in addition to actual children.")}},hO=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const i=El(r);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Dy(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(b4);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&En(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},fO=function(t,e,n,r){const s=Od(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const i=[];jt(e,(o,l)=>{const c=new Me(o);if(oh(s,l,tt(n,c)),dy(c)===".priority"&&!um(l))throw new Error(s+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),hO(s,i)},Ly=function(t,e,n,r){if(!L1(n))throw new Error(Od(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},pO=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ly(t,e,n)},O1=function(t,e){if(xe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},mO=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Dy(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!uO(n))throw new Error(Od(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ah(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!hy(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function M1(t,e,n){ah(t,n),F1(t,r=>hy(r,e))}function kn(t,e,n){ah(t,n),F1(t,r=>En(r,e)||En(e,r))}function F1(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(yO(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function yO(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Ba&&bt("event: "+n.toString()),Uo(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO="repo_interrupt",_O=25;class wO{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new gO,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=nd(),this.transactionQueueTree_=new Py,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function xO(t,e,n){if(t.stats_=cy(t.repoInfo_),t.forceRestClient_||XD())t.server_=new td(t.repoInfo_,(r,s,i,o)=>{Ow(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Mw(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{pt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Sr(t.repoInfo_,e,(r,s,i,o)=>{Ow(t,r,s,i,o)},r=>{Mw(t,r)},r=>{SO(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=r4(t.repoInfo_,()=>new nL(t.stats_,t.server_)),t.infoData_=new J4,t.infoSyncTree_=new Dw({startListening:(r,s,i,o)=>{let l=[];const c=t.infoData_.getNode(r._path);return c.isEmpty()||(l=Kl(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),Oy(t,"connected",!1),t.serverSyncTree_=new Dw({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(l,c)=>{const d=o(l,c);kn(t.eventQueue_,r._path,d)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function EO(t){const n=t.infoData_.getNode(new Me(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function lh(t){return nO({timestamp:EO(t)})}function Ow(t,e,n,r,s){t.dataUpdateCount++;const i=new Me(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const c=Uu(n,d=>ft(d));o=YL(t.serverSyncTree_,i,c,s)}else{const c=ft(n);o=T1(t.serverSyncTree_,i,c,s)}else if(r){const c=Uu(n,d=>ft(d));o=GL(t.serverSyncTree_,i,c)}else{const c=ft(n);o=Kl(t.serverSyncTree_,i,c)}let l=i;o.length>0&&(l=To(t,i)),kn(t.eventQueue_,l,o)}function Mw(t,e){Oy(t,"connected",e),e===!1&&bO(t)}function SO(t,e){jt(e,(n,r)=>{Oy(t,n,r)})}function Oy(t,e,n){const r=new Me("/.info/"+e),s=ft(n);t.infoData_.updateSnapshot(r,s);const i=Kl(t.infoSyncTree_,r,s);kn(t.eventQueue_,r,i)}function My(t){return t.nextWriteId_++}function CO(t,e,n){const r=JL(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const i=ft(s).withIndex(e._queryParams.getIndex());lm(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Kl(t.serverSyncTree_,e._path,i);else{const l=bl(t.serverSyncTree_,e);o=T1(t.serverSyncTree_,e._path,i,l)}return kn(t.eventQueue_,e._path,o),ud(t.serverSyncTree_,e,n,null,!0),i},s=>(Yl(t,"get for query "+pt(e)+" failed: "+s),Promise.reject(new Error(s))))}function IO(t,e,n,r,s){Yl(t,"set",{path:e.toString(),value:n,priority:r});const i=lh(t),o=ft(n,r),l=Iy(t.serverSyncTree_,e),c=A1(o,l,i),d=My(t),h=I1(t.serverSyncTree_,e,c,d,!0);ah(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(m,y)=>{const C=m==="ok";C||Xt("set at "+e+" failed: "+m);const w=ns(t.serverSyncTree_,d,!C);kn(t.eventQueue_,e,w),dm(t,s,m,y)});const f=Vy(t,e);To(t,f),kn(t.eventQueue_,f,[])}function TO(t,e,n,r){Yl(t,"update",{path:e.toString(),value:n});let s=!0;const i=lh(t),o={};if(jt(n,(l,c)=>{s=!1,o[l]=R1(tt(e,l),ft(c),t.serverSyncTree_,i)}),s)bt("update() called with empty data.  Don't do anything."),dm(t,r,"ok",void 0);else{const l=My(t),c=HL(t.serverSyncTree_,e,o,l);ah(t.eventQueue_,c),t.server_.merge(e.toString(),n,(d,h)=>{const f=d==="ok";f||Xt("update at "+e+" failed: "+d);const m=ns(t.serverSyncTree_,l,!f),y=m.length>0?To(t,e):e;kn(t.eventQueue_,y,m),dm(t,r,d,h)}),jt(n,d=>{const h=Vy(t,tt(e,d));To(t,h)}),kn(t.eventQueue_,e,[])}}function bO(t){Yl(t,"onDisconnectEvents");const e=lh(t),n=nd();nm(t.onDisconnect_,Ae(),(s,i)=>{const o=R1(s,i,t.serverSyncTree_,e);u1(n,s,o)});let r=[];nm(n,Ae(),(s,i)=>{r=r.concat(Kl(t.serverSyncTree_,s,i));const o=Vy(t,s);To(t,o)}),t.onDisconnect_=nd(),kn(t.eventQueue_,Ae(),r)}function NO(t,e,n){let r;xe(e._path)===".info"?r=lm(t.infoSyncTree_,e,n):r=lm(t.serverSyncTree_,e,n),M1(t.eventQueue_,e._path,r)}function Fw(t,e,n){let r;xe(e._path)===".info"?r=ud(t.infoSyncTree_,e,n):r=ud(t.serverSyncTree_,e,n),M1(t.eventQueue_,e._path,r)}function kO(t){t.persistentConnection_&&t.persistentConnection_.interrupt(vO)}function Yl(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),bt(n,...e)}function dm(t,e,n,r){e&&Uo(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function V1(t,e,n){return Iy(t.serverSyncTree_,e,n)||fe.EMPTY_NODE}function Fy(t,e=t.transactionQueueTree_){if(e||ch(t,e),Bo(e)){const n=$1(t,e);re(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&RO(t,Ql(e),n)}else j1(e)&&ih(e,n=>{Fy(t,n)})}function RO(t,e,n){const r=n.map(d=>d.currentWriteId),s=V1(t,e,r);let i=s;const o=s.hash();for(let d=0;d<n.length;d++){const h=n[d];re(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const f=Qt(e,h.path);i=i.updateChild(f,h.currentOutputSnapshotRaw)}const l=i.val(!0),c=e;t.server_.put(c.toString(),l,d=>{Yl(t,"transaction put response",{path:c.toString(),status:d});let h=[];if(d==="ok"){const f=[];for(let m=0;m<n.length;m++)n[m].status=2,h=h.concat(ns(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&f.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();ch(t,jy(t.transactionQueueTree_,e)),Fy(t,t.transactionQueueTree_),kn(t.eventQueue_,e,h);for(let m=0;m<f.length;m++)Uo(f[m])}else{if(d==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{Xt("transaction at "+c.toString()+" failed: "+d);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=d}To(t,e)}},o)}function To(t,e){const n=U1(t,e),r=Ql(n),s=$1(t,n);return AO(t,s,r),r}function AO(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],d=Qt(n,c.path);let h=!1,f;if(re(d!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)h=!0,f=c.abortReason,s=s.concat(ns(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=_O)h=!0,f="maxretry",s=s.concat(ns(t.serverSyncTree_,c.currentWriteId,!0));else{const m=V1(t,c.path,o);c.currentInputSnapshot=m;const y=e[l].update(m.val());if(y!==void 0){oh("transaction failed: Data returned ",y,c.path);let C=ft(y);typeof y=="object"&&y!=null&&ir(y,".priority")||(C=C.updatePriority(m.getPriority()));const R=c.currentWriteId,T=lh(t),x=A1(C,m,T);c.currentOutputSnapshotRaw=C,c.currentOutputSnapshotResolved=x,c.currentWriteId=My(t),o.splice(o.indexOf(R),1),s=s.concat(I1(t.serverSyncTree_,c.path,x,c.currentWriteId,c.applyLocally)),s=s.concat(ns(t.serverSyncTree_,R,!0))}else h=!0,f="nodata",s=s.concat(ns(t.serverSyncTree_,c.currentWriteId,!0))}kn(t.eventQueue_,n,s),s=[],h&&(e[l].status=2,function(m){setTimeout(m,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(f==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(f),!1,null))))}ch(t,t.transactionQueueTree_);for(let l=0;l<r.length;l++)Uo(r[l]);Fy(t,t.transactionQueueTree_)}function U1(t,e){let n,r=t.transactionQueueTree_;for(n=xe(e);n!==null&&Bo(r)===void 0;)r=jy(r,n),e=$e(e),n=xe(e);return r}function $1(t,e){const n=[];return B1(t,e,n),n.sort((r,s)=>r.order-s.order),n}function B1(t,e,n){const r=Bo(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);ih(e,s=>{B1(t,s,n)})}function ch(t,e){const n=Bo(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,P1(e,n.length>0?n:void 0)}ih(e,r=>{ch(t,r)})}function Vy(t,e){const n=Ql(U1(t,e)),r=jy(t.transactionQueueTree_,e);return oO(r,s=>{Cf(t,s)}),Cf(t,r),D1(r,s=>{Cf(t,s)}),n}function Cf(t,e){const n=Bo(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(re(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(re(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(ns(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?P1(e,void 0):n.length=i+1,kn(t.eventQueue_,Ql(e),s);for(let o=0;o<r.length;o++)Uo(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PO(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function jO(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Xt(`Invalid query segment '${n}' in query '${t}'`)}return e}const Vw=function(t,e){const n=DO(t),r=n.namespace;n.domain==="firebase.com"&&Pr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Pr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||zD();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new HI(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Me(n.pathString)}},DO=function(t){let e="",n="",r="",s="",i="",o=!0,l="https",c=443;if(typeof t=="string"){let d=t.indexOf("//");d>=0&&(l=t.substring(0,d-1),t=t.substring(d+2));let h=t.indexOf("/");h===-1&&(h=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(s=PO(t.substring(h,f)));const m=jO(t.substring(Math.min(t.length,f)));d=e.indexOf(":"),d>=0?(o=l==="https"||l==="wss",c=parseInt(e.substring(d+1),10)):d=e.length;const y=e.slice(0,d);if(y.toLowerCase()==="localhost")n="localhost";else if(y.split(".").length<=2)n=y;else{const C=e.indexOf(".");r=e.substring(0,C).toLowerCase(),n=e.substring(C+1),i=r}"ns"in m&&(i=m.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:l,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+pt(this.snapshot.exportVal())}}class OO{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return re(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return Ee(this._path)?null:dy(this._path)}get ref(){return new Mr(this._repo,this._path)}get _queryIdentifier(){const e=Cw(this._queryParams),n=ay(e);return n==="{}"?"default":n}get _queryObject(){return Cw(this._queryParams)}isEqual(e){if(e=Ve(e),!(e instanceof Jl))return!1;const n=this._repo===e._repo,r=hy(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+T4(this._path)}}function MO(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function FO(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Xs){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ci)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==Is)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===Qe){if(e!=null&&!um(e)||n!=null&&!um(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(re(t.getIndex()instanceof my||t.getIndex()===l1,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class Mr extends Jl{constructor(e,n){super(e,n,new yy,!1)}get parent(){const e=t1(this._path);return e===null?null:new Mr(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Nl{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Me(e),r=hm(this.ref,e);return new Nl(this._node.getChild(n),r,Qe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new Nl(s,hm(this.ref,r),Qe)))}hasChild(e){const n=new Me(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function de(t,e){return t=Ve(t),t._checkNotDeleted("ref"),e!==void 0?hm(t._root,e):t._root}function hm(t,e){return t=Ve(t),xe(t._path)===null?pO("child","path",e):Ly("child","path",e),new Mr(t._repo,tt(t._path,e))}function Uw(t){return O1("remove",t._path),dt(t,null)}function dt(t,e){t=Ve(t),O1("set",t._path),dO("set",e,t._path);const n=new Ll;return IO(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Tn(t,e){fO("update",e,t._path);const n=new Ll;return TO(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function je(t){t=Ve(t);const e=new z1(()=>{}),n=new uh(e);return CO(t._repo,t,n).then(r=>new Nl(r,new Mr(t._repo,t._path),t._queryParams.getIndex()))}class uh{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new LO("value",this,new Nl(e.snapshotNode,new Mr(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new OO(this,e,n):null}matches(e){return e instanceof uh?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function VO(t,e,n,r,s){let i;if(typeof r=="object"&&(i=void 0,s=r),typeof r=="function"&&(i=r),s&&s.onlyOnce){const c=n,d=(h,f)=>{Fw(t._repo,t,l),c(h,f)};d.userCallback=n.userCallback,d.context=n.context,n=d}const o=new z1(n,i||void 0),l=new uh(o);return NO(t._repo,t,l),()=>Fw(t._repo,t,l)}function Zs(t,e,n,r){return VO(t,"value",e,n,r)}class q1{}class UO extends q1{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Jl(e._repo,e._path,Q4(e._queryParams,this._limit),e._orderByCalled)}}function $O(t){if(Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new UO(t)}class BO extends q1{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){MO(e,"orderByChild");const n=new Me(this._path);if(Ee(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new my(n),s=Y4(e._queryParams,r);return FO(s),new Jl(e._repo,e._path,s,!0)}}function zO(t){return Ly("orderByChild","path",t),new BO(t)}function qO(t,...e){let n=Ve(t);for(const r of e)n=r._apply(n);return n}FL(Mr);zL(Mr);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO="FIREBASE_DATABASE_EMULATOR_HOST",fm={};let HO=!1;function GO(t,e,n,r){t.repoInfo_=new HI(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function KO(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Pr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),bt("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Vw(i,s),l=o.repoInfo,c;typeof process<"u"&&ow&&(c=ow[WO]),c?(i=`http://${c}?ns=${l.namespace}`,o=Vw(i,s),l=o.repoInfo):o.repoInfo.secure;const d=new e4(t.name,t.options,e);mO("Invalid Firebase Database URL",o),Ee(o.path)||Pr("Database URL must point to the root of a Firebase Database (not including a child path).");const h=YO(l,t,d,new ZD(t.name,n));return new JO(h,t)}function QO(t,e){const n=fm[e];(!n||n[t.key]!==t)&&Pr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),kO(t),delete n[t.key]}function YO(t,e,n,r){let s=fm[e.name];s||(s={},fm[e.name]=s);let i=s[t.toURLString()];return i&&Pr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new wO(t,HO,n,r),s[t.toURLString()]=i,i}class JO{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(xO(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Mr(this._repo,Ae())),this._rootInternal}_delete(){return this._rootInternal!==null&&(QO(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Pr("Cannot call "+e+" on a deleted database.")}}function yr(t=Sg(),e){const n=Vd(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=JS("database");r&&XO(n,...r)}return n}function XO(t,e,n,r={}){t=Ve(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Pr("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let i;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&Pr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new au(au.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:eC(r.mockUserToken,t.app.options.projectId);i=new au(o)}GO(s,e,n,i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZO(t){MD(yi),ii(new xs("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return KO(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),Jn(aw,lw,t),Jn(aw,lw,"esm2017")}function If(t){return{".sv":{increment:t}}}Sr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Sr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};ZO();function Uy(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function W1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const eM=W1,H1=new Ol("auth","Firebase",W1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd=new Fd("@firebase/auth");function tM(t,...e){dd.logLevel<=Ie.WARN&&dd.warn(`Auth (${yi}): ${t}`,...e)}function lu(t,...e){dd.logLevel<=Ie.ERROR&&dd.error(`Auth (${yi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(t,...e){throw $y(t,...e)}function er(t,...e){return $y(t,...e)}function G1(t,e,n){const r=Object.assign(Object.assign({},eM()),{[e]:n});return new Ol("auth","Firebase",r).create(e,{appName:t.name})}function Cr(t){return G1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $y(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return H1.create(t,...e)}function pe(t,e,...n){if(!t)throw $y(e,...n)}function vr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw lu(e),new Error(e)}function jr(t,e){t||vr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function nM(){return $w()==="http:"||$w()==="https:"}function $w(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rM(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nM()||uA()||"connection"in navigator)?navigator.onLine:!0}function sM(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,n){this.shortDelay=e,this.longDelay=n,jr(n>e,"Short delay should be less than long delay!"),this.isMobile=xg()||tC()}get(){return rM()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function By(t,e){jr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM=new Xl(3e4,6e4);function Fr(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function or(t,e,n,r,s={}){return Q1(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Do(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:c},i);return cA()||(d.referrerPolicy="no-referrer"),K1.fetch()(Y1(t,t.config.apiHost,n,l),d)})}async function Q1(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},iM),e);try{const s=new lM(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw zc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw zc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw zc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw zc(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw G1(t,h,d);zn(t,h)}}catch(s){if(s instanceof Or)throw s;zn(t,"network-request-failed",{message:String(s)})}}async function Zl(t,e,n,r,s={}){const i=await or(t,e,n,r,s);return"mfaPendingCredential"in i&&zn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Y1(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?By(t.config,s):`${t.config.apiScheme}://${s}`}function aM(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class lM{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(er(this.auth,"network-request-failed")),oM.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function zc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=er(t,e,r);return s.customData._tokenResponse=n,s}function Bw(t){return t!==void 0&&t.enterprise!==void 0}class cM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return aM(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function uM(t,e){return or(t,"GET","/v2/recaptchaConfig",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dM(t,e){return or(t,"POST","/v1/accounts:delete",e)}async function J1(t,e){return or(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ga(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hM(t,e=!1){const n=Ve(t),r=await n.getIdToken(e),s=zy(r);pe(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Ga(Tf(s.auth_time)),issuedAtTime:Ga(Tf(s.iat)),expirationTime:Ga(Tf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Tf(t){return Number(t)*1e3}function zy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return lu("JWT malformed, contained fewer than 3 sections"),null;try{const s=Vu(n);return s?JSON.parse(s):(lu("Failed to decode base64 JWT payload"),null)}catch(s){return lu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function zw(t){const e=zy(t);return pe(e,"internal-error"),pe(typeof e.exp<"u","internal-error"),pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Or&&fM(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function fM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ga(this.lastLoginAt),this.creationTime=Ga(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hd(t){var e;const n=t.auth,r=await t.getIdToken(),s=await bo(t,J1(n,{idToken:r}));pe(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?X1(i.providerUserInfo):[],l=gM(t.providerData,o),c=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=c?d:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new mm(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function mM(t){const e=Ve(t);await hd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gM(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function X1(t){return t.map(e=>{var{providerId:n}=e,r=Uy(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yM(t,e){const n=await Q1(t,{},async()=>{const r=Do({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=Y1(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",K1.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function vM(t,e){return or(t,"POST","/v2/accounts:revokeToken",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pe(e.idToken,"internal-error"),pe(typeof e.idToken<"u","internal-error"),pe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):zw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){pe(e.length!==0,"internal-error");const n=zw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await yM(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ro;return r&&(pe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(pe(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(pe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ro,this.toJSON())}_performRefresh(){return vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(t,e){pe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class _r{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Uy(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new pM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new mm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await bo(this,this.stsTokenManager.getToken(this.auth,e));return pe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return hM(this,e)}reload(){return mM(this)}_assign(e){this!==e&&(pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new _r(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await hd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Kn(this.auth.app))return Promise.reject(Cr(this.auth));const e=await this.getIdToken();return await bo(this,dM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,d,h;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(s=n.email)!==null&&s!==void 0?s:void 0,y=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,C=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(l=n.tenantId)!==null&&l!==void 0?l:void 0,R=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,T=(d=n.createdAt)!==null&&d!==void 0?d:void 0,x=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:_,emailVerified:O,isAnonymous:j,providerData:L,stsTokenManager:E}=n;pe(_&&E,e,"internal-error");const v=ro.fromJSON(this.name,E);pe(typeof _=="string",e,"internal-error"),zr(f,e.name),zr(m,e.name),pe(typeof O=="boolean",e,"internal-error"),pe(typeof j=="boolean",e,"internal-error"),zr(y,e.name),zr(C,e.name),zr(w,e.name),zr(R,e.name),zr(T,e.name),zr(x,e.name);const I=new _r({uid:_,auth:e,email:m,emailVerified:O,displayName:f,isAnonymous:j,photoURL:C,phoneNumber:y,tenantId:w,stsTokenManager:v,createdAt:T,lastLoginAt:x});return L&&Array.isArray(L)&&(I.providerData=L.map(A=>Object.assign({},A))),R&&(I._redirectEventId=R),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new ro;s.updateFromServerResponse(n);const i=new _r({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await hd(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];pe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?X1(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new ro;l.updateFromIdToken(r);const c=new _r({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new mm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=new Map;function wr(t){jr(t instanceof Function,"Expected a class definition");let e=qw.get(t);return e?(jr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,qw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Z1.type="NONE";const Ww=Z1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(t,e,n){return`firebase:${t}:${e}:${n}`}class so{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=cu(this.userKey,s.apiKey,i),this.fullPersistenceKey=cu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?_r._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new so(wr(Ww),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||wr(Ww);const o=cu(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(o);if(h){const f=_r._fromJSON(e,h);d!==i&&(l=f),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new so(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new so(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(eT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(iT(e))return"Blackberry";if(oT(e))return"Webos";if(tT(e))return"Safari";if((e.includes("chrome/")||nT(e))&&!e.includes("edge/"))return"Chrome";if(sT(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function eT(t=qt()){return/firefox\//i.test(t)}function tT(t=qt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nT(t=qt()){return/crios\//i.test(t)}function rT(t=qt()){return/iemobile/i.test(t)}function sT(t=qt()){return/android/i.test(t)}function iT(t=qt()){return/blackberry/i.test(t)}function oT(t=qt()){return/webos/i.test(t)}function qy(t=qt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function _M(t=qt()){var e;return qy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function wM(){return dA()&&document.documentMode===10}function aT(t=qt()){return qy(t)||sT(t)||oT(t)||iT(t)||/windows phone/i.test(t)||rT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lT(t,e=[]){let n;switch(t){case"Browser":n=Hw(qt());break;case"Worker":n=`${Hw(qt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${yi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EM(t,e={}){return or(t,"GET","/v2/passwordPolicy",Fr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM=6;class CM{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:SM,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gw(this),this.idTokenSubscription=new Gw(this),this.beforeStateQueue=new xM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=H1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=wr(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await so.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await J1(this,{idToken:e}),r=await _r._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Kn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await hd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Kn(this.app))return Promise.reject(Cr(this));const n=e?Ve(e):null;return n&&pe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Kn(this.app)?Promise.reject(Cr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Kn(this.app)?Promise.reject(Cr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await EM(this),n=new CM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ol("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await vM(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&wr(e)||this._popupRedirectResolver;pe(n,this,"argument-error"),this.redirectPersistenceManager=await so.create(this,[wr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(pe(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&tM(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Ei(t){return Ve(t)}class Gw{constructor(e){this.auth=e,this.observer=null,this.addObserver=EA(n=>this.observer=n)}get next(){return pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function TM(t){dh=t}function cT(t){return dh.loadJS(t)}function bM(){return dh.recaptchaEnterpriseScript}function NM(){return dh.gapiScript}function kM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const RM="recaptcha-enterprise",AM="NO_RECAPTCHA";class PM{constructor(e){this.type=RM,this.auth=Ei(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{uM(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new cM(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;Bw(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(AM)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&Bw(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=bM();c.length!==0&&(c+=l),cT(c).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function Kw(t,e,n,r=!1){const s=new PM(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function gm(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Kw(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Kw(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jM(t,e){const n=Vd(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if($u(i,e??{}))return s;zn(s,"already-initialized")}return n.initialize({options:e})}function DM(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(wr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function LM(t,e,n){const r=Ei(t);pe(r._canInitEmulator,r,"emulator-config-failed"),pe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=uT(e),{host:o,port:l}=OM(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),MM()}function uT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function OM(t){const e=uT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Qw(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Qw(o)}}}function Qw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function MM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return vr("not implemented")}_getIdTokenResponse(e){return vr("not implemented")}_linkToIdToken(e,n){return vr("not implemented")}_getReauthenticationResolver(e){return vr("not implemented")}}async function FM(t,e){return or(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VM(t,e){return Zl(t,"POST","/v1/accounts:signInWithPassword",Fr(t,e))}async function UM(t,e){return or(t,"POST","/v1/accounts:sendOobCode",Fr(t,e))}async function $M(t,e){return UM(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BM(t,e){return Zl(t,"POST","/v1/accounts:signInWithEmailLink",Fr(t,e))}async function zM(t,e){return Zl(t,"POST","/v1/accounts:signInWithEmailLink",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl extends Wy{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new kl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new kl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gm(e,n,"signInWithPassword",VM);case"emailLink":return BM(e,{email:this._email,oobCode:this._password});default:zn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gm(e,r,"signUpPassword",FM);case"emailLink":return zM(e,{idToken:n,email:this._email,oobCode:this._password});default:zn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(t,e){return Zl(t,"POST","/v1/accounts:signInWithIdp",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qM="http://localhost";class hi extends Wy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new hi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):zn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Uy(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new hi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return io(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,io(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,io(e,n)}buildRequest(){const e={requestUri:qM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Do(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function HM(t){const e=Sa(Ca(t)).link,n=e?Sa(Ca(e)).deep_link_id:null,r=Sa(Ca(t)).deep_link_id;return(r?Sa(Ca(r)).link:null)||r||n||e||t}class Hy{constructor(e){var n,r,s,i,o,l;const c=Sa(Ca(e)),d=(n=c.apiKey)!==null&&n!==void 0?n:null,h=(r=c.oobCode)!==null&&r!==void 0?r:null,f=WM((s=c.mode)!==null&&s!==void 0?s:null);pe(d&&h&&f,"argument-error"),this.apiKey=d,this.operation=f,this.code=h,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=HM(e);try{return new Hy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(){this.providerId=zo.PROVIDER_ID}static credential(e,n){return kl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Hy.parseLink(n);return pe(r,"argument-error"),kl._fromEmailAndCode(e,r.code,r.tenantId)}}zo.PROVIDER_ID="password";zo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";zo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec extends dT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr extends ec{constructor(){super("facebook.com")}static credential(e){return hi._fromParams({providerId:Kr.PROVIDER_ID,signInMethod:Kr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kr.credentialFromTaggedObject(e)}static credentialFromError(e){return Kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Kr.credential(e.oauthAccessToken)}catch{return null}}}Kr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Kr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr extends ec{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return hi._fromParams({providerId:Qr.PROVIDER_ID,signInMethod:Qr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Qr.credentialFromTaggedObject(e)}static credentialFromError(e){return Qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Qr.credential(n,r)}catch{return null}}}Qr.GOOGLE_SIGN_IN_METHOD="google.com";Qr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr extends ec{constructor(){super("github.com")}static credential(e){return hi._fromParams({providerId:Yr.PROVIDER_ID,signInMethod:Yr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yr.credentialFromTaggedObject(e)}static credentialFromError(e){return Yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yr.credential(e.oauthAccessToken)}catch{return null}}}Yr.GITHUB_SIGN_IN_METHOD="github.com";Yr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends ec{constructor(){super("twitter.com")}static credential(e,n){return hi._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Jr.credential(n,r)}catch{return null}}}Jr.TWITTER_SIGN_IN_METHOD="twitter.com";Jr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GM(t,e){return Zl(t,"POST","/v1/accounts:signUp",Fr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await _r._fromIdTokenResponse(e,r,s),o=Yw(r);return new fi({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Yw(r);return new fi({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Yw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd extends Or{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,fd.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new fd(e,n,r,s)}}function hT(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?fd._fromErrorAndOperation(t,i,e,r):i})}async function KM(t,e,n=!1){const r=await bo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return fi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QM(t,e,n=!1){const{auth:r}=t;if(Kn(r.app))return Promise.reject(Cr(r));const s="reauthenticate";try{const i=await bo(t,hT(r,s,e,t),n);pe(i.idToken,r,"internal-error");const o=zy(i.idToken);pe(o,r,"internal-error");const{sub:l}=o;return pe(t.uid===l,r,"user-mismatch"),fi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&zn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fT(t,e,n=!1){if(Kn(t.app))return Promise.reject(Cr(t));const r="signIn",s=await hT(t,r,e),i=await fi._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function YM(t,e){return fT(Ei(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pT(t){const e=Ei(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function JM(t,e,n){if(Kn(t.app))return Promise.reject(Cr(t));const r=Ei(t),o=await gm(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",GM).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&pT(t),c}),l=await fi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function XM(t,e,n){return Kn(t.app)?Promise.reject(Cr(t)):YM(Ve(t),zo.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&pT(t),r})}async function ZM(t,e){const n=Ve(t),s={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:i}=await $M(n.auth,s);i!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e3(t,e){return or(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mT(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Ve(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await bo(r,e3(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:c})=>c==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function t3(t,e,n,r){return Ve(t).onIdTokenChanged(e,n,r)}function n3(t,e,n){return Ve(t).beforeAuthStateChanged(e,n)}function Gy(t,e,n,r){return Ve(t).onAuthStateChanged(e,n,r)}function r3(t){return Ve(t).signOut()}const pd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(pd,"1"),this.storage.removeItem(pd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s3=1e3,i3=10;class yT extends gT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=aT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);wM()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,i3):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},s3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}yT.type="LOCAL";const o3=yT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT extends gT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}vT.type="SESSION";const _T=vT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a3(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new hh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),c=await a3(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}hh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ky(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const d=Ky("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const m=f;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(){return window}function c3(t){tr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(){return typeof tr().WorkerGlobalScope<"u"&&typeof tr().importScripts=="function"}async function u3(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function d3(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function h3(){return wT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT="firebaseLocalStorageDb",f3=1,md="firebaseLocalStorage",ET="fbase_key";class tc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function fh(t,e){return t.transaction([md],e?"readwrite":"readonly").objectStore(md)}function p3(){const t=indexedDB.deleteDatabase(xT);return new tc(t).toPromise()}function ym(){const t=indexedDB.open(xT,f3);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(md,{keyPath:ET})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(md)?e(r):(r.close(),await p3(),e(await ym()))})})}async function Jw(t,e,n){const r=fh(t,!0).put({[ET]:e,value:n});return new tc(r).toPromise()}async function m3(t,e){const n=fh(t,!1).get(e),r=await new tc(n).toPromise();return r===void 0?null:r.value}function Xw(t,e){const n=fh(t,!0).delete(e);return new tc(n).toPromise()}const g3=800,y3=3;class ST{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ym(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>y3)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=hh._getInstance(h3()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await u3(),!this.activeServiceWorker)return;this.sender=new l3(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||d3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ym();return await Jw(e,pd,"1"),await Xw(e,pd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Jw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>m3(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Xw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=fh(s,!1).getAll();return new tc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),g3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ST.type="LOCAL";const v3=ST;new Xl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _3(t,e){return e?wr(e):(pe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy extends Wy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return io(e,this._buildIdpRequest())}_linkToIdToken(e,n){return io(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return io(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function w3(t){return fT(t.auth,new Qy(t),t.bypassAuthState)}function x3(t){const{auth:e,user:n}=t;return pe(n,e,"internal-error"),QM(n,new Qy(t),t.bypassAuthState)}async function E3(t){const{auth:e,user:n}=t;return pe(n,e,"internal-error"),KM(n,new Qy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return w3;case"linkViaPopup":case"linkViaRedirect":return E3;case"reauthViaPopup":case"reauthViaRedirect":return x3;default:zn(this.auth,"internal-error")}}resolve(e){jr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){jr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=new Xl(2e3,1e4);class Gi extends CT{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Gi.currentPopupAction&&Gi.currentPopupAction.cancel(),Gi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pe(e,this.auth,"internal-error"),e}async onExecution(){jr(this.filter.length===1,"Popup operations only handle one event");const e=Ky();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,S3.get())};e()}}Gi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C3="pendingRedirect",uu=new Map;class I3 extends CT{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=uu.get(this.auth._key());if(!e){try{const r=await T3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}uu.set(this.auth._key(),e)}return this.bypassAuthState||uu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function T3(t,e){const n=k3(e),r=N3(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function b3(t,e){uu.set(t._key(),e)}function N3(t){return wr(t._redirectPersistence)}function k3(t){return cu(C3,t.config.apiKey,t.name)}async function R3(t,e,n=!1){if(Kn(t.app))return Promise.reject(Cr(t));const r=Ei(t),s=_3(r,e),o=await new I3(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3=10*60*1e3;class P3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!j3(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!IT(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(er(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=A3&&this.cachedEventUids.clear(),this.cachedEventUids.has(Zw(e))}saveEventToCache(e){this.cachedEventUids.add(Zw(e)),this.lastProcessedEventTime=Date.now()}}function Zw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function IT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function j3(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return IT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D3(t,e={}){return or(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,O3=/^https?/;async function M3(t){if(t.config.emulator)return;const{authorizedDomains:e}=await D3(t);for(const n of e)try{if(F3(n))return}catch{}zn(t,"unauthorized-domain")}function F3(t){const e=pm(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!O3.test(n))return!1;if(L3.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V3=new Xl(3e4,6e4);function ex(){const t=tr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function U3(t){return new Promise((e,n)=>{var r,s,i;function o(){ex(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ex(),n(er(t,"network-request-failed"))},timeout:V3.get()})}if(!((s=(r=tr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=tr().gapi)===null||i===void 0)&&i.load)o();else{const l=kM("iframefcb");return tr()[l]=()=>{gapi.load?o():n(er(t,"network-request-failed"))},cT(`${NM()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw du=null,e})}let du=null;function $3(t){return du=du||U3(t),du}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3=new Xl(5e3,15e3),z3="__/auth/iframe",q3="emulator/auth/iframe",W3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},H3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function G3(t){const e=t.config;pe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?By(e,q3):`https://${t.config.authDomain}/${z3}`,r={apiKey:e.apiKey,appName:t.name,v:yi},s=H3.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Do(r).slice(1)}`}async function K3(t){const e=await $3(t),n=tr().gapi;return pe(n,t,"internal-error"),e.open({where:document.body,url:G3(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:W3,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=er(t,"network-request-failed"),l=tr().setTimeout(()=>{i(o)},B3.get());function c(){tr().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Y3=500,J3=600,X3="_blank",Z3="http://localhost";class tx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function eF(t,e,n,r=Y3,s=J3){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Q3),{width:r.toString(),height:s.toString(),top:i,left:o}),d=qt().toLowerCase();n&&(l=nT(d)?X3:n),eT(d)&&(e=e||Z3,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[y,C])=>`${m}${y}=${C},`,"");if(_M(d)&&l!=="_self")return tF(e||"",l),new tx(null);const f=window.open(e||"",l,h);pe(f,t,"popup-blocked");try{f.focus()}catch{}return new tx(f)}function tF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nF="__/auth/handler",rF="emulator/auth/handler",sF=encodeURIComponent("fac");async function nx(t,e,n,r,s,i){pe(t.config.authDomain,t,"auth-domain-config-required"),pe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:yi,eventId:s};if(e instanceof dT){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Rp(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof ec){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),d=c?`#${sF}=${encodeURIComponent(c)}`:"";return`${iF(t)}?${Do(l).slice(1)}${d}`}function iF({config:t}){return t.emulator?By(t,rF):`https://${t.authDomain}/${nF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bf="webStorageSupport";class oF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_T,this._completeRedirectFn=R3,this._overrideRedirectResult=b3}async _openPopup(e,n,r,s){var i;jr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await nx(e,n,r,pm(),s);return eF(e,o,Ky())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await nx(e,n,r,pm(),s);return c3(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(jr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await K3(e),r=new P3(e);return n.register("authEvent",s=>(pe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(bf,{type:bf},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[bf];o!==void 0&&n(!!o),zn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=M3(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return aT()||tT()||qy()}}const aF=oF;var rx="@firebase/auth",sx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function uF(t){ii(new xs("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;pe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lT(t)},d=new IM(r,s,i,c);return DM(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ii(new xs("auth-internal",e=>{const n=Ei(e.getProvider("auth").getImmediate());return(r=>new lF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Jn(rx,sx,cF(t)),Jn(rx,sx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dF=5*60,hF=ZS("authIdTokenMaxAge")||dF;let ix=null;const fF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>hF)return;const s=n==null?void 0:n.token;ix!==s&&(ix=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Wt(t=Sg()){const e=Vd(t,"auth");if(e.isInitialized())return e.getImmediate();const n=jM(t,{popupRedirectResolver:aF,persistence:[v3,o3,_T]}),r=ZS("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=fF(i.toString());n3(n,o,()=>o(n.currentUser)),t3(n,l=>o(l))}}const s=YS("auth");return s&&LM(n,`http://${s}`),n}function pF(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}TM({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=er("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",pF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});uF("Browser");const mF={apiKey:"AIzaSyCdKE4Qpl1YGMMcU7-dtqPAjsqo0Bn43h4",authDomain:"neas-shop-e878c.firebaseapp.com",databaseURL:"https://neas-shop-e878c-default-rtdb.europe-west1.firebasedatabase.app",projectId:"neas-shop-e878c",storageBucket:"neas-shop-e878c.appspot.com",messagingSenderId:"1002686912721",appId:"1:1002686912721:web:40d4f887f2fa21e1f64df0"},ph=iC(mF),we=wI(ph);Wt(ph);const me=yr(ph);function gF(t){console.error("Firestore Error:",t)}function yF(){console.log("Setting up Firebase error handling...")}function vF(){console.log("Ensuring Firestore access...")}const _F=({message:t,type:e,onClose:n,duration:r=3e3})=>{k.useEffect(()=>{const o=setTimeout(()=>{n()},r);return()=>{clearTimeout(o)}},[r,n]);const s={success:"bg-green-50 border-green-400 text-green-800",error:"bg-red-50 border-red-400 text-red-800",info:"bg-blue-50 border-blue-400 text-blue-800"},i=()=>{switch(e){case"success":return a.jsx(_g,{className:"h-5 w-5 text-green-500"});case"error":return a.jsx(HR,{className:"h-5 w-5 text-red-500"});case"info":return a.jsx(KR,{className:"h-5 w-5 text-blue-500"});default:return null}};return a.jsx("div",{className:"fixed top-4 right-4 z-50 animate-slide-in",children:a.jsxs("div",{className:`p-4 rounded-md border shadow-lg flex items-center ${s[e]}`,children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(i,{})}),a.jsx("div",{className:"ml-3 flex-1",children:a.jsx("p",{className:"text-sm font-medium",children:t})}),a.jsx("div",{className:"ml-4 flex-shrink-0",children:a.jsx("button",{type:"button",className:"inline-flex rounded-md bg-transparent text-gray-400 hover:text-gray-500",onClick:n,children:a.jsx(WS,{className:"h-5 w-5"})})})]})})},TT=k.createContext({user:null,loading:!0,error:null,updateUserAvatar:async()=>{}}),bT=()=>k.useContext(TT),wF=({children:t})=>{const[e,n]=k.useState(null),[r,s]=k.useState(!0),[i,o]=k.useState(null);k.useEffect(()=>{const c=Wt();c.settings.appVerificationDisabledForTesting=!1;const d=Gy(c,async h=>{var f;try{if(h){console.log("AuthProvider: User is signed in:",h.email);const m=de(me,`users/${h.uid}`),y=await je(m),C=y.exists()?y.val():{},w={uid:h.uid,email:h.email,displayName:h.displayName||C.nickname||null,photoURL:h.photoURL||C.avatarURL||null,customUserId:C.customUserId,...C};if(n(w),localStorage.setItem("userProfile",JSON.stringify(w)),h.emailVerified){const R=(f=h.email)==null?void 0:f.split("@")[0].toLowerCase().replace(/[^a-z0-9-_]/g,"").replace(/\s+/g,"-"),T=de(me,`users/${R}`);await Tn(T,{isEmailVerified:!0,emailVerifiedAt:new Date().toISOString()})}document.cookie=`__session=1; path=/; SameSite=Strict; ${window.location.protocol==="https:"?"Secure;":""}`}else n(null),localStorage.removeItem("userProfile"),localStorage.removeItem("avatarURL"),localStorage.removeItem("nickname"),localStorage.removeItem("firstName"),localStorage.removeItem("lastName"),console.log("AuthProvider: User is signed out, cleared all data"),document.cookie="__session=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}catch(m){console.error("Error in auth state change handler:",m),o(m instanceof Error?m:new Error(String(m)))}finally{s(!1)}});return()=>d()},[]),k.useEffect(()=>{const c=d=>{var h;(h=d.detail)!=null&&h.avatarURL&&e&&n(f=>f?{...f,photoURL:d.detail.avatarURL}:null)};return window.addEventListener("avatarUpdated",c),()=>window.removeEventListener("avatarUpdated",c)},[e]);const l=Sn.useCallback(async c=>{if(e!=null&&e.email)try{const d=e.email.split("@")[0].toLowerCase().replace(/[^a-z0-9-_]/g,"").replace(/\s+/g,"-");if(e.photoURL===c)return;const f=de(me,`users/${d}`);await Tn(f,{avatarURL:c,lastUpdated:new Date().toISOString()}),n(C=>C?{...C,photoURL:c}:null);const m=Wt();if(m.currentUser&&c.length<=1024)try{await mT(m.currentUser,{photoURL:c})}catch(C){console.warn("Auth profile photo not updated due to length:",C)}const y=JSON.parse(localStorage.getItem("userProfile")||"{}");localStorage.setItem("userProfile",JSON.stringify({...y,photoURL:c,avatarURL:c})),localStorage.setItem("avatarURL",c)}catch(d){throw console.error("Error updating avatar:",d),d}},[e==null?void 0:e.email]);return a.jsx(TT.Provider,{value:{user:e,loading:r,error:i,updateUserAvatar:l},children:t})},Hn="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9IiNlMGUwZDAiLz48Y2lyY2xlIGN4PSI1MCIgY3k9IjM1IiByPSIxNSIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik01MCA1MGMtMTUgMC0zMCAxNS0zMCAzMHMxNSAzMCAzMCAzMCAzMC0xNSAzMC0zMFM2NSA1MCA1MCA1MHptMCA1MGMtMTAgMC0xOCA4LTE4IDE4czggMTggMTggMThjMTAuMSAwIDE4LTggMTgtMThzLTgtMTgtMTgtMTh6IiBmaWxsPSIjZmZmIi8+PC9zdmc+",gd=t=>{const e=t.currentTarget;e.src.includes("data:image/svg+xml;base64")||(e.src=Hn)},xF=Sn.memo(({photoURL:t,size:e=40,className:n=""})=>a.jsx("div",{className:`rounded-full overflow-hidden bg-gray-200 flex items-center justify-center ${n}`,style:{width:e,height:e},children:t?a.jsx("img",{src:t,alt:"User avatar",className:"w-full h-full object-cover",onError:gd}):a.jsx(Mu,{size:Math.floor(e*.6),className:"text-gray-600"})})),EF=()=>{const[t,e]=k.useState(""),[n,r]=k.useState([]),[s,i]=k.useState(!1),[,o]=k.useState([]),[l,c]=k.useState(0),[d,h]=k.useState(!1),[f,m]=k.useState(""),[y,C]=k.useState(!1),[w,R]=k.useState(!1),[T,x]=k.useState([]),[_,O]=k.useState(0),[j,L]=k.useState(!1),E=k.useRef(null),v=k.useRef(null),I=sr(),A=Wt(),{user:P,updateUserAvatar:M}=bT();k.useEffect(()=>{(async()=>{if(t.trim()===""){r([]);return}try{const H=["mobile","products","laptops","audio","tv","gaming"];let b=[];for(const Q of H){const z=bI(nt(we,Q),Wi("name",">=",t),Wi("name","<=",t+"")),ee=(await ot(z)).docs.map(K=>({id:K.id,...K.data()}));b=[...b,...ee]}r(b)}catch(H){console.error("Error fetching search results: ",H)}})()},[t]);const S=async()=>{if(P)try{const F=de(me,`users/${P.uid}`),H=await je(F);if(H.exists()){const b=H.val();if(b.avatarURL){await M(b.avatarURL),localStorage.setItem("avatarURL",b.avatarURL);const Q=localStorage.getItem("userProfile");if(Q){const z=JSON.parse(Q);z.avatarURL=b.avatarURL,localStorage.setItem("userProfile",JSON.stringify(z))}console.log("Avatar refreshed from Firebase:",b.avatarURL)}}}catch(F){console.error("Error refreshing avatar:",F)}};k.useEffect(()=>{const F=Gy(A,async H=>{if(console.log("Auth state changed:",(H==null?void 0:H.email)||"No user"),H)try{const b=yr(ph),Q=de(b,`users/${H.uid}`),z=await je(Q);let J={};z.exists()&&(J=z.val(),J.avatarURL&&await M(J.avatarURL)),localStorage.setItem("userProfile",JSON.stringify(J)),await S()}catch(b){console.error("Error fetching user data:",b)}else localStorage.removeItem("userProfile")});return()=>F()},[A,M]),k.useEffect(()=>{if(P){const F=de(me,`users/${P.uid}`),H=Zs(F,b=>{if(b.exists()){const Q=b.val();Q.avatarURL&&Q.avatarURL.length<=1024&&M(Q.avatarURL)}});return()=>H()}},[P,M]),k.useEffect(()=>{const F=JSON.parse(localStorage.getItem("favorites")||"[]");o(F);const H=()=>{const z=JSON.parse(localStorage.getItem("cart")||"[]").reduce((J,ee)=>J+ee.quantity,0);c(z)};H(),window.addEventListener("storage",H);const b=Q=>{H();const z=Q;z.detail&&z.detail.item&&(m(z.detail.item),h(!0),setTimeout(()=>h(!1),3e3))};return window.addEventListener("cartUpdated",b),()=>{window.removeEventListener("storage",H),window.removeEventListener("cartUpdated",b)}},[]),k.useEffect(()=>{const F=H=>{E.current&&!E.current.contains(H.target)&&v.current&&!v.current.contains(H.target)&&i(!1)};return document.addEventListener("mousedown",F),()=>{document.removeEventListener("mousedown",F)}},[]),k.useEffect(()=>{const F=H=>{w&&!H.target.closest(".relative")&&R(!1)};return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[w]),k.useEffect(()=>{const F=H=>{var Q;const b=H;(Q=b.detail)!=null&&Q.avatarURL&&(P&&M(b.detail.avatarURL),localStorage.setItem("avatarURL",b.detail.avatarURL))};return window.addEventListener("avatarUpdated",F),()=>window.removeEventListener("avatarUpdated",F)},[P,M]),k.useEffect(()=>{if(!(P!=null&&P.email))return;const F=P.email.split("@")[0].toLowerCase().replace(/[^a-z0-9-_]/g,"").replace(/\s+/g,"-"),H=de(me,`users/${F}`),b=Zs(H,Q=>{if(Q.exists()){const z=Q.val();z.avatarURL&&z.avatarURL!==P.photoURL&&setTimeout(()=>{M(z.avatarURL).catch(console.error)},0)}});return()=>b()},[P==null?void 0:P.email,P==null?void 0:P.photoURL,M]),k.useEffect(()=>{if(!P)return;(async()=>{try{const H=de(me,`users/${P.uid}/notifications`),b=Zs(H,Q=>{if(Q.exists()){const z=Q.val(),J=Object.keys(z).map(K=>({id:K,...z[K],read:z[K].read||!1}));J.sort((K,ie)=>new Date(ie.createdAt).getTime()-new Date(K.createdAt).getTime()),x(J);const ee=J.filter(K=>!K.read).length;O(ee)}else x([]),O(0)});return()=>b()}catch(H){console.error("Error fetching notifications:",H)}})()},[P]);const Z=async F=>{if(P)try{const H=de(me,`users/${P.uid}/notifications/${F}`);await Tn(H,{read:!0}),x(b=>b.map(Q=>Q.id===F?{...Q,read:!0}:Q)),O(b=>Math.max(0,b-1))}catch(H){console.error("Error marking notification as read:",H)}},U=F=>{Z(F.id),L(!1),I(`/product/${F.productId}#review-${F.reviewId}`)},q=async()=>{if(!(!P||T.length===0))try{const F={};T.forEach(H=>{H.read||(F[`users/${P.uid}/notifications/${H.id}/read`]=!0)}),Object.keys(F).length>0&&await Tn(de(me),F),x(H=>H.map(b=>({...b,read:!0}))),O(0)}catch(F){console.error("Error marking all notifications as read:",F)}},V=k.useMemo(()=>{if(!P)return a.jsx(Mu,{size:32,className:"text-white"});const F=P.photoURL||localStorage.getItem("avatarURL")||null;return a.jsx(xF,{photoURL:F})},[P]),D=F=>{F.preventDefault(),I(`/search?query=${t}`),i(!1)},$=async()=>{try{await r3(A),localStorage.removeItem("userProfile"),localStorage.removeItem("avatarURL"),localStorage.removeItem("nickname"),localStorage.removeItem("firstName"),localStorage.removeItem("lastName"),R(!1),I("/"),alert("You have been signed out")}catch(F){console.error("Error signing out:",F)}},W=()=>{if(!P){I("/login");return}I("/favorites")},ne=()=>{if(!P){I("/login");return}I("/cart")},se=()=>{C(!y)},ce=()=>JSON.parse(localStorage.getItem("cart")||"[]").slice(0,3);return a.jsxs("header",{className:"bg-[#003D2D] shadow-md relative",children:[a.jsx("div",{className:"container py-2 sm:py-4",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[a.jsxs("a",{href:"/",className:"shrink-0 block transition-all duration-500 ease-in-out origin-center transform hover:scale-110",children:[a.jsx("img",{src:ZR,alt:"Logo",className:"hidden sm:block w-auto h-6 sm:h-8 md:h-10"}),a.jsx("img",{src:"/symbol.svg",alt:"Logo",className:"block sm:hidden w-auto h-8"})]}),a.jsxs("div",{className:"relative w-full sm:max-w-[400px] md:max-w-[500px] lg:max-w-[600px]",children:[a.jsxs("form",{onSubmit:D,className:"relative w-full flex items-center",children:[a.jsx(JR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:20}),a.jsx("input",{ref:E,type:"text",placeholder:"Search for anything...",value:t,onChange:F=>{e(F.target.value),F.target.value&&i(!0)},onFocus:()=>{n.length>0&&i(!0)},className:"w-full px-10 py-2 text-black bg-white border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s&&n.length>0&&a.jsx("div",{ref:v,className:"absolute left-0 right-0 z-20 mt-2 bg-white border border-gray-300 rounded-lg shadow-lg top-full",children:n.map(F=>a.jsxs("div",{className:"p-2 cursor-pointer hover:bg-gray-100",onClick:()=>I(`/product/${F.id}`),children:[a.jsx("img",{src:F.image,alt:F.name,className:"inline-block w-8 h-8 mr-2"}),a.jsx("span",{children:F.name})]},F.id))})]})]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[P&&a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>L(!j),className:"btn btn-ghost btn-circle transition-all duration-500 ease-in-out hover:scale-110 relative",children:[a.jsx(GR,{size:32,className:"text-white"}),_>0&&a.jsx("div",{className:"absolute flex items-center justify-center w-6 h-6 text-xs font-bold text-white bg-red-600 rounded-full -top-2 -right-2",children:_})]}),j&&a.jsxs("div",{className:"absolute right-0 z-20 mt-2 bg-white rounded-md shadow-xl w-80",children:[a.jsxs("div",{className:"p-3 border-b flex justify-between items-center",children:[a.jsx("h3",{className:"font-semibold",children:"Notifications"}),_>0&&a.jsx("button",{onClick:q,className:"text-xs text-blue-600 hover:underline",children:"Mark all as read"})]}),a.jsx("div",{className:"p-2 overflow-y-auto max-h-60",children:T.length>0?T.map(F=>a.jsx("div",{className:`p-3 border-b cursor-pointer hover:bg-gray-50 ${F.read?"":"bg-blue-50"}`,onClick:()=>U(F),children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("div",{className:`rounded-full p-2 ${F.read?"bg-gray-100":"bg-blue-100"}`,children:a.jsx(kp,{size:16,className:F.read?"text-gray-600":"text-blue-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:`text-sm ${F.read?"":"font-semibold"}`,children:F.text}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(F.createdAt).toLocaleDateString()," • ",new Date(F.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),!F.read&&a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-600"})]})},F.id)):a.jsx("div",{className:"p-4 text-center text-gray-500",children:"No notifications"})})]})]}),a.jsx("button",{onClick:W,className:`btn btn-ghost btn-circle transition-all duration-500 ease-in-out hover:scale-110 ${P?"":"opacity-50"}`,title:P?"Favorites":"Please login to use favorites",children:a.jsx($S,{size:32,className:"text-white"})}),a.jsxs("div",{className:"relative pt-2",children:[a.jsxs("button",{onClick:se,className:`btn btn-ghost btn-circle relative transition-all duration-500 ease-in-out hover:scale-110 ${P?"":"opacity-50"}`,title:P?"Cart":"Please login to use cart",children:[a.jsx(_g,{size:32,className:"text-white"}),P&&l>0&&a.jsx("div",{className:"absolute flex items-center justify-center w-6 h-6 text-xs font-bold text-white bg-red-600 rounded-full -top-2 -right-2",children:l})]}),P&&y&&l>0&&a.jsxs("div",{className:"absolute right-0 z-20 mt-2 bg-white rounded-md shadow-xl w-80",children:[a.jsx("div",{className:"p-4 border-b",children:a.jsxs("h3",{className:"font-semibold",children:["Your Cart (",l," items)"]})}),a.jsxs("div",{className:"p-2 overflow-y-auto max-h-60",children:[ce().map((F,H)=>a.jsxs("div",{className:"flex items-center p-2 border-b hover:bg-gray-100",children:[a.jsx("img",{src:F.image,alt:F.name,className:"object-contain w-12 h-12"}),a.jsxs("div",{className:"flex-1 ml-2",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:F.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[F.quantity," × ",F.price," NOK"]})]})]},H)),l>3&&a.jsxs("p",{className:"mt-2 text-xs text-center text-gray-500",children:["and ",l-3," more items..."]})]}),a.jsx("div",{className:"p-3 bg-gray-50",children:a.jsx("button",{onClick:()=>{C(!1),ne()},className:"w-full btn btn-primary btn-sm",children:"View Cart"})})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>R(!w),className:"transition-all duration-500 ease-in-out btn btn-ghost btn-circle hover:scale-110",children:V}),w&&a.jsx("div",{className:"absolute right-0 z-20 w-48 mt-2 bg-white rounded-md shadow-xl",children:a.jsx("div",{className:"py-1",children:P?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"px-4 py-3 border-b",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:P.displayName||"User"}),a.jsx("p",{className:"text-xs text-gray-500",children:P.email})]}),a.jsx("a",{href:"/profile",onClick:F=>{F.preventDefault(),R(!1),I("/profile")},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Profile"}),a.jsx("button",{onClick:async()=>{await $(),R(!1),I("/")},className:"block w-full px-4 py-2 text-sm text-left text-red-600 hover:bg-gray-100",children:"Sign Out"})]}):a.jsxs(a.Fragment,{children:[a.jsx("a",{href:"/login",onClick:F=>{F.preventDefault(),R(!1),I("/login")},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Sign In"}),a.jsx("a",{href:"/register",onClick:F=>{F.preventDefault(),R(!1),I("/register")},className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Register"})]})})})]})]})]})}),d&&a.jsx(_F,{message:`Added to cart: ${f}`,type:"success",onClose:()=>h(!1)})]})},SF=()=>a.jsxs("footer",{className:"bg-[#003D2D] text-white py-6",children:[a.jsxs("div",{className:"container mx-auto grid grid-cols-2 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"NEAS AS"}),a.jsxs("ul",{className:"text-sm space-y-1",children:[a.jsx("li",{children:"Industriveien 1"}),a.jsx("li",{children:"6517 Kristiansund"}),a.jsx("li",{children:"Org.nr 960684737"}),a.jsx("li",{children:"P.O Box 2260 Løkkemyra"}),a.jsx("li",{children:"6503 Kristiansund N"})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"Contact Us"}),a.jsxs("ul",{className:"text-sm space-y-1",children:[a.jsx("li",{children:"Phone: 71 56 55 25"}),a.jsx("li",{children:"Opening Hours"})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"Follow Us"}),a.jsxs("ul",{className:"text-sm space-y-1",children:[a.jsx("li",{children:a.jsx("a",{href:"https://www.facebook.com/neas.i.nabolaget/",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"Facebook"})}),a.jsx("li",{children:a.jsx("a",{href:"https://www.instagram.com/neas_i_nabolaget/",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"Instagram"})}),a.jsx("li",{children:a.jsx("a",{href:"https://www.linkedin.com/company/neas-as/",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"LinkedIn"})}),a.jsx("li",{children:a.jsx("a",{href:"https://www.youtube.com/user/neaskanalen",target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"YouTube"})})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"Quick Links"}),a.jsxs("ul",{className:"text-sm space-y-1",children:[a.jsx("li",{children:"About Us"}),a.jsx("li",{children:"Help"}),a.jsx("li",{children:"Service Status"}),a.jsx("li",{children:"Work With Us"}),a.jsx("li",{children:"Privacy and Cookies"})]})]})]}),a.jsxs("div",{className:"container mx-auto mt-6 text-center border-t border-gray-700 pt-4",children:[a.jsx("img",{src:"/logo.svg",alt:"NEAS Logo",className:"h-6 mx-auto mb-2 sm:h-8"}),a.jsx("p",{className:"text-xs text-gray-400 sm:text-sm",children:"We are part of the NEAS GROUP"})]})]});var NT={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ox=Sn.createContext&&Sn.createContext(NT),vs=function(){return vs=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},vs.apply(this,arguments)},CF=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};function kT(t){return t&&t.map(function(e,n){return Sn.createElement(e.tag,vs({key:n},e.attr),kT(e.child))})}function yn(t){return function(e){return Sn.createElement(IF,vs({attr:vs({},t.attr)},e),kT(t.child))}}function IF(t){var e=function(n){var r=t.attr,s=t.size,i=t.title,o=CF(t,["attr","size","title"]),l=s||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),Sn.createElement("svg",vs({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:c,style:vs(vs({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&Sn.createElement("title",null,i),t.children)};return ox!==void 0?Sn.createElement(ox.Consumer,null,function(n){return e(n)}):e(NT)}function vm(t){return yn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"}}]})(t)}function _m(t){return yn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"}}]})(t)}function mh(t){return yn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"}}]})(t)}function TF(t){return yn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480.07 96H160a160 160 0 1 0 114.24 272h91.52A160 160 0 1 0 480.07 96zM248 268a12 12 0 0 1-12 12h-52v52a12 12 0 0 1-12 12h-24a12 12 0 0 1-12-12v-52H84a12 12 0 0 1-12-12v-24a12 12 0 0 1 12-12h52v-52a12 12 0 0 1 12-12h24a12 12 0 0 1 12 12v52h52a12 12 0 0 1 12 12zm216 76a40 40 0 1 1 40-40 40 40 0 0 1-40 40zm64-96a40 40 0 1 1 40-40 40 40 0 0 1-40 40z"}}]})(t)}function bF(t){return yn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"}}]})(t)}function NF(t){return yn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 416H381.54c-.74 19.81-14.71 32-32.74 32H288c-18.69 0-33.02-17.47-32.77-32H16c-8.8 0-16 7.2-16 16v16c0 35.2 28.8 64 64 64h512c35.2 0 64-28.8 64-64v-16c0-8.8-7.2-16-16-16zM576 48c0-26.4-21.6-48-48-48H112C85.6 0 64 21.6 64 48v336h512V48zm-64 272H128V64h384v256z"}}]})(t)}function kF(t){return yn({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M272 0H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h224c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zM160 480c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm112-108c0 6.6-5.4 12-12 12H60c-6.6 0-12-5.4-12-12V60c0-6.6 5.4-12 12-12h200c6.6 0 12 5.4 12 12v312z"}}]})(t)}function ax(t){return yn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"}}]})(t)}function RF(t){return yn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M500.33 0h-47.41a12 12 0 0 0-12 12.57l4 82.76A247.42 247.42 0 0 0 256 8C119.34 8 7.9 119.53 8 256.19 8.1 393.07 119.1 504 256 504a247.1 247.1 0 0 0 166.18-63.91 12 12 0 0 0 .48-17.43l-34-34a12 12 0 0 0-16.38-.55A176 176 0 1 1 402.1 157.8l-101.53-4.87a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12h200.33a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12z"}}]})(t)}function AF(t){return yn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528.12 301.319l47.273-208C578.806 78.301 567.391 64 551.99 64H159.208l-9.166-44.81C147.758 8.021 137.93 0 126.529 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24h69.883l70.248 343.435C147.325 417.1 136 435.222 136 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-15.674-6.447-29.835-16.824-40h209.647C430.447 426.165 424 440.326 424 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-22.172-12.888-41.332-31.579-50.405l5.517-24.276c3.413-15.018-8.002-29.319-23.403-29.319H218.117l-6.545-32h293.145c11.206 0 20.92-7.754 23.403-18.681z"}}]})(t)}function PF(t){return yn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M592 0H48A48 48 0 0 0 0 48v320a48 48 0 0 0 48 48h240v32H112a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16H352v-32h240a48 48 0 0 0 48-48V48a48 48 0 0 0-48-48zm-16 352H64V64h512z"}}]})(t)}function jF(t){return yn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"}}]})(t)}function DF(t){return yn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"}}]})(t)}const Ki=({value:t,maxValue:e=5,size:n="md",readonly:r=!0,onChange:s})=>{const i={xs:12,sm:16,md:20,lg:24}[n],o=Math.floor(t),l=t%1>=.5,c=d=>{!r&&s&&s(d)};return a.jsxs("div",{className:"flex items-center",children:[[...Array(e)].map((d,h)=>{const f=h+1,m=f<=o,y=!m&&l&&f===o+1;return a.jsx("div",{onClick:()=>c(f),style:{cursor:r?"default":"pointer",padding:"2px"},children:m?a.jsx(Oc,{size:i,fill:"#FFCA28",color:"#FFCA28",stroke:"#E6A700",strokeWidth:"1"}):y?a.jsxs("div",{className:"relative",children:[a.jsx(Oc,{size:i,color:"#e2e8f0",stroke:"#888888",strokeWidth:"1.5"}),a.jsx("div",{className:"absolute inset-0 overflow-hidden",style:{width:"50%"},children:a.jsx(Oc,{size:i,fill:"#FFCA28",color:"#FFCA28",stroke:"#E6A700",strokeWidth:"1"})})]}):a.jsx(Oc,{size:i,color:"#e2e8f0",stroke:"#888888",strokeWidth:"1.5"})},h)}),!r&&a.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:[t.toFixed(1),"/",e]})]})},LF=({images:t,productName:e,onClick:n})=>{const[r,s]=k.useState(0),[i,o]=k.useState(null),[l,c]=k.useState(null);k.useEffect(()=>{s(0)},[t]);const d=t.filter(w=>w&&w.trim()!=="");if(d.length===0)return a.jsx("div",{className:"h-48 w-full flex items-center justify-center bg-gray-100 rounded-xl",onClick:n,children:a.jsx("span",{className:"text-gray-400",children:"No image available"})});if(d.length===1)return a.jsx("img",{src:d[0],alt:e,className:"rounded-xl h-48 w-full object-contain",onClick:n});const h=w=>{w.stopPropagation(),s(R=>(R+1)%d.length)},f=w=>{w.stopPropagation(),s(R=>(R-1+d.length)%d.length)},m=w=>{o(w.targetTouches[0].clientX)},y=w=>{c(w.targetTouches[0].clientX)},C=()=>{if(!i||!l)return;const w=i-l,R=w>50,T=w<-50;R&&s(x=>(x+1)%d.length),T&&s(x=>(x-1+d.length)%d.length),o(null),c(null)};return a.jsxs("div",{className:"relative h-48 w-full",onTouchStart:m,onTouchMove:y,onTouchEnd:C,onClick:n,children:[a.jsx("div",{className:"carousel w-full h-full",children:d.map((w,R)=>a.jsx("div",{className:`carousel-item w-full h-full ${R===r?"block":"hidden"}`,children:a.jsx("img",{src:w,alt:`${e} - Image ${R+1}`,className:"w-full h-full object-contain rounded-xl"})},R))}),a.jsx("button",{onClick:f,className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white p-1 rounded-full shadow-md",children:a.jsx(US,{size:16})}),a.jsx("button",{onClick:h,className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white p-1 rounded-full shadow-md",children:a.jsx(vg,{size:16})}),a.jsx("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 flex space-x-1",children:d.map((w,R)=>a.jsx("button",{className:`w-2 h-2 rounded-full ${R===r?"bg-primary":"bg-gray-300"}`,onClick:T=>{T.stopPropagation(),s(R)}},R))})]})},OF=async t=>{const e=["laptops","gaming","tv","audio","mobile"];for(const n of e){const r=gt(we,n,t);try{const s=await In(r);if(s.exists())return{collection:n,data:{id:s.id,...s.data()}}}catch(s){console.error(`Error checking collection ${n}:`,s)}}return null},oo=async(t,e)=>{try{if(!e.incrementClick&&!e.incrementFavorite&&!e.incrementCart)return;const n=de(me,`productStats/${t}`),r=await je(n);if(!r.exists()){const i=await OF(t);if(i){await dt(n,{collection:i.collection,clickCount:e.incrementClick?1:0,favoriteCount:e.incrementFavorite?1:0,cartCount:e.incrementCart?1:0,lastUpdated:new Date().toISOString()});const o=de(me,`collectionStats/${i.collection}/${t}`);await dt(o,{clickCount:e.incrementClick?1:0,favoriteCount:e.incrementFavorite?1:0,cartCount:e.incrementCart?1:0,lastUpdated:new Date().toISOString()});return}}const s={lastUpdated:new Date().toISOString()};if(e.incrementClick&&(s.clickCount=If(1)),e.incrementFavorite&&(s.favoriteCount=If(1)),e.incrementCart&&(s.cartCount=If(1)),await Tn(n,s),r.exists()&&r.val().collection){const i=r.val().collection,o=de(me,`collectionStats/${i}/${t}`);await Tn(o,s)}}catch(n){console.error("Error tracking product interaction:",n)}},RT=async t=>{const n=Wt().currentUser;if(n){const r=de(me,`users/${n.uid}/favorites/${t}`);return(await je(r)).exists()}else return JSON.parse(localStorage.getItem("favorites")||"[]").includes(t)},AT=async(t,e)=>{const r=Wt().currentUser;try{if(r){const s=de(me,`users/${r.uid}/favorites/${t}`);return(await je(s)).exists()?(await dt(s,null),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:{productId:t,isFavorite:!1}})),!1):(await dt(s,{addedAt:new Date().toISOString(),productId:t,...e}),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:{productId:t,isFavorite:!0}})),!0)}else{const s=JSON.parse(localStorage.getItem("favorites")||"[]");if(s.includes(t)){const o=s.filter(l=>l!==t);return localStorage.setItem("favorites",JSON.stringify(o)),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:{productId:t,isFavorite:!1}})),!1}else return s.push(t),localStorage.setItem("favorites",JSON.stringify(s)),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:{productId:t,isFavorite:!0}})),!0}}catch(s){return console.error("Error toggling favorite:",s),!1}},PT=t=>{var i,o,l,c;if(t.brand!=="Apple")return"";const e=((i=t.screenSize)==null?void 0:i.replace(" inch",'"'))||"",n=t.modelNumber||"",r=((o=t.processor)==null?void 0:o.replace("Apple ",""))||"",s=`${(l=t.ram)==null?void 0:l.replace("GB","")}/${(c=t.storageType)==null?void 0:c.replace(" SSD","").replace("GB","")} GB`;return`Apple ${t.model} ${e} (${n}, ${r}) ${s}, ${t.color}`.trim()},MF=t=>{var n;return!t.brand||!t.model?"":[t.brand,t.model,t.connectivity,t.subtype,(n=t.color)==null?void 0:n.toLowerCase()].filter(Boolean).join(" ")},FF=t=>!t.brand||!t.model?"":[t.brand,t.model,t.memory,t.color].filter(Boolean).join(" "),VF=t=>{if(!t.brand)return"";const e=t.diagonal||t.screenSize||"";return[t.brand,e?`${e}"`:"",t.resolution||"",t.refreshRate||"",t.displayType||"",t.model||"",t.modelNumber||""].filter(Boolean).join(" ")},Si=({product:t})=>{const e={...t,brand:t.brand||"",model:t.model||"",price:typeof t.price=="number"?t.price:typeof t.price=="string"?parseFloat(t.price):0,id:t.id||"",name:t.name||"Unnamed Product",description:t.description||"",image:t.image||"",deviceType:t.deviceType||"",color:t.color||"",connectivity:t.connectivity||"",memory:t.memory||""},[n,r]=k.useState(e),i=Wt().currentUser,o=sr(),[l,c]=k.useState(!1),[d,h]=k.useState(!1),[f,m]=k.useState(!1);k.useEffect(()=>{(async()=>{const j=await RT(n.id);h(j)})();const O=j=>{var E;const L=j;((E=L.detail)==null?void 0:E.productId)===n.id&&h(L.detail.isFavorite)};return window.addEventListener("favoritesUpdated",O),()=>window.removeEventListener("favoritesUpdated",O)},[n.id]),k.useEffect(()=>{const _=de(me,`products/${n.id}`),O=Zs(_,j=>{if(j.exists()){const L=j.val();r(E=>({...E,rating:L.rating!==void 0?L.rating:0,reviewCount:L.reviewCount!==void 0?L.reviewCount:0}))}else r(L=>({...L,rating:0,reviewCount:0}))});return()=>O()},[n.id]),k.useEffect(()=>{const _=O=>{var L;const j=O;((L=j.detail)==null?void 0:L.productId)===n.id&&r(E=>({...E,rating:j.detail.rating,reviewCount:j.detail.reviewCount}))};return window.addEventListener("productRatingUpdated",_),()=>window.removeEventListener("productRatingUpdated",_)},[n.id]);const y=()=>{o(`/product/${n.id}`)},C=()=>{const _=[];n.image&&_.push(n.image),n.image2&&_.push(n.image2),n.image3&&_.push(n.image3),n.image4&&_.push(n.image4),n.image5&&_.push(n.image5);for(let O=6;O<=10;O++){const j=`image${O}`;n[j]&&_.push(n[j])}return _},w=_=>{if(_.preventDefault(),_.stopPropagation(),!i){o("/login");return}const O="cart",j=JSON.parse(localStorage.getItem(O)||"[]"),L=j.findIndex(E=>E.id===n.id);L>=0?j[L].quantity+=1:(j.push({id:n.id,name:n.name,price:n.price,image:n.image,quantity:1,collection:n.collection||"uncategorized"}),oo(n.id,{incrementCart:!0,userId:i.uid})),localStorage.setItem(O,JSON.stringify(j)),c(!0),m(!0),setTimeout(()=>m(!1),500),window.dispatchEvent(new CustomEvent("cartUpdated"))},R=async _=>{if(_.preventDefault(),_.stopPropagation(),!i){o("/login");return}try{const O={category:n.category||"uncategorized",name:n.name||"Product",image:n.image||"",price:n.price||0},j=await AT(n.id,O);h(j),j&&oo(n.id,{incrementFavorite:!0,userId:i.uid})}catch(O){console.error("Error updating favorites:",O),alert("Failed to update favorites")}},T=_=>{const O={..._,model:_.model||"",brand:_.brand||"",color:_.color||""};if(_.category==="laptops"&&_.brand==="Apple"){const L=PT(O);return a.jsx("span",{className:"font-medium",children:L})}if(_.collection==="audio"){const L=MF(_);return a.jsx("span",{className:"font-medium",children:L})}if(_.collection==="mobile")return a.jsx("span",{className:"font-medium",children:FF(_)});if(_.collection==="tv"||_.category==="tv"){const L=VF({brand:_.brand,diagonal:_.diagonal,screenSize:_.screenSize,resolution:_.resolution,refreshRate:_.refreshRate,displayType:_.displayType,model:_.model,modelNumber:_.modelNumber});return console.log("Formatted TV name:",L),a.jsx("span",{className:"font-medium",children:L})}const j=[];return _.brand&&j.push(a.jsx("span",{className:"font-medium text-primary",children:_.brand},"brand")),_.model&&j.push(a.jsx("span",{className:"font-medium",children:_.model},"model")),_.deviceType&&j.push(a.jsx("span",{className:"font-medium",children:_.deviceType},"deviceType")),_.connectivity&&j.push(a.jsx("span",{className:"text-sm text-gray-600",children:_.connectivity},"connectivity")),_.modelNumber&&j.push(a.jsx("span",{className:"font-medium",children:_.modelNumber},"modelNumber")),_.memory&&j.push(a.jsx("span",{className:"font-medium",children:_.memory},"memory")),_.color&&j.push(a.jsx("span",{className:"font-medium",children:_.color},"color")),j.length>0?a.jsx("div",{className:"flex flex-wrap gap-1",children:j}):a.jsx("span",{className:"font-medium",children:_.name})},x=_=>{if(!_)return null;if(_.includes("•")){const O=_.split("•").filter(j=>j.trim().length>0);if(O.length>0){const j=O.slice(0,3),L=O.length>3;return a.jsxs("ul",{className:"list-disc pl-4 text-xs text-gray-500 space-y-0.5 max-h-24 overflow-hidden",children:[j.map((E,v)=>a.jsx("li",{children:E.trim()},v)),L&&a.jsx("li",{className:"text-gray-400",children:"..."})]})}}return a.jsx("p",{className:"text-xs text-gray-500 line-clamp-3",children:_})};return a.jsx(mr,{to:`/product/${n.id}`,className:"block h-full",children:a.jsx("div",{className:"product-card-wrapper",children:a.jsxs("div",{className:"card bg-base-100 shadow-xl hover:shadow-2xl transition-all duration-300 product-card h-[420px] sm:h-[450px] lg:h-[480px] flex flex-col",children:[a.jsxs("figure",{className:"relative pt-4 px-3 sm:px-6 h-40 sm:h-48 lg:h-56",children:[a.jsx(LF,{images:C(),productName:n.name,onClick:y}),a.jsxs("div",{className:"absolute top-6 right-3 sm:right-6 flex flex-col gap-2",children:[a.jsx("button",{onClick:w,className:`btn btn-circle btn-primary ${i?"":"opacity-50"} ${l?"btn-success":""} ${f?"cart-flash":""}`,title:i?"Add to cart":"Please login to add to cart",children:a.jsx(AF,{className:`w-5 h-5 ${f?"text-[#F0E965]":""}`})}),a.jsx("button",{onClick:R,className:`p-2 hover:scale-110 transition-all ${i?"":"opacity-50"}`,title:i?d?"Remove from favorites":"Add to favorites":"Please login to add to favorites",children:a.jsx(bF,{className:`w-5 h-5 ${d?"text-red-500":"text-gray-400"}`})})]})]}),a.jsxs("div",{className:"card-body p-4 sm:p-6 flex flex-col flex-1",children:[a.jsxs("div",{className:"h-6 flex items-center gap-2",children:[a.jsx(Ki,{value:n.rating||0,size:"sm"}),a.jsx("span",{className:"text-xs text-gray-500",children:n.reviewCount&&n.reviewCount>0?`${(n.rating||0).toFixed(1)} (${n.reviewCount})`:"No reviews"})]}),a.jsx("div",{className:"min-h-[2.5rem] text-sm sm:text-base",children:T(n)}),a.jsx("div",{className:"flex-1 overflow-hidden text-xs sm:text-sm",children:x(n.description)}),a.jsx("div",{className:"mt-2 text-lg sm:text-xl",children:a.jsxs("span",{className:"font-bold",children:[typeof n.price=="number"?n.price.toFixed(2):Number(n.price).toFixed(2)," NOK"]})})]})]})})})},gh=({filters:t,selectedFilters:e={},activeFilters:n={},onFilterChange:r})=>{const[s,i]=k.useState({min:0,max:1e4,current:[0,1e4]}),[o,l]=k.useState("0"),[c,d]=k.useState("10000"),h=k.useRef(!1),f=k.useRef(null),m=k.useCallback(L=>{f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{r("price",L)},100)},[r]);k.useEffect(()=>{if(h.current)return;const L=t.find(E=>(E.key==="price"||E.id==="price")&&E.type==="range");if(L&&L.min!==void 0&&L.max!==void 0){const E=L.min,v=L.max;let I=[E,v];n.price&&Array.isArray(n.price)&&(I=n.price),i({min:E,max:v,current:I}),l(String(I[0])),d(String(I[1])),h.current=!0}},[t,n]),k.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]);const y=L=>{l(L.target.value)},C=L=>{d(L.target.value)},w=()=>{const L=Math.max(s.min,Number(o)||s.min),E=Math.min(s.max,Number(c)||s.max),v=Math.min(L,E),I=Math.max(L,E),A=[v,I];i(P=>({...P,current:A})),l(String(v)),d(String(I)),r("price",A)},R=(L,E)=>{const v=String(typeof E=="object"?E.value:E);if(e&&L in e)return Array.isArray(e[L])&&e[L].includes(v);if(n&&L in n){const I=n[L];if(I instanceof Set)return I.has(typeof E=="object"?E.value:E)||I.has(v)}return!1},T=(L,E,v)=>{const I=String(typeof E=="object"?E.value:E);console.log("Filter change:",{filterId:L,value:E,stringValue:I,checked:v}),v?r(L,[...e[L]||[],I]):r(L,(e[L]||[]).filter(A=>A!==I))},x=L=>typeof L=="object"?L.value:L,_=L=>typeof L=="object"?L.count:0,O=()=>{const L=(E,v)=>{E.preventDefault();const I=E.currentTarget.parentElement;if(!I)return;const A=I.getBoundingClientRect(),P=E.clientX,M=v?s.current[0]:s.current[1],S=q=>{const D=(q-P)/A.width,$=s.max-s.min,W=M+$*D;return Math.round(W/100)*100},Z=q=>{q.preventDefault();let V=S(q.clientX);if(v){V=Math.max(s.min,Math.min(s.current[1]-100,V));const D=[V,s.current[1]];i($=>({...$,current:D})),l(String(V)),m(D)}else{V=Math.min(s.max,Math.max(s.current[0]+100,V));const D=[s.current[0],V];i($=>({...$,current:D})),d(String(V)),m(D)}},U=()=>{document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",U),r("price",[s.current[0],s.current[1]])};document.addEventListener("mousemove",Z),document.addEventListener("mouseup",U)};return a.jsxs("div",{className:"relative px-1 mt-4 mb-6",children:[a.jsxs("div",{className:"relative w-full h-3 bg-gray-200 rounded-lg",children:[a.jsx("div",{className:"absolute top-0 h-full bg-yellow-400 rounded-lg transition-all duration-150",style:{left:`${(s.current[0]-s.min)/(s.max-s.min)*100}%`,width:`${(s.current[1]-s.current[0])/(s.max-s.min)*100}%`}}),a.jsx("button",{type:"button",className:"absolute z-20 w-6 h-6 -ml-3 -mt-1.5 bg-yellow-400 border-2 border-white rounded-full shadow-md hover:shadow-lg active:scale-95 transition-all focus:outline-none focus:ring-2 focus:ring-yellow-300",style:{left:`${(s.current[0]-s.min)/(s.max-s.min)*100}%`,top:"50%"},onMouseDown:E=>L(E,!0),onClick:E=>E.stopPropagation()}),a.jsx("button",{type:"button",className:"absolute z-20 w-6 h-6 -ml-3 -mt-1.5 bg-yellow-400 border-2 border-white rounded-full shadow-md hover:shadow-lg active:scale-95 transition-all focus:outline-none focus:ring-2 focus:ring-yellow-300",style:{left:`${(s.current[1]-s.min)/(s.max-s.min)*100}%`,top:"50%"},onMouseDown:E=>L(E,!1),onClick:E=>E.stopPropagation()})]}),a.jsxs("div",{className:"flex justify-between px-1 mt-4",children:[a.jsxs("span",{className:"text-sm font-medium",children:[s.current[0]," NOK"]}),a.jsxs("span",{className:"text-sm font-medium",children:[s.current[1]," NOK"]})]})]})},j=L=>{const E=(v,I)=>(v==="processor"&&typeof I=="string"&&(I.includes("Apple M")||I.includes("Intel")||I.includes("AMD")),I);return L.key==="category"||L.name==="Category"?null:a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"mb-2 font-medium",children:L.name}),L.values.map(v=>{const I=x(v),A=L.key||L.id||L.name,P=E(A,I),M=`${A}-${I}`,S=R(A,I);return a.jsxs("div",{className:"flex items-center mt-1",children:[a.jsx("input",{type:"checkbox",id:M,className:"checkbox checkbox-sm",checked:S,onChange:()=>T(A,I,!S)}),a.jsxs("label",{htmlFor:M,className:"ml-2 text-sm cursor-pointer",children:[P,"(",_(v),")"]})]},M)})]},L.key||L.name)};return a.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[a.jsx("h3",{className:"mb-4 text-lg font-semibold",children:"Filters"}),[...t].sort((L,E)=>{const v=window.location.pathname;if(["/laptops","/tv","/audio","/gaming"].includes(v)){if(L.type==="range"&&L.key==="price")return-1;if(E.type==="range"&&E.key==="price")return 1}return 0}).map(L=>{const E=L.id||L.key||"";return L.type==="range"&&L.min!==void 0&&L.max!==void 0?a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"mb-2 font-medium",children:L.name}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("input",{type:"number",min:s.min,max:s.max,value:o,onChange:y,onBlur:w,onKeyDown:v=>v.key==="Enter"&&w(),className:"w-full input input-bordered input-sm",placeholder:"Min"}),a.jsx("span",{className:"text-gray-500",children:"-"}),a.jsx("input",{type:"number",min:s.min,max:s.max,value:c,onChange:C,onBlur:w,onKeyDown:v=>v.key==="Enter"&&w(),className:"w-full input input-bordered input-sm",placeholder:"Max"})]}),O()]},E):j(L)})]})},UF=()=>{const[t,e]=k.useState([]),[n,r]=k.useState(!0),[s,i]=k.useState(null),[o,l]=k.useState(!1),[c,d]=k.useState([]),[h,f]=k.useState({}),[m,y]=k.useState([]);k.useEffect(()=>{(async()=>{try{const R=nt(we,"mobile"),x=(await ot(R)).docs.map(_=>({id:_.id,..._.data(),name:_.data().name||"Unnamed Product",description:_.data().description||"No description available",price:Number(_.data().price)||0,image:_.data().image||"",brand:_.data().brand||"",memory:_.data().memory||"",color:_.data().color||"",category:"mobile"}));e(x),d(x)}catch(R){console.error("Error fetching mobile products:",R),i("Failed to load products")}finally{r(!1)}})()},[]),k.useEffect(()=>{(async()=>{try{const R=nt(we,"mobile"),T=await ot(R),x={brand:{},memory:{},color:{}};let _=1/0,O=0;T.forEach(v=>{const I=v.data();if(I.brand&&(x.brand[I.brand]=(x.brand[I.brand]||0)+1),I.memory&&(x.memory[I.memory]=(x.memory[I.memory]||0)+1),I.color&&(x.color[I.color]=(x.color[I.color]||0)+1),I.price){const A=Number(I.price);isNaN(A)||(_=Math.min(_,A),O=Math.max(O,A))}});const j=Math.floor(_/100)*100,L=Math.ceil(O/100)*100,E=[{id:"price",name:"Price",values:[],type:"range",min:j,max:L},{id:"brand",name:"Brand",values:Object.entries(x.brand).map(([v,I])=>({value:v,count:I})).sort((v,I)=>v.value.localeCompare(I.value))},{id:"memory",name:"Memory",values:Object.entries(x.memory).map(([v,I])=>({value:v,count:I})).sort((v,I)=>v.value.localeCompare(I.value))},{id:"color",name:"Color",values:Object.entries(x.color).map(([v,I])=>({value:v,count:I})).sort((v,I)=>v.value.localeCompare(I.value))}];y(E)}catch(R){console.error("Error fetching filters:",R)}})()},[]),k.useEffect(()=>{if(!t.length)return;const w=t.filter(R=>Object.entries(h).every(([T,x])=>{if(!x.length)return!0;if(T==="price"&&x.length===2){const[O,j]=x.map(Number),L=Number(R.price);return!isNaN(L)&&L>=O&&L<=j}const _=String(R[T]||"").toLowerCase();return x.some(O=>_===O.toLowerCase())}));console.log("Filtered products:",w.length),d(w)},[t,h]);const C=(w,R)=>{const T={...h};w==="price"&&Array.isArray(R)&&R.length===2?T[w]=R.map(String):T[w]=Array.isArray(R)?R.map(String):[String(R)],f(T)};return n?a.jsx("div",{className:"flex justify-center items-center min-h-screen",children:a.jsx("span",{className:"loading loading-spinner loading-lg"})}):s?a.jsx("div",{className:"text-red-500 text-center py-8",children:s}):a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Mobile Phones"}),a.jsxs("button",{onClick:()=>l(!o),className:"btn btn-primary flex items-center gap-2",children:[a.jsx(mh,{}),o?"Hide Filters":"Show Filters"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[o&&a.jsx("div",{className:"md:col-span-1",children:a.jsx(gh,{filters:m,selectedFilters:h,onFilterChange:C})}),a.jsx("div",{className:`${o?"md:col-span-3":"md:col-span-4"}`,children:c.length>0?a.jsx("div",{className:"px-12 sm:px-16 overflow-x-hidden",children:a.jsx("div",{className:"flex flex-row flex-wrap",children:c.map(w=>a.jsx("div",{className:"w-full sm:w-1/2 lg:w-1/3 mb-6",children:a.jsx(Si,{product:w},w.id)},w.id))})}):a.jsx("div",{className:"col-span-full text-center py-8",children:"No products found matching the selected filters."})})]})]})},$F=({productId:t})=>{const[e,n]=k.useState([]),[r,s]=k.useState(0),[i,o]=k.useState(null),[l,c]=k.useState(""),[d,h]=k.useState(5),[f,m]=k.useState(!1),[y,C]=k.useState(""),[w,R]=k.useState(!1),[T,x]=k.useState(!1),[_,O]=k.useState(!1),[j,L]=k.useState(new Set),[E,v]=k.useState(null),[I,A]=k.useState(""),[P,M]=k.useState(!1),[S,Z]=k.useState(!1),q=Wt().currentUser;k.useEffect(()=>{const F=de(me,`productReviews/${t}`);let H;try{if(H=Zs(F,b=>{if(b.exists()){const Q=b.val(),z=Object.keys(Q);if(z.length===0){n([]),s(0),V();return}const J=z.map(K=>{const ie=Q[K];return{id:K,...ie,userAvatar:ie.userAvatar||""}});J.sort((K,ie)=>new Date(ie.date).getTime()-new Date(K.date).getTime()),n(J);const ee=J.reduce((K,ie)=>K+ie.rating,0);if(s(ee/J.length),q){const K=J.find(ie=>ie.userId===q.uid);K?(o(K),c(K.text),h(K.rating)):(o(null),c(""),h(5))}}else n([]),s(0),V(),o(null)},b=>{console.error("Error listening to reviews:",b)}),q){const b=de(me,`users/${q.uid}/helpfulReviews`);je(b).then(Q=>{if(Q.exists()){const z=Q.val(),J=new Set(Object.keys(z));L(J)}}).catch(Q=>{console.error("Error loading helpful reviews:",Q)})}}catch(b){console.error("Error setting up reviews listener:",b)}return()=>{try{H&&H()}catch(b){console.warn("Error unsubscribing from reviews:",b)}}},[t,q]),k.useEffect(()=>{if(!q){Z(!1);return}(async()=>{try{const H=de(me,`users/${q.uid}`),b=await je(H);if(b.exists()){const Q=b.val();Z(Q.role==="admin")}else Z(!1)}catch(H){console.error("Error checking admin status:",H),Z(!1)}})()},[q]);const V=async()=>{try{await Tn(de(me,`products/${t}`),{rating:0,reviewCount:0}).catch(H=>console.warn("Error updating realtime DB rating:",H));const F=["mobile","products","tv"];for(const H of F)try{const b=gt(we,H,t);if((await In(b)).exists()){await Js(b,{rating:0,reviewCount:0}),console.log(`Reset rating in ${H} collection`);break}}catch{}window.dispatchEvent(new CustomEvent("productRatingUpdated",{detail:{productId:t,rating:0,reviewCount:0}}))}catch(F){console.error("Error resetting product rating:",F),gF(F)}},D=async()=>{if(!q){C("You must be signed in to leave a review.");return}if(l.trim().length<3){C("Review text must be at least 3 characters.");return}if(!t||t==="undefined"){C("Invalid product ID. Please reload the page and try again."),console.error("Attempted to submit review with invalid productId:",t);return}m(!0),C("");try{console.log("Starting review submission process..."),console.log("User:",q.uid),console.log("Product ID:",t);let F="";try{const ee=de(me,`users/${q.uid}`),K=await je(ee);if(K.exists()){const ie=K.val();ie.avatarURL&&(F=ie.avatarURL,console.log("Using avatar directly from database:",F))}}catch(ee){console.error("Error getting avatar from database:",ee)}if(!F&&q.photoURL&&(F=q.photoURL,console.log("Using avatar from user.photoURL:",F)),!F){const ee=localStorage.getItem("avatarURL");ee&&ee!=="null"&&ee!=="undefined"&&(F=ee,console.log("Using avatar from localStorage:",F))}F||(F=Hn,console.log("Using default avatar"));let H;w&&i?(H=i.id,console.log("Updating existing review with ID:",H)):(H=`${q.uid.slice(0,8)}_${Date.now()}`,console.log("Creating new review with ID:",H));const b={userId:q.uid,productId:t,userName:q.displayName||"Anonymous",userAvatar:F,rating:d,text:l.trim(),date:new Date().toISOString(),helpful:(i==null?void 0:i.helpful)||0,createdAt:w&&(i!=null&&i.createdAt)?i.createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};console.log("Review data prepared:",b);const Q=de(me,`productReviews/${t}/${H}`);await dt(Q,b),console.log(`Review ${w?"updated":"saved"} successfully`);const z=de(me,`productReviews/${t}`),J=await je(z);if(J.exists()){console.log("Recalculating rating from all reviews...");const ee=J.val(),K=Object.values(ee),_e=K.reduce((De,vt)=>De+vt.rating,0)/K.length,Pe=K.length;console.log("New average rating:",_e),console.log("New review count:",Pe),await Tn(de(me,`products/${t}`),{rating:_e,reviewCount:Pe}),console.log("Updated rating in Realtime Database");try{const De=["mobile","products","tv"];let vt=!1;for(const vn of De){const ar=gt(we,vn,t);try{if((await In(ar)).exists()){await Js(ar,{rating:_e,reviewCount:Pe}),console.log(`Updated rating in ${vn} collection`),vt=!0;break}}catch(Ds){console.log(`Collection ${vn} check failed:`,Ds)}}vt||console.log("Product not found in any collection, skipping Firestore update"),window.dispatchEvent(new CustomEvent("productRatingUpdated",{detail:{productId:t,rating:_e,reviewCount:Pe}}))}catch(De){console.error("Error updating Firestore:",De)}}o({...b,id:H}),R(!1),alert(`Your review has been ${w?"updated":"submitted"} successfully!`)}catch(F){console.error("Error submitting review:",F),C(`Failed to submit review: ${F instanceof Error?F.message:"Unknown error"}`)}finally{m(!1)}},$=async()=>{if(q)try{const F=de(me,`users/${q.uid}`),H=await je(F);if(H.exists()&&H.val().avatarURL){const b=H.val().avatarURL,Q=de(me,`productReviews/${t}`),z=await je(Q);if(z.exists()){const J=z.val();for(const[ee,K]of Object.entries(J)){const ie=K;ie.userId===q.uid&&ie.userAvatar!==b&&(console.log(`Updating avatar in review ${ee}`),await dt(de(me,`productReviews/${t}/${ee}/userAvatar`),b))}}}}catch(F){console.error("Error updating review avatars:",F)}};k.useEffect(()=>{q&&$()},[q,t]),k.useEffect(()=>{const F=H=>{var Q;(Q=H.detail)!=null&&Q.avatarURL&&q&&(console.log("Avatar updated event detected, updating review avatars"),$())};return window.addEventListener("avatarUpdated",F),()=>window.removeEventListener("avatarUpdated",F)},[q]),k.useEffect(()=>{const F=()=>{if(window.location.hash&&window.location.hash.startsWith("#review-")){const H=window.location.hash.replace("#review-",""),b=document.getElementById(`review-${H}`);b&&setTimeout(()=>{b.scrollIntoView({behavior:"smooth",block:"center"}),b.classList.add("highlight-review"),setTimeout(()=>{b.classList.remove("highlight-review")},2e3)},300)}};return F(),window.addEventListener("hashchange",F),()=>window.removeEventListener("hashchange",F)},[e]);const W=async()=>{if(!(!q||!i)){x(!0);try{const F=de(me,`productReviews/${t}/${i.id}`);await Uw(F);const H=de(me,`productReviews/${t}`),b=await je(H);let Q=0,z=0;if(b.exists()){const J=b.val(),ee=Object.values(J);z=ee.length,z>0&&(Q=ee.reduce((ie,_e)=>ie+_e.rating,0)/z)}await Tn(de(me,`products/${t}`),{rating:Q,reviewCount:z});try{const J=["mobile","products","tv"];for(const ee of J){const K=gt(we,ee,t);try{if((await In(K)).exists()){await Js(K,{rating:Q,reviewCount:z});break}}catch{}}window.dispatchEvent(new CustomEvent("productRatingUpdated",{detail:{productId:t,rating:Q,reviewCount:z}}))}catch(J){console.error("Error updating Firestore:",J)}o(null),c(""),h(5),O(!1),alert("Your review has been deleted successfully!")}catch(F){console.error("Error deleting review:",F),alert(`Failed to delete review: ${F instanceof Error?F.message:"Unknown error"}`)}finally{x(!1)}}},ne=async F=>{if(!q){alert("You need to be logged in to mark reviews as helpful");return}try{if(j.has(F)){const b=de(me,`productReviews/${t}/${F}/helpful`),Q=await je(b),z=Q.exists()?Q.val():0;await dt(b,Math.max(0,z-1));const J=de(me,`productReviews/${t}/${F}/helpfulBy`),ee=await je(J);if(ee.exists()){const _e=ee.val();if(Array.isArray(_e)){const Pe=_e.filter(De=>De!==q.uid);await dt(J,Pe)}}const K=de(me,`users/${q.uid}/helpfulReviews/${F}`);await dt(K,null);const ie=new Set(j);ie.delete(F),L(ie)}else{const b=de(me,`productReviews/${t}/${F}/helpful`),Q=await je(b),z=Q.exists()?Q.val():0;await dt(b,z+1);const J=de(me,`productReviews/${t}/${F}/helpfulBy`),ee=await je(J),K=ee.exists()?ee.val():[];Array.isArray(K)?K.includes(q.uid)||await dt(J,[...K,q.uid]):await dt(J,[q.uid]);const ie=de(me,`users/${q.uid}/helpfulReviews/${F}`);await dt(ie,{productId:t,timestamp:new Date().toISOString()}),L(_e=>new Set(_e).add(F))}}catch(H){console.error("Error updating helpful status:",H),alert("Failed to update helpful status. Please try again.")}},se=async F=>{if(!q){alert("You must be signed in to reply to reviews.");return}if(I.trim().length<3){alert("Reply text must be at least 3 characters.");return}M(!0);try{let H="";try{const K=de(me,`users/${q.uid}`),ie=await je(K);if(ie.exists()){const _e=ie.val();_e.avatarURL&&(H=_e.avatarURL)}}catch(K){console.error("Error getting avatar from database:",K)}if(!H&&q.photoURL&&(H=q.photoURL),!H){const K=localStorage.getItem("avatarURL");K&&K!=="null"&&K!=="undefined"&&(H=K)}H||(H=Hn);const b=`reply_${q.uid.slice(0,4)}_${Date.now()}`,Q={id:b,userId:q.uid,userName:S?"Администрация":q.displayName||"Anonymous",userAvatar:H,text:I.trim(),date:new Date().toISOString(),isAdmin:S},z=de(me,`productReviews/${t}/${F}/replies/${b}`);await dt(z,Q);const J=de(me,`productReviews/${t}/${F}`),ee=await je(J);if(ee.exists()){const K=ee.val();if(K.userId&&K.userId!==q.uid){let ie="a product";try{const vt=de(me,`products/${t}`),vn=await je(vt);if(vn.exists()){const ar=vn.val();ar.name&&(ie=ar.name)}}catch(vt){console.error("Error getting product name:",vt)}const _e=`reply_${Date.now()}`,Pe={id:_e,type:"reply",text:`${S?"An administrator":q.displayName||"Someone"} replied to your review of ${ie}.`,userId:K.userId,fromUserId:q.uid,fromUserName:S?"Администрация":q.displayName||"Anonymous",productId:t,reviewId:F,replyId:b,read:!1,createdAt:new Date().toISOString()},De=de(me,`users/${K.userId}/notifications/${_e}`);await dt(De,Pe)}}A(""),v(null)}catch(H){console.error("Error submitting reply:",H),alert(`Failed to submit reply: ${H instanceof Error?H.message:"Unknown error"}`)}finally{M(!1)}},ce=async(F,H)=>{if(q)try{const b=de(me,`productReviews/${t}/${F}/replies/${H}`),Q=await je(b);if(Q.exists()){const z=Q.val();S||z.userId===q.uid?await Uw(b):alert("You can only delete your own replies.")}}catch(b){console.error("Error deleting reply:",b),alert(`Failed to delete reply: ${b instanceof Error?b.message:"Unknown error"}`)}};return k.useEffect(()=>{if((()=>{window.location.hash==="#reviews"&&window.scrollTo(0,0)})(),window.location.hash){const H=window.pageYOffset;window.history.replaceState(null,document.title,window.location.pathname+window.location.search),window.scrollTo(0,H)}},[]),a.jsxs("div",{className:"mt-8",id:"reviews",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Customer Reviews"}),a.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:a.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-4xl font-bold",children:r.toFixed(1)}),a.jsx(Ki,{value:r,size:"lg"}),a.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[e.length," reviews"]})]}),a.jsx("div",{className:"flex-1",children:[5,4,3,2,1].map(F=>{const H=e.filter(Q=>Math.floor(Q.rating)===F).length,b=e.length?H/e.length*100:0;return a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("div",{className:"flex items-center w-12",children:[a.jsx("span",{className:"text-sm font-medium",children:F}),a.jsx("svg",{className:"w-4 h-4 text-yellow-300 ml-1","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 22 20",children:a.jsx("path",{d:"M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z"})})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:a.jsx("div",{className:"bg-yellow-300 h-3 rounded-full transition-all duration-300",style:{width:`${b}%`}})}),a.jsxs("div",{className:"flex justify-between w-16",children:[a.jsx("span",{className:"text-sm",children:H}),a.jsxs("span",{className:"text-sm text-gray-500",children:["(",b.toFixed(0),"%)"]})]})]},F)})})]})}),q?i&&!w?a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"font-bold",children:"Your Review"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{className:"btn btn-sm btn-outline",onClick:()=>R(!0),children:[a.jsx(YR,{size:16,className:"mr-1"})," Edit"]}),a.jsxs("button",{className:"btn btn-sm btn-outline btn-error",onClick:()=>O(!0),children:[a.jsx(qS,{size:16,className:"mr-1"})," Delete"]})]})]}),a.jsx("div",{className:"mb-2",children:a.jsx(Ki,{value:i.rating,readonly:!0})}),a.jsx("p",{className:"text-gray-700",children:i.text}),a.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Posted on ",new Date(i.date).toLocaleDateString()]}),_&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:"Delete Review"}),a.jsx("p",{className:"mb-6",children:"Are you sure you want to delete your review? This action cannot be undone."}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{className:"btn btn-outline",onClick:()=>O(!1),disabled:T,children:"Cancel"}),a.jsx("button",{className:"btn btn-error",onClick:W,disabled:T,children:T?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"loading loading-spinner loading-xs mr-2"}),"Deleting..."]}):"Delete Review"})]})]})})]}):a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[a.jsx("h3",{className:"font-bold mb-4",children:w?"Edit Your Review":"Write a Review"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rating"}),a.jsx(Ki,{value:d,readonly:!1,onChange:h,size:"md"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Review"}),a.jsx("textarea",{value:l,onChange:F=>c(F.target.value),className:"textarea textarea-bordered w-full h-24",placeholder:"Share your experience with this product..."})]}),y&&a.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded mb-4",children:y}),a.jsxs("div",{className:"flex gap-2 justify-end",children:[w&&a.jsx("button",{className:"btn btn-outline",onClick:()=>{R(!1),c((i==null?void 0:i.text)||""),h((i==null?void 0:i.rating)||5)},children:"Cancel"}),a.jsx("button",{className:"btn btn-primary",onClick:D,disabled:f,children:f?"Submitting...":w?"Update Review":"Submit Review"})]})]}):a.jsx("div",{className:"bg-blue-50 text-blue-700 p-4 rounded-md mb-6",children:a.jsxs("p",{children:["Please ",a.jsx("a",{href:"/login",className:"underline font-medium",children:"sign in"})," to write a review."]})}),a.jsx("div",{className:"space-y-4",children:e.length===0?a.jsx("p",{className:"text-gray-500 text-center py-8",children:"No reviews yet. Be the first to review this product!"}):e.map(F=>a.jsxs("div",{id:`review-${F.id}`,className:"bg-white p-6 rounded-lg shadow-md transition-all duration-700",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[F.userAvatar&&F.userAvatar!=="undefined"&&F.userAvatar!=="null"?a.jsx("img",{src:F.userAvatar,alt:F.userName,className:"w-10 h-10 rounded-full object-cover border border-gray-200",onError:gd}):a.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center border border-gray-300",children:a.jsx(Mu,{size:20,className:"text-gray-500"})}),a.jsx("span",{className:"font-medium",children:F.userName||"Anonymous"})]}),a.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[a.jsx(QR,{size:14}),a.jsx("span",{children:new Date(F.date).toLocaleDateString()})]})]}),a.jsx("div",{className:"mb-2",children:a.jsx(Ki,{value:F.rating,readonly:!0,size:"sm"})}),a.jsx("p",{className:"text-gray-700",children:F.text}),a.jsxs("div",{className:"flex justify-between mt-4",children:[q&&a.jsxs("button",{className:`flex items-center gap-1 text-sm 
                      ${E===F.id?"text-green-600 font-medium":"text-green-600 hover:text-green-700"}`,onClick:()=>v(E===F.id?null:F.id),children:[a.jsx(kp,{size:14}),a.jsx("span",{children:E===F.id?"Cancel Reply":"Reply"})]}),a.jsxs("button",{className:`flex items-center gap-1 text-sm 
                    ${j.has(F.id)?"text-primary font-medium":"text-gray-500 hover:text-primary"}`,onClick:()=>ne(F.id),children:[a.jsx(XR,{size:14,className:j.has(F.id)?"fill-primary":""}),a.jsxs("span",{children:[j.has(F.id)?"Marked as helpful":"Helpful"," (",F.helpful||0,")"]})]})]}),E===F.id&&q&&a.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-100",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Write a reply"}),a.jsx("textarea",{value:I,onChange:H=>A(H.target.value),className:"textarea textarea-bordered w-full h-20 text-sm",placeholder:"Write your reply here..."}),a.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>{v(null),A("")},children:"Cancel"}),a.jsx("button",{className:"btn btn-sm bg-green-600 hover:bg-green-700 text-white border-none",onClick:()=>se(F.id),disabled:P||I.trim().length<3,children:P?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Posting..."]}):"Post reply"})]})]}),F.replies&&Object.keys(F.replies).length>0&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[a.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1.5",children:[a.jsx(kp,{size:14,className:"text-green-600"}),a.jsxs("span",{children:["Replies (",Object.keys(F.replies).length,")"]})]}),a.jsx("div",{className:"space-y-3 pl-4 border-l-2 border-gray-100",children:Object.values(F.replies).map(H=>a.jsxs("div",{className:`p-3 rounded-md ${H.isAdmin?"bg-green-50 border border-green-200":"bg-gray-50"}`,children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[H.userAvatar&&H.userAvatar!=="undefined"&&H.userAvatar!=="null"?a.jsx("img",{src:H.userAvatar,alt:H.userName,className:"w-8 h-8 rounded-full object-cover border border-gray-200",onError:gd}):a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${H.isAdmin?"bg-green-500":"bg-gray-300"}`,children:a.jsx(Mu,{size:16,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-sm",children:H.userName}),H.isAdmin&&a.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Admin"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-gray-500",children:new Date(H.date).toLocaleDateString()}),q&&(S||H.userId===q.uid)&&a.jsx("button",{className:"text-red-400 hover:text-red-600 transition-colors",onClick:()=>ce(F.id,H.id),title:"Delete reply",children:a.jsx(WS,{size:14})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-gray-700",children:H.text})]},H.id))})]})]},F.id))})]})},BF=({variants:t,currentVariantId:e,onSelectVariant:n})=>{if(k.useEffect(()=>{t.forEach(s=>{if(s.image){const i=new Image;i.src=s.image}})},[t]),t.length<=1)return null;const r=s=>{s!==e&&n(s)};return a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-sm font-medium mb-2",children:"Available Colors:"}),a.jsx("div",{className:"flex flex-wrap gap-3",children:t.map(s=>{const i=s.id===e;return a.jsxs("div",{className:`product-color-variant ${i?"active":""}`,onClick:()=>r(s.id),title:`${s.color} - Click to view this variant`,"data-testid":`color-variant-${s.color}`,children:[a.jsx("div",{className:"product-color-image",children:a.jsx("img",{src:s.image,alt:s.color,className:"w-full h-full object-contain",loading:"eager"})}),a.jsx("span",{className:"product-color-name",children:s.color}),i&&a.jsx("div",{className:"active-indicator"})]},s.id)})})]})},zF=Sn.memo(BF),qF=()=>{const{id:t}=LS(),e=sr(),[n,r]=k.useState(null),[s,i]=k.useState(!0),[o,l]=k.useState(!1),[c,d]=k.useState(1),[h,f]=k.useState(!1),[m,y]=k.useState(0),[C,w]=k.useState([]),[R,T]=k.useState([]),x=Wt(),_=!!x.currentUser;k.useEffect(()=>{var U;t&&oo(t,{incrementClick:!0,userId:((U=x.currentUser)==null?void 0:U.uid)||null}),window.scrollTo(0,0)},[t]),k.useEffect(()=>{(async()=>{if(t)try{i(!0);const q=["laptops","gaming","tv","audio","mobile"];for(const V of q){const D=gt(we,V,t),$=await In(D);if($.exists()){const W={id:$.id,...$.data(),collection:V};r(W);const ne=[W.image];W.image2&&ne.push(W.image2),W.image3&&ne.push(W.image3),w(ne),V==="laptops"&&await O(W);return}}throw new Error("Product not found")}catch(q){console.error("Error fetching product:",q),r(null)}finally{i(!1)}})()},[t]),k.useEffect(()=>{(async()=>{if(t){const V=await RT(t);l(V)}})();const q=V=>{var $;const D=V;(($=D.detail)==null?void 0:$.productId)===t&&l(D.detail.isFavorite)};return window.addEventListener("favoritesUpdated",q),()=>window.removeEventListener("favoritesUpdated",q)},[t]);const O=async U=>{if(!U.brand||!U.model||!U.processor||!U.modelNumber){console.log("Missing required fields for color variants:",{brand:U.brand,model:U.model,processor:U.processor,modelNumber:U.modelNumber});return}try{const q=nt(we,"laptops"),V=[Wi("brand","==",U.brand),Wi("model","==",U.model)];U.processor&&V.push(Wi("processor","==",U.processor)),U.modelNumber&&V.push(Wi("modelNumber","==",U.modelNumber));const D=bI(q,...V),$=await ot(D),W=[];console.log(`Found ${$.size} potential variants`),$.forEach(ne=>{const se=ne.data();se.ram===U.ram&&se.storageType===U.storageType&&se.screenSize===U.screenSize&&(console.log(`Found matching variant: ${se.color}`),W.push({id:ne.id,color:se.color||"",image:se.image||""}))}),W.sort((ne,se)=>ne.color.localeCompare(se.color)),console.log("Final variants:",W),T(W)}catch(q){console.error("Error fetching color variants:",q)}},j=U=>{U!==t&&e(`/product/${U}`)};k.useEffect(()=>{const U=q=>{var D;const V=q;((D=V.detail)==null?void 0:D.productId)===t&&r($=>$&&{...$,rating:V.detail.rating,reviewCount:V.detail.reviewCount})};return window.addEventListener("productRatingUpdated",U),()=>window.removeEventListener("productRatingUpdated",U)},[t]);const L=async()=>{var U;if(!(!t||!n)){if(!_){window.confirm("You need to be logged in to add items to favorites. Would you like to log in now?")&&(sessionStorage.setItem("redirectAfterLogin",window.location.pathname),e("/login"));return}try{const q={category:n.collection||"uncategorized",name:n.name,image:n.image,price:n.price};await AT(t,q)&&oo(t,{incrementFavorite:!0,userId:((U=x.currentUser)==null?void 0:U.uid)||null})}catch(q){console.error("Error updating favorites:",q),alert("Failed to update favorites")}}},E=()=>{d(U=>U+1)},v=()=>{c>1&&d(U=>U-1)},I=()=>{var D;if(!n||!t)return;if(!_){window.confirm("You need to be logged in to add items to cart. Would you like to log in now?")&&(sessionStorage.setItem("redirectAfterLogin",window.location.pathname),e("/login"));return}const U="cart",q=JSON.parse(localStorage.getItem(U)||"[]"),V=q.findIndex($=>$.id===t);V>=0?q[V].quantity+=c:(q.push({id:t,quantity:c,name:n.name,price:n.price,image:n.image,collection:n.collection||"uncategorized"}),oo(t,{incrementCart:!0,userId:((D=x.currentUser)==null?void 0:D.uid)||null})),localStorage.setItem(U,JSON.stringify(q)),window.dispatchEvent(new CustomEvent("cartUpdated",{detail:{item:n.name}})),f(!0),setTimeout(()=>f(!1),3e3)},A=()=>{C.length<=1||y(U=>(U+1)%C.length)},P=()=>{C.length<=1||y(U=>(U-1+C.length)%C.length)},M=U=>{U>=0&&U<C.length&&y(U)},S=U=>{if(!U)return null;if(U.includes("•")){const q=U.split("•").filter(V=>V.trim().length>0);if(q.length>0)return a.jsx("ul",{className:"pl-5 mt-2 space-y-1 list-disc",children:q.map((V,D)=>a.jsx("li",{className:"text-gray-700",children:V.trim()},D))})}return a.jsx("p",{className:"mt-2 text-gray-700",children:U})},Z=U=>{var q,V,D;if(console.log("Formatting title for product:",U),U.category==="laptops"&&U.brand==="Apple")return PT(U);if(U.category==="laptops"&&U.brand!=="Apple"){const $=[U.brand||"",U.model||"",U.modelNumber||"",U.processor||"",U.ram||"",U.storageType||"",U.color||""].filter(W=>W&&W.trim()!=="").join(" ");return console.log("Generated laptop product full name:",$),$||U.name}if(U.collection==="tv"){const $=[U.brand||"",U.screenSize?`${U.screenSize}"`:"",U.resolution||"",U.refreshRate||"",U.displayType||"",U.model||"",U.modelNumber||""].filter(W=>W&&W.trim()!=="").join(" ");return console.log("Generated TV product full name:",$),$||U.name}if(U.collection==="audio"){const $=[U.brand||"",U.model||"",((D=(V=(q=U.description)==null?void 0:q.split(",")[0])==null?void 0:V.split("•")[0])==null?void 0:D.trim())||"",U.color?`, ${U.color}`:""].filter(W=>W&&W.trim()!=="").join(" ");return console.log("Generated audio product full name:",$),$||U.name}if(U.collection==="mobile"||U.collection==="gaming"){const W=[U.brand||"",U.model||"",U.modelNumber||"",U.memory||"",U.color||""].filter(ne=>ne&&ne.trim()!=="").join(" ");return console.log(`Generated ${U.collection} product full name:`,W),W||U.name}return U.name};return s?a.jsx("div",{className:"flex items-center justify-center h-screen",children:a.jsx("span",{className:"loading loading-spinner loading-lg"})}):n?a.jsxs("div",{className:"container py-8 mx-auto",children:[(n==null?void 0:n.collection)&&a.jsx("div",{style:{display:"none"},children:(sessionStorage.setItem("lastProductCollection",n.collection),null)}),a.jsx("div",{className:"p-4 bg-white rounded-lg shadow-md",children:a.jsxs("div",{className:"flex flex-col md:flex-row",children:[a.jsxs("div",{className:"w-full mb-4 md:w-2/5 md:mb-0",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"w-full h-[400px] relative",children:[C.length>0&&a.jsx("img",{src:C[m],alt:`${n==null?void 0:n.name} - Image ${m+1}`,className:"object-contain w-full h-full"}),C.length>1&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:P,className:"absolute p-2 transform -translate-y-1/2 rounded-full shadow-md left-2 top-1/2 bg-white/80 hover:bg-white",children:a.jsx(US,{size:20})}),a.jsx("button",{onClick:A,className:"absolute p-2 transform -translate-y-1/2 rounded-full shadow-md right-2 top-1/2 bg-white/80 hover:bg-white",children:a.jsx(vg,{size:20})})]})]}),C.length>1&&a.jsx("div",{className:"flex justify-center mt-4 space-x-2",children:C.map((U,q)=>a.jsx("button",{onClick:()=>M(q),className:`w-16 h-16 border-2 rounded-md overflow-hidden ${q===m?"border-blue-500":"border-gray-200"}`,children:a.jsx("img",{src:U,alt:`Thumbnail ${q+1}`,className:"object-contain w-full h-full"})},q))})]}),a.jsx(zF,{variants:R,currentVariantId:t||"",onSelectVariant:j})]}),a.jsxs("div",{className:"w-full md:w-3/5 md:pl-8",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ki,{value:(n==null?void 0:n.rating)||0}),a.jsxs("span",{className:"text-sm text-gray-600",children:[n!=null&&n.rating?n.rating.toFixed(1):"0","(",(n==null?void 0:n.reviewCount)||0," reviews)"]})]}),a.jsx("button",{className:`p-2 rounded-full transition-colors ${o?"text-red-500":"text-gray-400"}`,onClick:L,title:_?"Add to favorites":"Login required to add to favorites",children:a.jsx($S,{size:24,fill:o?"currentColor":"none"})})]}),a.jsx("h1",{className:"mb-4 text-2xl font-bold",children:Z(n)}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Description"}),S((n==null?void 0:n.description)||"")]}),a.jsxs("div",{className:"relative mb-6",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#003D2D] to-[#005040] rounded-lg transform -rotate-1 scale-105"}),a.jsxs("div",{className:"relative bg-white py-3 px-4 rounded-lg border-2 border-[#003D2D] shadow-md",children:[a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[Number(n==null?void 0:n.price).toFixed(2)," ",a.jsx("span",{className:"text-[#003D2D]",children:"NOK"})]}),(n==null?void 0:n.price)>1e3&&a.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["or ",(n.price/12).toFixed(2)," NOK/month with 12-month payment plan"]})]})]}),a.jsx("div",{className:"flex items-center gap-4 mb-6",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Quantity:"}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("button",{className:"w-10 h-10 flex items-center justify-center text-[#003D2D] hover:bg-[#003D2D] hover:text-white border-2 border-r-0 border-[#003D2D] rounded-l-lg transition-all duration-200 active:scale-95",onClick:v,disabled:c<=1,children:a.jsx(BS,{size:16,className:"stroke-[2.5]"})}),a.jsx("div",{className:"relative flex items-center",children:a.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:c,onChange:U=>{const q=parseInt(U.target.value.replace(/[^0-9]/g,""));!isNaN(q)&&q>0?d(q):U.target.value===""&&d(1)},className:"w-12 h-10 text-center border-y-2 border-[#003D2D] focus:outline-none text-[#003D2D] font-medium [-moz-appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",min:"1"})}),a.jsx("button",{className:"w-10 h-10 flex items-center justify-center text-[#003D2D] hover:bg-[#003D2D] hover:text-white border-2 border-l-0 border-[#003D2D] rounded-r-lg transition-all duration-200 active:scale-95",onClick:E,children:a.jsx(zS,{size:16,className:"stroke-[2.5]"})})]}),a.jsx("button",{className:`flex items-center justify-center gap-2 px-6 py-3 text-white bg-[#003D2D] rounded-lg hover:bg-[#005040] transition-all duration-200 active:scale-95 ${window.innerWidth<=768?"btn-circle p-4":""}`,onClick:I,children:window.innerWidth<=768?a.jsx(_g,{size:22}):"Add to Cart"})]})}),h&&a.jsx("div",{className:"p-3 mb-6 text-center text-green-700 bg-green-100 border border-green-200 rounded-lg animate-fade-in-down",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),a.jsx("span",{children:"Added to cart successfully!"})]})})]})]})}),n&&t&&a.jsx("div",{children:a.jsx($F,{productId:t})})]}):a.jsx("div",{className:"text-center",children:"Product not found"})},WF=()=>{const{category:t}=LS(),[e,n]=k.useState([]),[r,s]=k.useState([]);k.useEffect(()=>{(async()=>{const c=(await ot(nt(we,"products"))).docs.map(d=>({id:d.id,...d.data(),image:d.data().image||"",name:d.data().name||"",description:d.data().description||"",price:d.data().price||0}));n(c)})()},[t]),k.useEffect(()=>{const o=JSON.parse(localStorage.getItem("favorites")||"[]");s(o)},[]),k.useEffect(()=>{localStorage.setItem("favorites",JSON.stringify(r))},[r]);const i=o=>{s(l=>l.includes(o)?l.filter(c=>c!==o):[...l,o])};return a.jsxs("div",{className:"container mx-auto py-8",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:t}),a.jsxs("div",{className:"flex",children:[a.jsx("aside",{className:"w-1/4 pr-4",children:a.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md",children:a.jsx("h2",{className:"font-bold mb-2",children:"Filter"})})}),a.jsx("main",{className:"w-3/4",children:a.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.map((o,l)=>a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md flex",children:[a.jsx("img",{src:o.image,alt:o.name,className:"w-1/4"}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h3",{className:"font-bold",children:o.name}),a.jsx("p",{children:o.description}),a.jsxs("p",{className:"text-gray-500",children:[o.price,",-"]}),a.jsx("button",{onClick:()=>i(o.id),className:`mt-2 ${r.includes(o.id)?"text-red-500":"text-gray-500"}`,children:r.includes(o.id)?"Remove from Favorites":"Add to Favorites"})]})]},o.id||l))})})]})]})},Nf=(t,e)=>{const n={};return t.forEach(r=>{const s=r[e];(typeof s=="string"||typeof s=="number")&&(n[s]=(n[s]||0)+1)}),Object.entries(n).map(([r,s])=>({value:r,count:s})).sort((r,s)=>String(r.value).localeCompare(String(s.value)))},HF=t=>{const e={name:"Price",key:"price",type:"range",min:Math.min(...t.map(i=>i.price)),max:Math.max(...t.map(i=>i.price)),values:[]},n={name:"Brand",key:"brand",type:"checkbox",values:Nf(t,"brand")},r={name:"Device Type",key:"deviceType",type:"checkbox",values:Nf(t,"deviceType")},s={name:"Connectivity",key:"connectivity",type:"checkbox",values:Nf(t,"connectivity")};return[e,n,r,s]},GF=()=>{const[t,e]=k.useState([]),[n,r]=k.useState(!0),[s,i]=k.useState(!1),[o,l]=k.useState([]),[c,d]=k.useState({}),[h,f]=k.useState([]);k.useEffect(()=>{(async()=>{r(!0);try{const w=(await ot(nt(we,"gaming"))).docs.map(T=>({id:T.id,...T.data(),collection:"gaming"}));e(w);const R=HF(w);f(R),l(w)}catch(C){console.error("Error fetching gaming products:",C)}finally{r(!1)}})()},[]),k.useEffect(()=>{let y=[...t];Object.entries(c).forEach(([C,w])=>{if(w instanceof Set)y=y.filter(R=>w.has(R[C]));else if(Array.isArray(w)){const[R,T]=w;y=y.filter(x=>x.price>=R&&x.price<=T)}}),l(y)},[t,c]);const m=(y,C)=>{const w={...c};w[y]=Array.isArray(C)&&C.length===2&&typeof C[0]=="number"?C:new Set(C.map(R=>String(R))),d(w)};return n?a.jsx("div",{className:"flex justify-center items-center min-h-screen",children:a.jsx("span",{className:"loading loading-spinner loading-lg"})}):a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Gaming & Peripherals"}),a.jsxs("button",{onClick:()=>i(!s),className:"btn btn-primary flex items-center gap-2",children:[a.jsx(mh,{}),s?"Hide Filters":"Show Filters"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s&&a.jsx("div",{className:"md:col-span-1",children:a.jsx(gh,{filters:h,activeFilters:c,onFilterChange:m})}),a.jsx("div",{className:`${s?"md:col-span-3":"md:col-span-4"}`,children:o.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(y=>a.jsx(Si,{product:y},y.id))}):a.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:a.jsx("p",{className:"text-gray-500",children:"No products found matching the selected filters."})})})]})]})},KF=(t,e)=>t.filter(n=>Object.entries(e).every(([r,s])=>{if(s instanceof Set&&s.size===0)return!0;if(Array.isArray(s)&&r==="price"){const[i,o]=s,l=Number(n[r]);return!isNaN(l)&&l>=i&&l<=o}return s instanceof Set?s.has(n[r]):!0})),QF=(t,e)=>{const n={};return t.forEach(r=>{const s=r[e];(typeof s=="string"||typeof s=="number")&&(n[s]=(n[s]||0)+1)}),Object.entries(n).map(([r,s])=>({value:r,count:s})).sort((r,s)=>String(r.value).localeCompare(String(s.value)))},YF=t=>{const e={name:"Price",key:"price",type:"range",min:Math.min(...t.map(r=>r.price)),max:Math.max(...t.map(r=>r.price)),values:[]},n={name:"Brand",key:"brand",type:"checkbox",values:QF(t,"brand")};return[e,n]},JF=()=>{const[t,e]=k.useState([]),[n,r]=k.useState(!0),[s]=k.useState(null),[i,o]=k.useState(!1),[l,c]=k.useState([]),[d,h]=k.useState({}),[f,m]=k.useState([]);k.useEffect(()=>{(async()=>{try{const[w,R]=await Promise.all([ot(nt(we,"tv")),ot(nt(we,"audio"))]),T=w.docs.map(j=>({id:j.id,...j.data()})),x=R.docs.map(j=>({id:j.id,...j.data()})),_=[...T,...x];e(_);const O=YF(_);m(O),c(_)}catch(w){console.error("Error fetching TV & Audio products:",w)}finally{r(!1)}})()},[]),k.useEffect(()=>{const C=KF(t,d);c(C)},[t,d]);const y=(C,w)=>{const R={...d};C==="price"&&Array.isArray(w)&&w.length===2?R[C]=w:Array.isArray(w)&&!Array.isArray(w[0])&&(w.length===0?delete R[C]:R[C]=new Set(w.map(T=>{const x=Number(T);return isNaN(x)?T:x}))),h(R)};return n?a.jsx("div",{className:"flex justify-center items-center min-h-screen",children:a.jsx("span",{className:"loading loading-spinner loading-lg"})}):s?a.jsx("div",{className:"text-red-500 text-center py-8",children:s}):a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"TV & Audio"}),a.jsxs("button",{onClick:()=>o(!i),className:"btn btn-primary flex items-center gap-2",children:[a.jsx(mh,{}),i?"Hide Filters":"Show Filters"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i&&a.jsx("div",{className:"md:col-span-1",children:a.jsx(gh,{filters:f,activeFilters:d,onFilterChange:y})}),a.jsx("div",{className:`${i?"md:col-span-3":"md:col-span-4"}`,children:l.length>0?a.jsx("div",{className:"px-12 sm:px-16 overflow-x-hidden",children:a.jsx("div",{className:"flex flex-row flex-wrap",children:l.map(C=>a.jsx("div",{className:"w-full sm:w-1/2 lg:w-1/3 mb-6",children:a.jsx(Si,{product:C},C.id)},C.id))})}):a.jsx("div",{className:"col-span-full text-center py-8",children:"No products found matching the selected filters."})})]})]})},XF=()=>a.jsxs("div",{className:"container mx-auto py-8",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"How can we help you?"}),a.jsx("p",{className:"mb-4",children:"When you need a helping hand with your new home electronics or to get older devices up and running, NEAS Support is ready to assist you! No matter what the problem might be, our skilled employees and partners are ready to solve it and find the right technical solution for you."}),a.jsx("p",{className:"mb-4",children:"At NEAS, we have made it our mission not only to give you the best possible shopping experience but also to provide you with the best user experience. We want to simplify your everyday life by guiding you through confusing terms, offering flexible payment solutions, and ensuring that your products get the protection they need. All our services apply to newly purchased products, but we also have services for electronics and appliances you already own, no matter where you bought them. Let us help you achieve a better user experience!"}),a.jsx("p",{className:"mb-4",children:"It's not uncommon to be surprised by how long it can take to set up a new computer or mobile phone. Installing new software, transferring data from an old device, downloading all necessary updates, and setting up desired configurations can sometimes prove to be an exhausting process. Even calibrating your TV's color settings (which are optimized for store display by default) to match the lighting conditions in your own living room can challenge even the most tech-savvy individuals."}),a.jsx("p",{className:"mb-4",children:"Save yourself time and frustration and let us do the work for you! At NEAS, we offer versatile services that help you get started with your new product as quickly as possible. Whether it's a new TV, mobile phone, or computer, we are here to ensure that your new item is delivered just the way you want it - ready to use!"})]}),lx=()=>{const[t,e]=zR(),[n,r]=k.useState([]),[s,i]=k.useState(!0),[o,l]=k.useState(""),c=(h,f,m)=>({...h,id:f,name:h.name||"Unnamed Product",price:h.price||0,image:h.image||"",description:h.description||"",brand:h.brand||"",deviceType:h.deviceType||"",collection:m});k.useEffect(()=>{const h=t.get("q")||t.get("query")||"";if(l(h),!h){i(!1);return}(async()=>{i(!0);try{const m=h.toLowerCase().trim();console.log(`🔍 Searching for "${m}" with parameter types (q and query)`);const y=[m,m.replace(/\s+/g,""),...m.split(/\s+/)],C=Array.from(new Set(y));if(console.log(`🔍 Query variants: ${C.join(", ")}`),m.includes("v3")||m.includes("pro")){console.log("Detected V3/Pro search term, checking for Razer products");const T=nt(we,"gaming"),x=await ot(T),_=[];if(x.forEach(O=>{const j=O.data();j.brand&&j.brand.toLowerCase()==="razer"&&(j.model&&(j.model.toLowerCase().includes("v3")||j.model.toLowerCase().includes("pro"))||j.name&&(j.name.toLowerCase().includes("v3")||j.name.toLowerCase().includes("pro"))||j.memory&&j.memory.toLowerCase().includes("v3"))&&(console.log(`Found Razer V3/Pro match: ${O.id} - ${j.name}`),_.push(c(j,O.id,"gaming")))}),_.length>0){console.log(`Found ${_.length} Razer V3/Pro products`),r(_),i(!1);return}}if(m.includes("deathadder")||m.includes("razer-deathadder")){console.log("Detected specific product search for DeathAdder");const T="razer-deathadder-wiredwireless-2022-black";try{const x=await In(gt(we,"gaming",T));if(x.exists()){const _=x.data();console.log(`Found specific product by ID: ${T}`,_),r([c(_,T,"gaming")]),i(!1);return}else console.log(`Product with ID ${T} not found directly`)}catch(x){console.error(`Error fetching specific product ${T}:`,x)}}if(m.includes("razer")){console.log("Razer search detected, focusing on gaming collection first");const T=nt(we,"gaming"),x=await ot(T),_=[];if(x.forEach(O=>{const j=O.data();(j.brand||"").toLowerCase().includes("razer")&&_.push(c(j,O.id,"gaming"))}),_.length>0){console.log(`Found ${_.length} Razer products`),r(_),i(!1);return}}let w=[];const R=["products","mobile","tv","gaming","laptops","audio"];console.log(`Searching across collections: ${R.join(", ")}`);for(const T of R){const x=nt(we,T),_=await ot(x);console.log(`Checking ${_.size} documents in "${T}" collection`),_.forEach(O=>{const j=O.data();if(console.log(`Checking product: ${j.name} in ${T}`),j.searchKeywords&&Array.isArray(j.searchKeywords)&&C.some(M=>j.searchKeywords.some(S=>{if(!S||typeof S!="string")return!1;const Z=S.toLowerCase().includes(M);return Z&&console.log(`✅ Keyword match found in ${T}/${O.id}: "${S}" matches "${M}"`),Z}))){console.log(`✅ Adding product by keyword match: ${T}/${O.id} - ${j.name}`),w.push(c(j,O.id,T));return}const L=(j.name||"").toLowerCase(),E=(j.brand||"").toLowerCase(),v=(j.model||"").toLowerCase(),I=(j.deviceType||"").toLowerCase();C.some(P=>L.includes(P)||E.includes(P)||v.includes(P)||I.includes(P)||`${E} ${v}`.includes(P)||`${E} ${I}`.includes(P))&&(console.log(`✅ Found matching product: ${j.name} in ${T}`),w.push(c(j,O.id,T)))})}console.log(`📊 Search found ${w.length} results`),r(w)}catch(m){console.error("❌ Error searching products:",m)}finally{i(!1)}})()},[t]);const d=h=>{h.preventDefault(),e({q:o})};return a.jsxs("div",{className:"container py-8 mx-auto",children:[a.jsx("h1",{className:"mb-4 text-2xl font-bold",children:"Search Results"}),a.jsx("form",{onSubmit:d,className:"mb-6",children:a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"text",value:o,onChange:h=>l(h.target.value),className:"flex-grow input input-bordered",placeholder:"Search products..."}),a.jsx("button",{type:"submit",className:"ml-2 btn btn-primary",children:"Search"})]})}),s?a.jsx("div",{className:"flex justify-center",children:a.jsx("span",{className:"loading loading-spinner loading-lg"})}):a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"mb-4 text-gray-600",children:[n.length,' results found for "',o,'"']}),n.length>0?a.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:n.map(h=>a.jsx(Si,{product:h},h.id))}):a.jsx("div",{className:"p-8 text-center",children:a.jsx("p",{children:"No products found matching your search criteria."})})]})]})},ZF=t=>t.split("@")[0].toLowerCase().replace(/[^a-z0-9-_]/g,"").replace(/\s+/g,"-"),eV=()=>{const[t,e]=k.useState({nickname:"",firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),[n,r]=k.useState(""),[s,i]=k.useState(!1),[o,l]=k.useState(!1),[c,d]=k.useState(null),h=sr(),f=C=>{const{name:w,value:R}=C.target;e(T=>({...T,[w]:R}))},m=async C=>{l(!0);const w=yr(),R=de(w,`nicknames/${C}`),T=await je(R);d(!T.exists()),l(!1)},y=async C=>{C.preventDefault(),r(""),i(!0);try{if(t.password!==t.confirmPassword)throw new Error("Passwords do not match");const w=Wt(),{user:R}=await JM(w,t.email,t.password),T=ZF(t.email),x=yr(),_=de(x,`users/${T}`);await dt(_,{nickname:t.nickname,firstName:t.firstName,lastName:t.lastName,email:t.email,customUserId:T,createdAt:new Date().toISOString()}),await ZM(R),alert("Registration successful! Please check your email to verify your account."),h("/login")}catch(w){r(w.message)}finally{i(!1)}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Create your account"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Join us today and enjoy all features"})]}),a.jsxs("form",{onSubmit:y,className:"mt-8 space-y-6",children:[a.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"nickname",className:"block text-sm font-medium text-gray-700",children:"Nickname"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{id:"nickname",type:"text",name:"nickname",value:t.nickname,onChange:f,onBlur:()=>m(t.nickname),className:`appearance-none relative block w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 sm:text-sm ${c===!0?"border-green-500 focus:ring-green-500":c===!1?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-[#003D2D]"}`,placeholder:"Choose your nickname",required:!0,minLength:3}),o?a.jsx("span",{className:"absolute right-2 top-2",children:a.jsx("span",{className:"loading loading-spinner loading-sm text-gray-400"})}):c!==null&&a.jsx("span",{className:`absolute right-2 top-2 text-sm ${c?"text-green-500":"text-red-500"}`,children:c?"✓ Available":"✗ Taken"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First Name"}),a.jsx("input",{type:"text",name:"firstName",value:t.firstName,onChange:f,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-[#003D2D] focus:border-[#003D2D] sm:text-sm",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),a.jsx("input",{type:"text",name:"lastName",value:t.lastName,onChange:f,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-[#003D2D] focus:border-[#003D2D] sm:text-sm",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),a.jsx("input",{type:"email",name:"email",value:t.email,onChange:f,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-[#003D2D] focus:border-[#003D2D] sm:text-sm",placeholder:"you@example.com",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),a.jsx("input",{type:"password",name:"password",value:t.password,onChange:f,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-[#003D2D] focus:border-[#003D2D] sm:text-sm",placeholder:"••••••••",required:!0,minLength:6}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters long"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),a.jsx("input",{type:"password",name:"confirmPassword",value:t.confirmPassword,onChange:f,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-[#003D2D] focus:border-[#003D2D] sm:text-sm",placeholder:"••••••••",required:!0})]})]}),n&&a.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4",children:a.jsx("div",{className:"flex",children:a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm text-red-700",children:n})})})}),a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("button",{type:"submit",className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-[#003D2D] hover:bg-[#004D3D] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#003D2D] transition-all duration-200 text-base shadow-md",disabled:s||!c,children:[s&&a.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:a.jsx("span",{className:"loading loading-spinner loading-sm"})}),s?"Creating account...":"Register Now"]}),a.jsx("div",{className:"text-center text-sm",children:a.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",a.jsx(mr,{to:"/login",className:"font-medium text-[#003D2D] hover:text-[#004D3D] transition-colors duration-200",children:"Sign in"})]})})]})]})]})})},tV=()=>{const[t,e]=k.useState(""),[n,r]=k.useState(""),[s,i]=k.useState(null),[o,l]=k.useState(!1),c=sr(),d=async h=>{h.preventDefault(),i(null),l(!0);try{const f=Wt(),{user:m}=await XM(f,t,n),y=yr(),C=de(y,`users/${m.uid}`),w=await je(C);if(w.exists()){const R=w.val();localStorage.setItem("userProfile",JSON.stringify({...R,lastLogin:new Date().toISOString()})),m.emailVerified&&await Tn(C,{isEmailVerified:!0,emailVerifiedAt:new Date().toISOString(),lastLogin:new Date().toISOString()})}c("/profile")}catch{i("Failed to login. Please check your email and password.")}finally{l(!1)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 py-12 bg-gray-50 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"w-full max-w-md p-8 space-y-8 bg-white shadow-lg rounded-xl",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Welcome back!"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Please sign in to your account"})]}),a.jsxs("form",{onSubmit:d,className:"mt-8 space-y-6",children:[a.jsxs("div",{className:"space-y-4 rounded-md shadow-sm",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),a.jsx("input",{id:"email",type:"email",value:t,onChange:h=>e(h.target.value),className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-[#003D2D] focus:border-[#003D2D] sm:text-sm",placeholder:"you@example.com",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),a.jsx("input",{id:"password",type:"password",value:n,onChange:h=>r(h.target.value),className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-[#003D2D] focus:border-[#003D2D] sm:text-sm",placeholder:"••••••••",required:!0})]})]}),s&&a.jsx("div",{className:"p-4 border-l-4 border-red-400 bg-red-50",children:a.jsx("div",{className:"flex",children:a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm text-red-700",children:s})})})}),a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("button",{type:"submit",className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-[#003D2D] hover:bg-[#004D3D] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#003D2D] transition-all duration-200 text-base shadow-md",disabled:o,children:[o&&a.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:a.jsx("span",{className:"loading loading-spinner loading-sm"})}),o?"Signing in...":"Login Now"]}),a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("div",{className:"text-sm",children:a.jsx("a",{href:"#",className:"font-medium text-[#003D2D] hover:text-[#004D3D] transition-colors duration-200",children:"Forgot your password?"})})})]}),a.jsxs("div",{className:"relative mt-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-300"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 text-gray-500 bg-white",children:"New to our store?"})})]}),a.jsx("div",{className:"mt-6",children:a.jsx(mr,{to:"/register",className:"inline-flex justify-center w-full px-4 py-3 text-sm font-medium border rounded-md border-[#003D2D] text-[#003D2D] hover:bg-[#003D2D] hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#003D2D] transition-all duration-200 text-base shadow-md",children:"Create an account"})})]})]})})},nV=({order:t})=>{if(k.useEffect(()=>{console.log("Order details received:",t),t.items||console.error("Order items are missing:",t)},[t]),!t)return a.jsx("div",{className:"p-4 text-red-500",children:"Error: Order data is missing"});const e=Array.isArray(t.items)?t.items:[],n=(t==null?void 0:t.orderNumber)||"Unknown",r=(t==null?void 0:t.status)||"Unknown",s=t!=null&&t.date?new Date(t.date).toLocaleString():"Unknown date",i=(t==null?void 0:t.shippingAddress)||"Default Address",o=(t==null?void 0:t.customerName)||"Not provided",l=(t==null?void 0:t.customerPhone)||"Not provided",c=d=>Array.isArray(d)?d.reduce((h,f)=>{const m=typeof f.price=="number"?f.price:parseFloat(f.price)||0,y=f.quantity||1;return h+m*y},0):0;return a.jsxs("div",{className:"bg-white p-6 rounded-lg",children:[a.jsxs("div",{className:"mb-4 pb-4 border-b",children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Order #",n]}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${r==="completed"?"bg-green-100 text-green-800":r==="processing"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:r})]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Placed on ",s]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Shipping to: ",i]})]}),a.jsxs("div",{className:"mb-4 pb-4 border-b",children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Customer Information"}),a.jsxs("p",{className:"text-sm",children:[a.jsx("span",{className:"font-medium",children:"Name:"})," ",o]}),a.jsxs("p",{className:"text-sm",children:[a.jsx("span",{className:"font-medium",children:"Phone:"})," ",l]}),a.jsxs("p",{className:"text-sm",children:[a.jsx("span",{className:"font-medium",children:"Customer ID:"})," ",t.customUserId||"Guest"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Items"}),e.length===0?a.jsx("p",{className:"text-gray-500",children:"No items in this order"}):a.jsx("div",{className:"space-y-3",children:Array.isArray(t.items)&&t.items.map((d,h)=>a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsxs("span",{children:[d.name," (x",d.quantity||1,")"]}),a.jsxs("span",{children:[typeof d.price=="number"?d.price.toFixed(2):Number(parseFloat(d.price)||0).toFixed(2)," NOK"]})]},h))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{children:[c(t.items).toFixed(2)," NOK"]})]}),a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Shipping:"}),a.jsx("span",{children:"Free"})]}),a.jsxs("div",{className:"flex justify-between font-bold",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:[c(t.items).toFixed(2)," NOK"]})]})]})]})};var jT={exports:{}},kf={exports:{}},Rf,cx;function rV(){if(cx)return Rf;cx=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Rf=t,Rf}var Af,ux;function sV(){if(ux)return Af;ux=1;var t=rV();function e(){}function n(){}return n.resetWarningCache=e,Af=function(){function r(o,l,c,d,h,f){if(f!==t){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}r.isRequired=r;function s(){return r}var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:n,resetWarningCache:e};return i.PropTypes=i,i},Af}var dx;function iV(){return dx||(dx=1,kf.exports=sV()()),kf.exports}(function(t,e){(function(n,r){t.exports=r(iV(),k)})(fb,function(n,r){function s(S){return S&&typeof S=="object"&&"default"in S?S:{default:S}}var i=s(n),o=s(r);function l(S,Z){for(var U=0;U<Z.length;U++){var q=Z[U];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(S,q.key,q)}}function c(S,Z,U){return Z in S?Object.defineProperty(S,Z,{value:U,enumerable:!0,configurable:!0,writable:!0}):S[Z]=U,S}function d(){return(d=Object.assign||function(S){for(var Z=1;Z<arguments.length;Z++){var U=arguments[Z];for(var q in U)Object.prototype.hasOwnProperty.call(U,q)&&(S[q]=U[q])}return S}).apply(this,arguments)}function h(S,Z){var U,q=Object.keys(S);return Object.getOwnPropertySymbols&&(U=Object.getOwnPropertySymbols(S),Z&&(U=U.filter(function(V){return Object.getOwnPropertyDescriptor(S,V).enumerable})),q.push.apply(q,U)),q}function f(S){for(var Z=1;Z<arguments.length;Z++){var U=arguments[Z]!=null?arguments[Z]:{};Z%2?h(Object(U),!0).forEach(function(q){c(S,q,U[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(S,Object.getOwnPropertyDescriptors(U)):h(Object(U)).forEach(function(q){Object.defineProperty(S,q,Object.getOwnPropertyDescriptor(U,q))})}return S}function m(S){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(Z){return Z.__proto__||Object.getPrototypeOf(Z)})(S)}function y(S,Z){return(y=Object.setPrototypeOf||function(U,q){return U.__proto__=q,U})(S,Z)}function C(S,Z){if(S==null)return{};var U,q=function($,W){if($==null)return{};for(var ne,se={},ce=Object.keys($),F=0;F<ce.length;F++)ne=ce[F],0<=W.indexOf(ne)||(se[ne]=$[ne]);return se}(S,Z);if(Object.getOwnPropertySymbols)for(var V=Object.getOwnPropertySymbols(S),D=0;D<V.length;D++)U=V[D],0<=Z.indexOf(U)||Object.prototype.propertyIsEnumerable.call(S,U)&&(q[U]=S[U]);return q}function w(S){if(S===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S}function R(S){var Z=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var U,q,V,D,$=m(S);return q=Z?(U=m(this).constructor,Reflect.construct($,arguments,U)):$.apply(this,arguments),V=this,!(D=q)||typeof D!="object"&&typeof D!="function"?w(V):D}}function T(S,Z){return function(U){if(Array.isArray(U))return U}(S)||function(U,q){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(U)))){var V=[],D=!0,$=!1,W=void 0;try{for(var ne,se=U[Symbol.iterator]();!(D=(ne=se.next()).done)&&(V.push(ne.value),!q||V.length!==q);D=!0);}catch(ce){$=!0,W=ce}finally{try{D||se.return==null||se.return()}finally{if($)throw W}}return V}}(S,Z)||x(S,Z)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function x(S,Z){if(S){if(typeof S=="string")return _(S,Z);var U=Object.prototype.toString.call(S).slice(8,-1);return U==="Object"&&S.constructor&&(U=S.constructor.name),U==="Map"||U==="Set"?Array.from(S):U==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(U)?_(S,Z):void 0}}function _(S,Z){(Z==null||Z>S.length)&&(Z=S.length);for(var U=0,q=new Array(Z);U<Z;U++)q[U]=S[U];return q}function O(S,Z){return new Promise(function(U,q){var V,D=new Image;D.onload=function(){return U(D)},D.onerror=q,!((V=S)!==null&&V.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\-._~:@/?%\s]*\s*$/i))&&Z&&(D.crossOrigin=Z),D.src=S})}var j,L=!(typeof window>"u"||typeof navigator>"u"||!("ontouchstart"in window||0<navigator.msMaxTouchPoints)),E=typeof File<"u",v={touch:{react:{down:"onTouchStart",mouseDown:"onMouseDown"},native:{down:"touchstart",mouseDown:"mousedown",drag:"touchmove",move:"touchmove",mouseMove:"mousemove",up:"touchend",mouseUp:"mouseup"}},desktop:{react:{down:"onMouseDown"},native:{down:"mousedown",drag:"dragStart",move:"mousemove",up:"mouseup"}}},I=L?v.touch:v.desktop,A=typeof window<"u"&&window.devicePixelRatio?window.devicePixelRatio:1,P={x:.5,y:.5},M=function(){(function(V,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function");V.prototype=Object.create(D&&D.prototype,{constructor:{value:V,writable:!0,configurable:!0}}),D&&y(V,D)})(q,o.default.Component);var S,Z,U=R(q);function q(V){var D;return function($,W){if(!($ instanceof W))throw new TypeError("Cannot call a class as a function")}(this,q),c(w(D=U.call(this,V)),"state",{drag:!1,my:null,mx:null,image:P}),c(w(D),"handleImageReady",function($){var W=D.getInitialSize($.width,$.height);W.resource=$,W.x=.5,W.y=.5,W.backgroundColor=D.props.backgroundColor,D.setState({drag:!1,image:W},D.props.onImageReady),D.props.onLoadSuccess(W)}),c(w(D),"clearImage",function(){D.canvas.getContext("2d").clearRect(0,0,D.canvas.width,D.canvas.height),D.setState({image:P})}),c(w(D),"handleMouseDown",function($){($=$||window.event).preventDefault(),D.setState({drag:!0,mx:null,my:null})}),c(w(D),"handleMouseUp",function(){D.state.drag&&(D.setState({drag:!1}),D.props.onMouseUp())}),c(w(D),"handleMouseMove",function($){var W,ne,se,ce,F,H,b,Q,z,J,ee,K,ie,_e,Pe,De;$=$||window.event,D.state.drag!==!1&&($.preventDefault(),se={mx:W=$.targetTouches?$.targetTouches[0].pageX:$.clientX,my:ne=$.targetTouches?$.targetTouches[0].pageY:$.clientY},De=D.props.rotate,De=(De%=360)<0?De+360:De,D.state.mx&&D.state.my&&(ce=D.state.mx-W,F=D.state.my-ne,H=D.state.image.width*D.props.scale,b=D.state.image.height*D.props.scale,z=(Q=D.getCroppingRect()).x,J=Q.y,z*=H,J*=b,ee=function(vt){return vt*(Math.PI/180)},K=Math.cos(ee(De)),_e=J+-ce*(ie=Math.sin(ee(De)))+F*K,Pe={x:(z+ce*K+F*ie)/H+1/D.props.scale*D.getXScale()/2,y:_e/b+1/D.props.scale*D.getYScale()/2},D.props.onPositionChange(Pe),se.image=f(f({},D.state.image),Pe)),D.setState(se),D.props.onMouseMove($))}),c(w(D),"setCanvas",function($){D.canvas=$}),D.canvas=null,D}return S=q,(Z=[{key:"componentDidMount",value:function(){this.props.disableHiDPIScaling&&(A=1);var V,D,$=this.canvas.getContext("2d");this.props.image&&this.loadImage(this.props.image),this.paint($),document&&(V=!!function(){var W=!1;try{var ne=Object.defineProperty({},"passive",{get:function(){W=!0}});window.addEventListener("test",ne,ne),window.removeEventListener("test",ne,ne)}catch{W=!1}return W}()&&{passive:!1},D=I.native,document.addEventListener(D.move,this.handleMouseMove,V),document.addEventListener(D.up,this.handleMouseUp,V),L&&(document.addEventListener(D.mouseMove,this.handleMouseMove,V),document.addEventListener(D.mouseUp,this.handleMouseUp,V)))}},{key:"componentDidUpdate",value:function(V,D){this.props.image&&this.props.image!==V.image||this.props.width!==V.width||this.props.height!==V.height||this.props.backgroundColor!==V.backgroundColor?this.loadImage(this.props.image):this.props.image||D.image===P||this.clearImage();var $=this.canvas.getContext("2d");$.clearRect(0,0,this.canvas.width,this.canvas.height),this.paint($),this.paintImage($,this.state.image,this.props.border),V.image===this.props.image&&V.width===this.props.width&&V.height===this.props.height&&V.position===this.props.position&&V.scale===this.props.scale&&V.rotate===this.props.rotate&&D.my===this.state.my&&D.mx===this.state.mx&&D.image.x===this.state.image.x&&D.image.y===this.state.image.y&&D.backgroundColor===this.state.backgroundColor||this.props.onImageChange()}},{key:"componentWillUnmount",value:function(){var V;document&&(V=I.native,document.removeEventListener(V.move,this.handleMouseMove,!1),document.removeEventListener(V.up,this.handleMouseUp,!1),L&&(document.removeEventListener(V.mouseMove,this.handleMouseMove,!1),document.removeEventListener(V.mouseUp,this.handleMouseUp,!1)))}},{key:"isVertical",value:function(){return!this.props.disableCanvasRotation&&this.props.rotate%180!=0}},{key:"getBorders",value:function(V){var D=0<arguments.length&&V!==void 0?V:this.props.border;return Array.isArray(D)?D:[D,D]}},{key:"getDimensions",value:function(){var V=this.props,D=V.width,$=V.height,W=V.rotate,ne=V.border,se={},ce=T(this.getBorders(ne),2),F=ce[0],H=ce[1],b=D,Q=$;return this.isVertical()?(se.width=Q,se.height=b):(se.width=b,se.height=Q),se.width+=2*F,se.height+=2*H,{canvas:se,rotate:W,width:D,height:$,border:ne}}},{key:"getImage",value:function(){var V=this.getCroppingRect(),D=this.state.image;V.x*=D.resource.width,V.y*=D.resource.height,V.width*=D.resource.width,V.height*=D.resource.height;var $=document.createElement("canvas");this.isVertical()?($.width=V.height,$.height=V.width):($.width=V.width,$.height=V.height);var W=$.getContext("2d");return W.translate($.width/2,$.height/2),W.rotate(this.props.rotate*Math.PI/180),W.translate(-$.width/2,-$.height/2),this.isVertical()&&W.translate(($.width-$.height)/2,($.height-$.width)/2),D.backgroundColor&&(W.fillStyle=D.backgroundColor,W.fillRect(-V.x,-V.y,D.resource.width,D.resource.height)),W.drawImage(D.resource,-V.x,-V.y),$}},{key:"getImageScaledToCanvas",value:function(){var V=this.getDimensions(),D=V.width,$=V.height,W=document.createElement("canvas");return this.isVertical()?(W.width=$,W.height=D):(W.width=D,W.height=$),this.paintImage(W.getContext("2d"),this.state.image,0,1),W}},{key:"getXScale",value:function(){var V=this.props.width/this.props.height,D=this.state.image.width/this.state.image.height;return Math.min(1,V/D)}},{key:"getYScale",value:function(){var V=this.props.height/this.props.width,D=this.state.image.height/this.state.image.width;return Math.min(1,V/D)}},{key:"getCroppingRect",value:function(){var V=this.props.position||{x:this.state.image.x,y:this.state.image.y},D=1/this.props.scale*this.getXScale(),$=1/this.props.scale*this.getYScale(),W={x:V.x-D/2,y:V.y-$/2,width:D,height:$},ne=0,se=1-W.width,ce=0,F=1-W.height;return(this.props.disableBoundaryChecks||1<D||1<$)&&(ne=-W.width,ce=-W.height,F=se=1),f(f({},W),{},{x:Math.max(ne,Math.min(W.x,se)),y:Math.max(ce,Math.min(W.y,F))})}},{key:"loadImage",value:function(V){var D;E&&V instanceof File?this.loadingImage=(D=V,new Promise(function($,W){var ne=new FileReader;ne.onload=function(se){try{var ce=O(se.target.result);$(ce)}catch(F){W(F)}},ne.readAsDataURL(D)}).then(this.handleImageReady).catch(this.props.onLoadFailure)):typeof V=="string"&&(this.loadingImage=O(V,this.props.crossOrigin).then(this.handleImageReady).catch(this.props.onLoadFailure))}},{key:"getInitialSize",value:function(V,D){var $,W,ne=this.getDimensions();return D/V<ne.height/ne.width?W=V*(($=this.getDimensions().height)/D):$=D*((W=this.getDimensions().width)/V),{height:$,width:W}}},{key:"paintImage",value:function(V,D,$,W){var ne,se=3<arguments.length&&W!==void 0?W:A;D.resource&&(ne=this.calculatePosition(D,$),V.save(),V.translate(V.canvas.width/2,V.canvas.height/2),V.rotate(this.props.rotate*Math.PI/180),V.translate(-V.canvas.width/2,-V.canvas.height/2),this.isVertical()&&V.translate((V.canvas.width-V.canvas.height)/2,(V.canvas.height-V.canvas.width)/2),V.scale(se,se),V.globalCompositeOperation="destination-over",V.drawImage(D.resource,ne.x,ne.y,ne.width,ne.height),D.backgroundColor&&(V.fillStyle=D.backgroundColor,V.fillRect(ne.x,ne.y,ne.width,ne.height)),V.restore())}},{key:"calculatePosition",value:function(V,D){V=V||this.state.image;var $=T(this.getBorders(D),2),W=$[0],ne=$[1],se=this.getCroppingRect(),ce=V.width*this.props.scale,F=V.height*this.props.scale,H=-se.x*ce,b=-se.y*F;return this.isVertical()?(H+=ne,b+=W):(H+=W,b+=ne),{x:H,y:b,height:F,width:ce}}},{key:"paint",value:function(V){V.save(),V.scale(A,A),V.translate(0,0),V.fillStyle="rgba("+this.props.color.slice(0,4).join(",")+")";var D,$,W,ne,se,ce,F,H,ie=this.props.borderRadius,b=this.getDimensions(),Q=T(this.getBorders(b.border),2),z=Q[0],J=Q[1],ee=b.canvas.height,K=b.canvas.width,ie=Math.max(ie,0);ie=Math.min(ie,K/2-z,ee/2-J),V.beginPath(),D=V,ne=K-2*($=z),se=ee-2*(W=J),(ce=ie)===0?D.rect($,W,ne,se):(F=ne-ce,H=se-ce,D.translate($,W),D.arc(ce,ce,ce,Math.PI,1.5*Math.PI),D.lineTo(F,0),D.arc(F,ce,ce,1.5*Math.PI,2*Math.PI),D.lineTo(ne,H),D.arc(F,H,ce,2*Math.PI,.5*Math.PI),D.lineTo(ce,se),D.arc(ce,H,ce,.5*Math.PI,Math.PI),D.translate(-$,-W)),V.rect(K,0,-K,ee),V.fill("evenodd"),V.restore()}},{key:"render",value:function(){var V=this.props,D=(V.scale,V.rotate,V.image,V.border,V.borderRadius,V.width,V.height,V.position,V.color,V.backgroundColor,V.style),$=(V.crossOrigin,V.onLoadFailure,V.onLoadSuccess,V.onImageReady,V.onImageChange,V.onMouseUp,V.onMouseMove,V.onPositionChange,V.disableBoundaryChecks,V.disableHiDPIScaling,V.disableCanvasRotation,C(V,["scale","rotate","image","border","borderRadius","width","height","position","color","backgroundColor","style","crossOrigin","onLoadFailure","onLoadSuccess","onImageReady","onImageChange","onMouseUp","onMouseMove","onPositionChange","disableBoundaryChecks","disableHiDPIScaling","disableCanvasRotation"])),W=this.getDimensions(),ne={width:W.canvas.width,height:W.canvas.height,cursor:this.state.drag?"grabbing":"grab",touchAction:"none"},se={width:W.canvas.width*A,height:W.canvas.height*A,style:f(f({},ne),D)};return se[I.react.down]=this.handleMouseDown,L&&(se[I.react.mouseDown]=this.handleMouseDown),o.default.createElement("canvas",d({ref:this.setCanvas},se,$))}}])&&l(S.prototype,Z),q}();return c(M,"propTypes",{scale:i.default.number,rotate:i.default.number,image:i.default.oneOfType([i.default.string].concat(function(S){if(Array.isArray(S))return _(S)}(j=E?[i.default.instanceOf(File)]:[])||function(S){if(typeof Symbol<"u"&&Symbol.iterator in Object(S))return Array.from(S)}(j)||x(j)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())),border:i.default.oneOfType([i.default.number,i.default.arrayOf(i.default.number)]),borderRadius:i.default.number,width:i.default.number,height:i.default.number,position:i.default.shape({x:i.default.number,y:i.default.number}),color:i.default.arrayOf(i.default.number),backgroundColor:i.default.string,crossOrigin:i.default.oneOf(["","anonymous","use-credentials"]),onLoadFailure:i.default.func,onLoadSuccess:i.default.func,onImageReady:i.default.func,onImageChange:i.default.func,onMouseUp:i.default.func,onMouseMove:i.default.func,onPositionChange:i.default.func,disableBoundaryChecks:i.default.bool,disableHiDPIScaling:i.default.bool,disableCanvasRotation:i.default.bool}),c(M,"defaultProps",{scale:1,rotate:0,border:25,borderRadius:0,width:200,height:200,color:[0,0,0,.5],onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){},disableBoundaryChecks:!1,disableHiDPIScaling:!1,disableCanvasRotation:!0}),M})})(jT);var oV=jT.exports;const aV=gx(oV),lV=(t,e=20)=>new Promise((n,r)=>{const s=(i,o)=>{let l=.8,c,d;const h=m=>{const y=document.createElement("canvas");y.width=i.width*m,y.height=i.height*m;const C=y.getContext("2d");if(!C)throw new Error("Could not get canvas context");return C.drawImage(i,0,0,y.width,y.height),y};let f=i;if(i.width>300||i.height>300){const m=Math.min(300/i.width,300/i.height);f=h(m)}do c=f.toDataURL("image/jpeg",l),d=c.length,l*=.9;while(d>o*1024&&l>.1);return c};try{const i=s(t,e);n(i)}catch(i){r(i)}}),cV=({initialImage:t,onSave:e,onCancel:n})=>{const r=k.createRef(),[s,i]=k.useState({image:t,position:{x:.5,y:.5},scale:1,rotate:0}),o=h=>{h.target.files&&h.target.files[0]&&i(f=>({...f,image:h.target.files[0]}))},l=h=>{i(f=>({...f,scale:parseFloat(h.target.value)}))},c=h=>{i(f=>({...f,rotate:h==="left"?(f.rotate-90)%360:(f.rotate+90)%360}))},d=async()=>{if(r.current){const h=r.current.getImageScaledToCanvas();try{const f=await lV(h,20);if(f.length>240*1024)throw new Error("Image is too large even after compression");e(f)}catch(f){console.error("Error processing image:",f),alert("Failed to process image. Please try a smaller image or lower quality.")}}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg max-w-md w-full",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"Edit Avatar"}),a.jsxs("div",{className:"relative mb-6",children:[a.jsxs("div",{className:"dropzone border-2 border-dashed border-gray-300 rounded-lg p-4 hover:border-primary transition-colors",children:[a.jsx(aV,{ref:r,image:s.image,width:250,height:250,border:50,color:[200,200,200,.6],scale:s.scale,rotate:s.rotate,position:s.position,onPositionChange:h=>i(f=>({...f,position:h})),className:"mx-auto"}),a.jsx("input",{type:"file",onChange:o,accept:"image/*",className:"hidden",id:"avatar-upload"})]}),a.jsx("label",{htmlFor:"avatar-upload",className:"absolute bottom-2 right-2 btn btn-circle btn-sm btn-primary",children:a.jsx(DF,{})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Zoom"}),a.jsx("input",{type:"range",min:1,max:3,step:.01,value:s.scale,onChange:l,className:"range range-primary w-full"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rotate"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>c("left"),className:"btn btn-outline btn-square",children:a.jsx(jF,{})}),a.jsx("button",{onClick:()=>c("right"),className:"btn btn-outline btn-square",children:a.jsx(RF,{})})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[a.jsx("button",{onClick:n,className:"btn btn-ghost",children:"Cancel"}),a.jsx("button",{onClick:d,className:"btn btn-primary",children:"Save"})]})]})]})})},uV="zherbalex1@gmail.com",DT=t=>t===uV,dV=({product:t,isOpen:e,onClose:n,onUpdate:r})=>{const[s,i]=k.useState(t),[o,l]=k.useState(!1);k.useEffect(()=>{i(t)},[t]);const c=async f=>{f.preventDefault(),l(!0);try{if(!s.id)throw new Error("Product ID is required");const m=["laptops","gaming","tv","audio","mobile"];let y=null,C="";for(const O of m){const j=gt(we,O,s.id),L=await In(j);if(L.exists()){y=L,C=O;break}}if(!y)throw new Error("Product not found in any collection");const{id:w,category:R,...T}=s,x={...T,updatedAt:new Date().toISOString()},_=gt(we,C,w);await Js(_,x),r({...x,id:w,category:C}),n()}catch(m){console.error("Error updating product:",m),alert(m instanceof Error?m.message:"Failed to update product")}finally{l(!1)}},d=f=>{const{name:m,value:y}=f.target;i(C=>({...C,[m]:y===null?"":m==="price"?parseFloat(y)||0:y}))};if(!e)return null;const h=s.category==="laptops";return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center overflow-y-auto bg-black bg-opacity-50",children:a.jsxs("div",{className:"w-full max-w-2xl p-6 m-4 bg-white rounded-lg",children:[a.jsxs("h3",{className:"mb-4 text-xl font-bold",children:["Edit Product: ",s.name]}),a.jsxs("form",{onSubmit:c,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium required",children:"Brand"}),a.jsx("input",{type:"text",name:"brand",value:s.brand||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. Motorola",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium required",children:"Model"}),a.jsx("input",{type:"text",name:"model",value:s.model||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. Moto G24",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Model Number"}),a.jsx("input",{type:"text",name:"modelNumber",value:s.modelNumber||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. XT2341-1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Model Year"}),a.jsxs("select",{name:"modelNumber",value:s.modelNumber||"",onChange:d,className:"w-full select select-bordered",children:[a.jsx("option",{value:"",children:"Select Year"}),a.jsx("option",{value:"2025",children:"2025"}),a.jsx("option",{value:"2024",children:"2024"}),a.jsx("option",{value:"2023",children:"2023"}),a.jsx("option",{value:"2022",children:"2022"}),a.jsx("option",{value:"2021",children:"2021"}),a.jsx("option",{value:"2020",children:"2020"})]})]}),!h&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium required",children:"Memory"}),a.jsx("input",{type:"text",name:"memory",value:s.memory||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. 128GB"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium required",children:"Color"}),a.jsx("input",{type:"text",name:"color",value:s.color||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. Steel Gray",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium required",children:"Price (NOK)"}),a.jsx("input",{type:"number",name:"price",value:s.price||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. 4999",min:"0",step:"1",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium required",children:"Description"}),a.jsx("textarea",{name:"description",value:s.description||"",onChange:d,className:"w-full textarea textarea-bordered",rows:4,placeholder:"Product description",required:!0})]}),h&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium",children:"Laptop Specifications"}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[s.brand==="Apple"?a.jsx(a.Fragment,{children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Chip"}),a.jsxs("select",{name:"processor",value:s.processor||"",onChange:d,className:"w-full select select-bordered",children:[a.jsx("option",{value:"",children:"Select Chip"}),a.jsx("option",{value:"Apple M1",children:"Apple M1"}),a.jsx("option",{value:"Apple M1 Pro",children:"Apple M1 Pro"}),a.jsx("option",{value:"Apple M1 Max",children:"Apple M1 Max"}),a.jsx("option",{value:"Apple M1 Ultra",children:"Apple M1 Ultra"}),a.jsx("option",{value:"Apple M2",children:"Apple M2"}),a.jsx("option",{value:"Apple M2 Pro",children:"Apple M2 Pro"}),a.jsx("option",{value:"Apple M2 Max",children:"Apple M2 Max"}),a.jsx("option",{value:"Apple M2 Ultra",children:"Apple M2 Ultra"}),a.jsx("option",{value:"Apple M3",children:"Apple M3"}),a.jsx("option",{value:"Apple M3 Pro",children:"Apple M3 Pro"}),a.jsx("option",{value:"Apple M3 Max",children:"Apple M3 Max"}),a.jsx("option",{value:"Apple M3 Ultra",children:"Apple M3 Ultra"}),a.jsx("option",{value:"Intel Core i5",children:"Intel Core i5"}),a.jsx("option",{value:"Intel Core i7",children:"Intel Core i7"}),a.jsx("option",{value:"Intel Core i9",children:"Intel Core i9"})]})]})}):a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Processor"}),a.jsx("input",{type:"text",name:"processor",value:s.processor||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. Intel Core i7-11800H"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"RAM"}),a.jsx("input",{type:"text",name:"ram",value:s.ram||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. 16GB DDR4"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Storage"}),a.jsx("input",{type:"text",name:"storageType",value:s.storageType||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. 512GB SSD"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Graphics Card"}),a.jsx("input",{type:"text",name:"graphicsCard",value:s.graphicsCard||"",onChange:d,className:"w-full input input-bordered",placeholder:s.brand==="Apple"?"e.g. Apple Integrated Graphics":"e.g. NVIDIA RTX 3060"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Screen Size"}),a.jsx("input",{type:"text",name:"screenSize",value:s.screenSize||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. 15.6 inch"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Operating System"}),s.brand==="Apple"?a.jsxs("select",{name:"operatingSystem",value:s.operatingSystem||"",onChange:d,className:"w-full select select-bordered",children:[a.jsx("option",{value:"",children:"Select OS"}),a.jsx("option",{value:"macOS",children:"macOS"})]}):a.jsx("input",{type:"text",name:"operatingSystem",value:s.operatingSystem||"",onChange:d,className:"w-full input input-bordered",placeholder:"e.g. Windows 11 Home"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium",children:"Current Image"}),a.jsx("div",{className:"mb-4",children:a.jsx("img",{src:s.image||"",alt:s.name||"",className:"object-contain w-32 h-32 border rounded"})}),a.jsx("input",{type:"url",name:"image",value:s.image||"",onChange:d,className:"w-full input input-bordered",placeholder:"Image URL",required:!0})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[a.jsx("button",{type:"button",onClick:n,className:"btn btn-ghost",children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?a.jsx("span",{className:"loading loading-spinner"}):"Save Changes"})]})]})]})})},Yy=async()=>{try{console.log("Starting to update search keywords for all products...");const t=["products","mobile","tv","audio","gaming","laptops"];let e=0;for(const n of t){console.log(`Processing collection: ${n}`);const r=await ot(nt(we,n));let s=0;for(const i of r.docs){const o=i.data(),l=o.name||"",c=o.brand||"",d=o.model||"",h=o.color||"",f=o.deviceType||"",m=o.diagonal||"",y=o.resolution||"",C=o.displayType||"",w=hV(l,c,d,h,f,n,m,y,C,o);(!o.searchKeywords||!Array.isArray(o.searchKeywords)||JSON.stringify(o.searchKeywords.sort())!==JSON.stringify(w.sort()))&&(await Js(gt(we,n,i.id),{searchKeywords:w,updatedAt:new Date().toISOString()}),s++,e++)}console.log(`Updated ${s} products in ${n} collection`)}console.log(`Total products updated: ${e}`)}catch(t){throw console.error("Error updating search keywords:",t),t}},hV=(t,e,n,r,s,i,o,l,c,d)=>{var m,y,C;const h=[];if(t&&(h.push(t.toLowerCase()),t.toLowerCase().split(" ").forEach(w=>{w.length>2&&h.push(w)})),e){const w=e.toLowerCase();if(h.push(w),w==="jbl"&&(h.push("jbl"),h.push("jbl audio"),h.push("jbl sound"),n)){const R=n.toLowerCase();if(h.push(`jbl ${R}`),R.includes("tune")){const T=(m=R.match(/\d+/))==null?void 0:m[0];T&&(h.push(`tune ${T}`),h.push(`tune${T}`),h.push(`jbl tune ${T}`),h.push(`jbl tune${T}`))}}}if(n&&h.push(n.toLowerCase()),r&&h.push(r.toLowerCase()),i==="gaming"&&s&&(h.push(s.toLowerCase()),h.push(`${e} ${s}`.toLowerCase()),h.push(`gaming ${s}`.toLowerCase()),h.push(`${e} gaming`.toLowerCase())),i==="tv"&&(o&&(h.push(`${o} inch`.toLowerCase()),h.push(`${o}"`.toLowerCase()),h.push(`${e} ${o}"`.toLowerCase())),l&&(h.push(l.toLowerCase()),h.push(`${l} tv`.toLowerCase()),h.push(`${e} ${l}`.toLowerCase())),c&&(h.push(c.toLowerCase()),h.push(`${c} tv`.toLowerCase()),h.push(`${e} ${c}`.toLowerCase())),h.push("tv"),h.push("television"),h.push(`${e} tv`.toLowerCase())),i==="audio"){h.push("audio"),h.push("sound");const w=((y=d==null?void 0:d.subtype)==null?void 0:y.toLowerCase())||"";w&&(h.push(w),h.push(`${e} ${w}`.toLowerCase()),w.includes("headphones")&&(h.push("headphones"),h.push("headset"),h.push(`${e} headphones`.toLowerCase())),w.includes("earbuds")&&(h.push("earbuds"),h.push("earphones"),h.push("tws"),h.push(`${e} earbuds`.toLowerCase())),w.includes("speaker")&&(h.push("speaker"),h.push("speakers"),h.push("bluetooth speaker"),h.push(`${e} speaker`.toLowerCase())),w.includes("soundbar")&&(h.push("soundbar"),h.push("sound bar"),h.push("tv speaker"),h.push(`${e} soundbar`.toLowerCase())));const R=((C=d==null?void 0:d.connectivity)==null?void 0:C.toLowerCase())||"";R&&(h.push(R),w&&h.push(`${R} ${w}`.toLowerCase()),R.includes("bluetooth")&&(h.push("bluetooth"),h.push("wireless"),w&&h.push(`bluetooth ${w}`.toLowerCase())))}i==="laptops"&&(h.push("laptop"),h.push("notebook"),h.push(`${e} laptop`.toLowerCase())),i==="mobile"&&(h.push("mobile"),h.push("phone"),h.push("smartphone"),h.push(`${e} phone`.toLowerCase())),e&&n&&h.push(`${e} ${n}`.toLowerCase());const f=[e,n,o,l,c,r].filter(Boolean);return f.length>1&&h.push(f.join(" ").toLowerCase()),Array.from(new Set(h))};console.log("Running search keywords update...");Yy().catch(console.error);const LT=async()=>{try{console.log("Starting to update popular products...");const t=de(me,"productStats"),e=await je(t);if(!e.exists()){console.log("No product stats found in database");return}const n=e.val(),r=Object.entries(n).map(([d,h])=>{const C=h.clickCount||0,w=h.favoriteCount||0,R=h.cartCount||0,T=C*1+w*5+R*10;return{id:d,score:T,clickCount:C,favoriteCount:w,cartCount:R,lastUpdated:new Date().toISOString()}});r.sort((d,h)=>h.score-d.score);const s=r.slice(0,100),i=["products","mobile","tv","audio","gaming","laptops"],o=[];for(const d of s){let h=!1;for(const f of i)if((await ot(nt(we,f))).docs.some(C=>C.id===d.id)){h=!0,o.push({...d,collection:f});break}h||console.log(`Product ${d.id} not found in any collection, but has tracking data`)}const l=de(me,"popularProducts"),c=o.reduce((d,h)=>(d[h.id]={score:h.score,collection:h.collection,lastUpdated:h.lastUpdated},d),{});await dt(l,c),console.log(`Updated ${o.length} popular products in database`)}catch(t){throw console.error("Error updating popular products:",t),t}},OT=async()=>{try{const t="gaming",e=nt(we,t),n=await ot(e);let r=0;for(const s of n.docs){const i=s.data();console.log(`Updating keywords for ${t}/${s.id}:`,i.name);const o=[];if(i.name){const c=i.name.toLowerCase().split(/\s+/);for(const d of c)d.length>2&&o.push(d)}if(i.brand){const c=i.brand.toLowerCase();if(o.push(c),i.model){const d=i.model.toLowerCase();o.push(d),o.push(`${c} ${d}`);const h=d.split(/\s+/);for(const f of h)f.length>=2&&(o.push(f),o.push(`${c} ${f}`))}}if(i.memory&&i.memory.length>0&&(o.push(i.memory.toLowerCase()),i.memory.toLowerCase().includes("v3")&&o.push("v3"),i.memory.toLowerCase().includes("pro")&&o.push("pro")),o.push("gaming","game","gamer"),i.deviceType){const c=i.deviceType.toLowerCase();o.push(c);const d={mouse:["мышь","игровая мышь"],keyboard:["клавиатура","игровая клавиатура"],headset:["наушники","гарнитура"],controller:["геймпад","джойстик"],mousepad:["коврик"],chair:["кресло"]};c in d&&o.push(...d[c]),i.brand&&o.push(`${i.brand.toLowerCase()} ${c}`)}if(i.connectivity){const c=i.connectivity.toLowerCase();o.push(c),c==="wired"?o.push("проводной"):c==="wireless"&&o.push("беспроводной")}const l=Array.from(new Set(o.filter(c=>c&&c.trim().length>1))).map(c=>c.trim());console.log(`Keywords for ${s.id}:`,l),await Js(gt(we,t,s.id),{searchKeywords:l,updatedAt:new Date().toISOString()}),r++}return console.log(`Successfully updated ${r} gaming products with optimized keywords`),r}catch(t){throw console.error("Error updating gaming keywords:",t),t}},MT=async()=>{try{console.log("Starting to update keywords for audio products...");const t="audio",e=await ot(nt(we,t));console.log(`Found ${e.size} audio products`);let n=0;for(const r of e.docs){const s=r.data(),i=s.name||"",o=s.brand||"",l=s.model||"",c=s.color||"",d=s.subtype||"",h=s.connectivity||"",f=s.description||"",m=fV(i,o,l,d,h,c,f);console.log(`Generated ${m.length} keywords for ${r.id}:`,m),await Js(gt(we,t,r.id),{searchKeywords:m,updatedAt:new Date().toISOString()}),n++,console.log(`Updated keywords for product: ${r.id} - ${s.name}`)}console.log(`Total audio products updated: ${n}`)}catch(t){throw console.error("Error updating audio product keywords:",t),t}},fV=(t,e,n,r,s,i,o)=>{const l=[];if(t){const c=t.toLowerCase();l.push(c),c.split(/[\s-]+/).forEach(d=>{d.length>2&&l.push(d)})}if(e){const c=e.toLowerCase();if(l.push(c),c==="jbl"&&(l.push("jbl"),l.push("jbl audio"),l.push("jbl sound"),n)){const d=n.toLowerCase();if(l.push(`jbl ${d}`),d.includes("tune")){const h=d.match(/tune\s*(\d+)/i);if(h){const f=h[1];[`tune ${f}`,`tune${f}`,`jbl tune ${f}`,`jbl tune${f}`,s!=null&&s.toLowerCase().includes("bluetooth")?`tune ${f}bt`:"",s!=null&&s.toLowerCase().includes("bluetooth")?`tune${f}bt`:"",s!=null&&s.toLowerCase().includes("bluetooth")?`jbl tune ${f}bt`:"",s!=null&&s.toLowerCase().includes("bluetooth")?`jbl tune${f}bt`:"",i?`tune ${f} ${i.toLowerCase()}`:"",i?`jbl tune ${f} ${i.toLowerCase()}`:""].filter(Boolean).forEach(m=>l.push(m))}}}}if(e&&n&&l.push(`${e.toLowerCase()} ${n.toLowerCase()}`),e&&i&&l.push(`${e.toLowerCase()} ${i.toLowerCase()}`),r){const c=r.toLowerCase();l.push(c);const d={headphones:["headphones","headset","headsets","over-ear","on-ear"],earbuds:["earbuds","earphones","in-ear","tws","true wireless"],speaker:["speaker","speakers","bluetooth speaker","portable speaker"],soundbar:["soundbar","sound bar","tv speaker","home theater"]};for(const[h,f]of Object.entries(d))c.includes(h)&&f.forEach(m=>{l.push(m),e&&l.push(`${e.toLowerCase()} ${m}`)})}if(s){const c=s.toLowerCase();l.push(c),c.includes("bluetooth")&&["bluetooth","wireless","bt"].forEach(d=>{l.push(d),r&&l.push(`${d} ${r.toLowerCase()}`),e&&l.push(`${e.toLowerCase()} ${d}`)}),c.includes("wired")&&["wired","cable"].forEach(d=>{l.push(d),r&&l.push(`${d} ${r.toLowerCase()}`)})}if(i){const c=i.toLowerCase();l.push(c),l.push(`${e.toLowerCase()} ${c}`),l.push(`${n.toLowerCase()} ${c}`),l.push(`${e.toLowerCase()} ${n.toLowerCase()} ${c}`)}return o&&o.toLowerCase().split(/[\s-]+/).filter(c=>c.length>2).forEach(c=>l.push(c)),Array.from(new Set(l)).filter(c=>c&&c.trim().length>0).map(c=>c.trim())};console.log("Running audio keywords update...");MT().catch(console.error);const pV=async()=>{try{console.log("Starting comprehensive update of all products...");let t=0;console.log("Initial status:"),await yd(),console.log("Updating general keywords..."),await Yy(),t++,console.log("Updating gaming keywords..."),await OT(),t++,console.log("Updating audio keywords..."),await MT(),t++,console.log("Updating popular products..."),await LT(),t++,console.log("Final status:"),await yd(),console.log(`All updates completed successfully! Updated ${t} collections.`)}catch(t){throw console.error("Error during product updates:",t),t}},yd=async()=>{try{console.log("Checking search status...");const t=["products","mobile","tv","audio","gaming","laptops"];for(const e of t){const n=await ot(nt(we,e));let r=0,s=0;n.forEach(i=>{const o=i.data();o.searchKeywords&&Array.isArray(o.searchKeywords)?r++:(s++,console.log(`Missing keywords in ${e}/${i.id}:`,{name:o.name,subtype:o.subtype}))}),console.log(`Collection ${e}:`,{total:n.size,withKeywords:r,withoutKeywords:s})}}catch(t){console.error("Error checking search status:",t)}},mV=()=>{const[t,e]=k.useState(!1),[n,r]=k.useState(""),[s,i]=k.useState(null),[o,l]=k.useState([]),c=async()=>{e(!0),i(null),r("Starting maintenance..."),l([]);try{const d=h=>{l(f=>[...f,h])};d("Checking current database status..."),await yd(),d("Updating search keywords for all collections..."),await pV(),d("Verifying database updates..."),await yd(),r("✅ All updates completed successfully!")}catch(d){console.error("Error during maintenance:",d),i(d instanceof Error?d.message:"Unknown error occurred"),r("❌ Update failed")}finally{e(!1)}};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("button",{onClick:c,disabled:t,className:"btn btn-success btn-lg w-full text-lg font-bold shadow-lg hover:scale-105 transition-transform",children:t?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"loading loading-spinner loading-md"}),"Running Database Update..."]}):"UPDATE DATABASE"}),o.length>0&&a.jsxs("div",{className:"mt-4 bg-base-200 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Progress:"}),a.jsx("ul",{className:"text-sm space-y-1",children:o.map((d,h)=>a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-success",children:"✓"}),d]},h))})]}),n&&a.jsx("div",{className:`text-sm ${s?"text-error":"text-success"} font-medium`,children:n}),s&&a.jsxs("div",{className:"mt-4 p-4 bg-error/10 border border-error/20 rounded-lg",children:[a.jsx("h3",{className:"text-error font-semibold mb-2",children:"Error Details:"}),a.jsx("p",{className:"text-sm text-error",children:s})]})]})},ya=[{header:"Image",key:"image",width:"w-16",render:t=>a.jsx("img",{src:t.image,alt:t.name,className:"object-contain w-12 h-12"})},{header:"Brand",key:"brand"},{header:"Price",key:"price",render:t=>`${t.price} NOK`}],hx={mobile:[...ya,{header:"Model",key:"model"},{header:"Memory",key:"memory"},{header:"Color",key:"color"}],laptops:[...ya,{header:"Model",key:"model"},{header:"Processor",key:"processor"},{header:"RAM",key:"ram"},{header:"Storage",key:"storageType"},{header:"Color",key:"color"}],gaming:[...ya,{header:"Model",key:"model"},{header:"Type",key:"deviceType"},{header:"Connectivity",key:"connectivity"},{header:"Color",key:"color"}],tv:[...ya,{header:"Model",key:"model"},{header:"Screen Size",key:"diagonal"},{header:"Resolution",key:"resolution"},{header:"Display Type",key:"displayType"}],audio:[...ya,{header:"Model",key:"model"},{header:"Type",key:"subtype"},{header:"Connectivity",key:"connectivity"},{header:"Color",key:"color"}]},FT=()=>{const[t,e]=k.useState({name:"",description:"",price:0,image:"",category:"mobile",brand:"",model:"",modelNumber:"",memory:"",color:"",processor:"",graphicsCard:"",screenSize:"",storageType:"",ram:"",operatingSystem:""}),[n,r]=k.useState(!1),[s,i]=k.useState(null),[o,l]=k.useState(""),[c,d]=k.useState("file"),[h,f]=k.useState([]),[m,y]=k.useState(null),[C,w]=k.useState(!1),[R,T]=k.useState("mobile"),[x,_]=k.useState(!1),[O,j]=k.useState(null),[L,E]=k.useState(!1),[v,I]=k.useState(!1);k.useEffect(()=>{(async()=>{try{const z=(await ot(nt(we,R))).docs.map(J=>({id:J.id,...J.data()}));f(z)}catch(Q){console.error("Error fetching products:",Q)}})()},[R]);const A=async b=>{b.preventDefault(),r(!0);try{if(!t.brand||!t.model)throw new Error("Please fill in all required fields");if(t.category==="gaming"&&!t.deviceType)throw new Error("Please select a device type");const Q=Z(t);console.log("Generated Product ID:",Q);let z="";t.category==="gaming"?z=`${t.brand} ${t.model} ${t.deviceType||""} ${t.color}`:t.category==="tv"?z=`${t.brand} ${t.model} ${t.diagonal}" ${t.resolution}`:t.category==="audio"?z=`${t.brand} ${t.model} ${t.subtype} ${t.color}`:z=`${t.brand} ${t.model} ${t.memory||""}`;let J=t.image;if(c==="file"&&s)try{J=await P(s)}catch(Pe){throw console.error("Ошибка при конвертации изображения:",Pe),new Error("Ошибка при обработке изображения")}else c==="url"&&o&&(J=o);const ee=wI();if(!ee)throw new Error("Database not initialized");const K={id:Q,name:z,brand:t.brand,model:t.model,modelNumber:t.modelNumber||null,color:t.color||"",description:t.description||"",price:Math.abs(Number(t.price)),image:J,createdAt:new Date().toISOString(),searchKeywords:M(z,t.modelNumber),clickCount:0,updatedAt:new Date().toISOString(),filterCategories:{brand:t.brand.toLowerCase(),color:(t.color||"").toLowerCase()}};(t.category==="mobile"||t.category==="laptops"||t.category==="gaming")&&(K.memory=t.memory||"",K.filterCategories.memory=(t.memory||"").toLowerCase()),t.category==="gaming"&&(K.deviceType=t.deviceType||"",K.connectivity=t.connectivity||"",K.compatibleWith=t.compatibleWith||"",K.rgbLighting=t.rgbLighting===!0,K.switchType=t.switchType||"",K.dpi=t.dpi||"",K.batteryLife=t.batteryLife||"",K.weight=t.weight||""),t.category==="laptops"&&(K.processor=t.processor||"",K.graphicsCard=t.graphicsCard||"",K.screenSize=t.screenSize||"",K.storageType=t.storageType||"",K.ram=t.ram||"",K.operatingSystem=t.operatingSystem||""),t.category==="tv"&&(K.diagonal=t.diagonal||"",K.resolution=t.resolution||"",K.refreshRate=t.refreshRate||"",K.displayType=t.displayType||""),t.category==="audio"&&(K.subtype=t.subtype||"",K.connectivity=t.connectivity||"",t.batteryLife&&(K.batteryLife=t.batteryLife),t.power&&(K.power=t.power),t.channels&&(K.channels=t.channels));const ie=nt(ee,t.category),_e=gt(ie,Q);await AI(_e,K),console.log("Product successfully added with ID:",Q),e({name:"",description:"",price:0,image:"",category:"mobile",brand:"",model:"",modelNumber:"",memory:"",color:"",processor:"",graphicsCard:"",screenSize:"",storageType:"",ram:"",operatingSystem:""}),i(null),l(""),alert("Product successfully added!")}catch(Q){console.error("Error adding product:",Q),alert(Q instanceof Error?Q.message:"An error occurred while adding the product")}finally{r(!1)}},P=b=>new Promise((Q,z)=>{const J=new FileReader;J.readAsDataURL(b),J.onload=()=>Q(J.result),J.onerror=ee=>z(ee)}),M=(b,Q)=>{const z=[],J=b.toLowerCase().split(" ");for(const ee of J)ee.length>2&&z.push(ee);for(let ee=0;ee<J.length;ee++){let K="";for(let ie=ee;ie<J.length;ie++)K+=J[ie]+" ",z.push(K.trim())}if(Q){z.push(Q.toLowerCase());const ee=Q.toLowerCase().replace(/[\s-]/g,"");ee!==Q.toLowerCase()&&z.push(ee)}return Array.from(new Set(z))},S=b=>b.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").trim(),Z=b=>{const Q=S(b.brand),z=S(b.model);if(b.category==="gaming"){const ie=b.connectivity?S(b.connectivity):"standard",_e=S(b.memory),Pe=S(b.color);return`${Q}-${z}-${ie}-${_e}-${Pe}`}if(b.category==="laptops"){if(b.brand==="Apple"){const vt=S(b.processor||""),vn=S(b.ram||""),ar=S(b.storageType||""),Ds=S(b.screenSize||""),qo=S(b.color||""),nc=b.modelNumber||"";return`apple-${z}-${nc}-${vt}-${vn}-${ar}-${Ds}-${qo}`}const ie=S(b.processor||""),_e=S(b.ram||""),Pe=S(b.storageType||""),De=S(b.color||"");return`${Q}-${z}-${ie}-${_e}-${Pe}-${De}`}if(b.category==="tv"){const ie=b.diagonal?S(b.diagonal):"",_e=S(b.model),Pe=S(b.resolution||""),De=S(b.displayType||""),vt=b.modelNumber?`-${S(b.modelNumber)}`:"";return`${Q}-${_e}-${ie}-${Pe}-${De}-tv${vt}`}if(b.category==="audio"){const ie=b.connectivity?S(b.connectivity):"",_e=b.subtype?S(b.subtype):"",Pe=S(b.color),De=b.modelNumber?`-${S(b.modelNumber)}`:"",vn={headphones:"headphones",earbuds:"earbuds",speakers:"speakers",soundbar:"soundbar"}[_e]||_e;return`${Q}-${z}${De}-${ie}-${vn}-${Pe}`}const J=b.modelNumber?`-${S(b.modelNumber)}`:"",ee=S(b.memory).replace("gb","")+"gb",K=S(b.color);return`${Q}-${z}${J}-${ee}-${K}`},U=async()=>{if(!(!O||!O.id))try{const b=O.id,Q=gt(we,R,b);await jD(Q),f(z=>z.filter(J=>J.id!==O.id)),_(!1),j(null),alert("Product successfully deleted!")}catch(b){console.error("Error deleting product:",b),alert("Failed to delete product")}},q=b=>{b.id&&(y({...b,id:b.id,category:R}),w(!0))},V=async()=>{try{window.confirm("Are you sure you want to update search keywords for all products?")&&(await Yy(),alert("Search keywords updated successfully!"))}catch(b){console.error("Error updating search keywords:",b),alert("Failed to update search keywords")}},D=async()=>{try{window.confirm("Are you sure you want to update popular products?")&&(r(!0),await LT(),alert("Popular products updated successfully!"),r(!1))}catch(b){console.error("Error updating popular products:",b),alert("Failed to update popular products"),r(!1)}},$=async()=>{try{window.confirm("Are you sure you want to update keywords for gaming products?")&&(r(!0),await OT(),alert("Gaming product keywords updated successfully!"),r(!1))}catch(b){console.error("Error updating gaming keywords:",b),alert("Failed to update gaming keywords"),r(!1)}},W=()=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Brand"}),a.jsx("input",{type:"text",value:t.brand,onChange:b=>e({...t,brand:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Motorola",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Model"}),a.jsx("input",{type:"text",value:t.model,onChange:b=>e({...t,model:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Moto G24",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Model Number"}),a.jsx("input",{type:"text",value:t.modelNumber,onChange:b=>e({...t,modelNumber:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. XT2341-1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Memory"}),a.jsx("input",{type:"text",value:t.memory,onChange:b=>e({...t,memory:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. 128GB",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Color"}),a.jsx("input",{type:"text",value:t.color,onChange:b=>e({...t,color:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Steel Gray",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Price (NOK)"}),a.jsx("input",{type:"number",value:t.price,onChange:b=>e({...t,price:Math.max(0,Number(b.target.value))}),className:"w-full input input-bordered",placeholder:"e.g. 12999",min:"0",step:"1",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Description"}),a.jsx("textarea",{value:t.description,onChange:b=>e({...t,description:b.target.value}),className:"w-full textarea textarea-bordered",placeholder:"Product description",required:!0})]}),a.jsxs("div",{className:"p-4 mt-4 bg-gray-100 rounded-lg",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Generated Product ID:"}),a.jsx("div",{className:"mt-1 text-sm text-gray-900",children:Z(t)||"Example: motorola-moto-g24-xt2341-128gb-steelgray"}),a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Format: brand-model-modelnumber-memory-color"})]})]}),ne=()=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Бренд"}),a.jsx("input",{type:"text",value:t.brand,onChange:b=>e({...t,brand:b.target.value}),className:"w-full input input-bordered",placeholder:"например: Logitech, Razer, HyperX",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Модель"}),a.jsx("input",{type:"text",value:t.model,onChange:b=>e({...t,model:b.target.value}),className:"w-full input input-bordered",placeholder:"например: G Pro X, BlackWidow V3",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Модельный номер"}),a.jsx("input",{type:"text",value:t.modelNumber,onChange:b=>e({...t,modelNumber:b.target.value}),className:"w-full input input-bordered",placeholder:"например: 920-009392"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Тип устройства"}),a.jsxs("select",{value:t.deviceType||"",onChange:b=>e({...t,deviceType:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Выберите тип"}),a.jsx("option",{value:"Mouse",children:"Мышь"}),a.jsx("option",{value:"Keyboard",children:"Клавиатура"}),a.jsx("option",{value:"Headset",children:"Гарнитура"}),a.jsx("option",{value:"Controller",children:"Геймпад/Контроллер"}),a.jsx("option",{value:"Chair",children:"Кресло"}),a.jsx("option",{value:"Mousepad",children:"Коврик для мыши"}),a.jsx("option",{value:"Speakers",children:"Колонки"}),a.jsx("option",{value:"Webcam",children:"Веб-камера"}),a.jsx("option",{value:"Microphone",children:"Микрофон"}),a.jsx("option",{value:"Other",children:"Другое"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Подключение"}),a.jsxs("select",{value:t.connectivity||"",onChange:b=>e({...t,connectivity:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Выберите тип подключения"}),a.jsx("option",{value:"Wired",children:"Проводное"}),a.jsx("option",{value:"Wireless",children:"Беспроводное"}),a.jsx("option",{value:"Bluetooth",children:"Bluetooth"}),a.jsx("option",{value:"N/A",children:"Не применимо"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Совместимость"}),a.jsxs("select",{value:t.compatibleWith||"",onChange:b=>e({...t,compatibleWith:b.target.value}),className:"w-full select select-bordered",children:[a.jsx("option",{value:"",children:"Выберите совместимость"}),a.jsx("option",{value:"PC",children:"PC"}),a.jsx("option",{value:"Mac",children:"Mac"}),a.jsx("option",{value:"PC/Mac",children:"PC/Mac"}),a.jsx("option",{value:"PlayStation",children:"PlayStation"}),a.jsx("option",{value:"Xbox",children:"Xbox"}),a.jsx("option",{value:"Switch",children:"Nintendo Switch"}),a.jsx("option",{value:"Multi",children:"Мультиплатформа"})]})]}),t.deviceType==="Mouse"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"DPI"}),a.jsx("input",{type:"text",value:t.dpi||"",onChange:b=>e({...t,dpi:b.target.value}),className:"w-full input input-bordered",placeholder:"например: 16000"})]}),t.deviceType==="Keyboard"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Тип переключателей"}),a.jsx("input",{type:"text",value:t.switchType||"",onChange:b=>e({...t,switchType:b.target.value}),className:"w-full input input-bordered",placeholder:"например: Cherry MX Red, Razer Green"})]}),(t.connectivity==="Wireless"||t.connectivity==="Bluetooth")&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Время работы от батареи"}),a.jsx("input",{type:"text",value:t.batteryLife||"",onChange:b=>e({...t,batteryLife:b.target.value}),className:"w-full input input-bordered",placeholder:"например: До 40 часов"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Вес"}),a.jsx("input",{type:"text",value:t.weight||"",onChange:b=>e({...t,weight:b.target.value}),className:"w-full input input-bordered",placeholder:"например: 80 г"})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("input",{type:"checkbox",id:"rgbLighting",checked:t.rgbLighting||!1,onChange:b=>e({...t,rgbLighting:b.target.checked}),className:"checkbox"}),a.jsx("label",{htmlFor:"rgbLighting",className:"text-sm font-medium text-gray-700",children:"RGB-подсветка"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Версия/Серия"}),a.jsx("input",{type:"text",value:t.memory,onChange:b=>e({...t,memory:b.target.value}),className:"w-full input input-bordered",placeholder:"например: 2023, Mk2, Series 2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Цвет"}),a.jsx("input",{type:"text",value:t.color,onChange:b=>e({...t,color:b.target.value}),className:"w-full input input-bordered",placeholder:"например: Черный, Белый, Красный",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Цена (NOK)"}),a.jsx("input",{type:"number",value:t.price,onChange:b=>e({...t,price:Math.max(0,Number(b.target.value))}),className:"w-full input input-bordered",placeholder:"например: 1299",min:"0",step:"1",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Описание"}),a.jsx("textarea",{value:t.description,onChange:b=>e({...t,description:b.target.value}),className:"w-full textarea textarea-bordered",placeholder:"Описание продукта",required:!0})]}),a.jsxs("div",{className:"p-4 mt-4 bg-gray-100 rounded-lg",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Generated Product ID:"}),a.jsx("div",{className:"mt-1 text-sm text-gray-900",children:Z(t)||"Example: logitech-gpro-wireless-2022-black"}),a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Format: brand-model-connectivity-version-color"})]})]}),se=()=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Brand"}),a.jsxs("select",{value:t.brand,onChange:b=>e({...t,brand:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Brand"}),a.jsx("option",{value:"Apple",children:"Apple (MacBook)"}),a.jsx("option",{value:"Dell",children:"Dell"}),a.jsx("option",{value:"HP",children:"HP"}),a.jsx("option",{value:"Lenovo",children:"Lenovo"}),a.jsx("option",{value:"Asus",children:"Asus"}),a.jsx("option",{value:"Acer",children:"Acer"}),a.jsx("option",{value:"MSI",children:"MSI"}),a.jsx("option",{value:"Microsoft",children:"Microsoft"}),a.jsx("option",{value:"Samsung",children:"Samsung"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),t.brand==="Apple"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Model"}),a.jsxs("select",{value:t.model,onChange:b=>e({...t,model:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Model"}),a.jsx("option",{value:"MacBook Air",children:"MacBook Air"}),a.jsx("option",{value:"MacBook Pro",children:"MacBook Pro"}),a.jsx("option",{value:"MacBook",children:"MacBook"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Model Number"}),a.jsx("input",{type:"text",value:t.modelNumber,onChange:b=>e({...t,modelNumber:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. A2338"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Chip"}),a.jsxs("select",{value:t.processor||"",onChange:b=>e({...t,processor:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Chip"}),a.jsx("option",{value:"Apple M1",children:"Apple M1"}),a.jsx("option",{value:"Apple M1 Pro",children:"Apple M1 Pro"}),a.jsx("option",{value:"Apple M1 Max",children:"Apple M1 Max"}),a.jsx("option",{value:"Apple M1 Ultra",children:"Apple M1 Ultra"}),a.jsx("option",{value:"Apple M2",children:"Apple M2"}),a.jsx("option",{value:"Apple M2 Pro",children:"Apple M2 Pro"}),a.jsx("option",{value:"Apple M2 Max",children:"Apple M2 Max"}),a.jsx("option",{value:"Apple M2 Ultra",children:"Apple M2 Ultra"}),a.jsx("option",{value:"Apple M3",children:"Apple M3"}),a.jsx("option",{value:"Apple M3 Pro",children:"Apple M3 Pro"}),a.jsx("option",{value:"Apple M3 Max",children:"Apple M3 Max"}),a.jsx("option",{value:"Apple M3 Ultra",children:"Apple M3 Ultra"}),a.jsx("option",{value:"Apple M4",children:"Apple M4"}),a.jsx("option",{value:"Apple M4 Pro",children:"Apple M4 Pro"}),a.jsx("option",{value:"Apple M4 Max",children:"Apple M4 Max"}),a.jsx("option",{value:"Apple M4 Ultra",children:"Apple M4 Ultra"}),a.jsx("option",{value:"Intel Core i5",children:"Intel Core i5"}),a.jsx("option",{value:"Intel Core i7",children:"Intel Core i7"}),a.jsx("option",{value:"Intel Core i9",children:"Intel Core i9"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Model Year"}),a.jsxs("select",{value:t.modelNumber||"",onChange:b=>e({...t,modelNumber:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Year"}),a.jsx("option",{value:"2025",children:"2025"}),a.jsx("option",{value:"2024",children:"2024"}),a.jsx("option",{value:"2023",children:"2023"}),a.jsx("option",{value:"2022",children:"2022"}),a.jsx("option",{value:"2021",children:"2021"}),a.jsx("option",{value:"2020",children:"2020"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Graphics Card"}),a.jsx("input",{type:"text",value:t.graphicsCard,onChange:b=>e({...t,graphicsCard:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Apple Integrated Graphics"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Screen Size"}),a.jsxs("select",{value:t.screenSize||"",onChange:b=>e({...t,screenSize:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Screen Size"}),a.jsx("option",{value:"13 inch",children:"13 inch"}),a.jsx("option",{value:"14 inch",children:"14 inch"}),a.jsx("option",{value:"15 inch",children:"15 inch"}),a.jsx("option",{value:"16 inch",children:"16 inch"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Storage Type"}),a.jsxs("select",{value:t.storageType||"",onChange:b=>e({...t,storageType:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Storage"}),a.jsx("option",{value:"256GB SSD",children:"256GB SSD"}),a.jsx("option",{value:"512GB SSD",children:"512GB SSD"}),a.jsx("option",{value:"1TB SSD",children:"1TB SSD"}),a.jsx("option",{value:"2TB SSD",children:"2TB SSD"}),a.jsx("option",{value:"4TB SSD",children:"4TB SSD"}),a.jsx("option",{value:"8TB SSD",children:"8TB SSD"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"RAM"}),a.jsxs("select",{value:t.ram||"",onChange:b=>e({...t,ram:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select RAM"}),a.jsx("option",{value:"8GB",children:"8GB"}),a.jsx("option",{value:"16GB",children:"16GB"}),a.jsx("option",{value:"24GB",children:"24GB"}),a.jsx("option",{value:"32GB",children:"32GB"}),a.jsx("option",{value:"48GB",children:"48GB"}),a.jsx("option",{value:"64GB",children:"64GB"}),a.jsx("option",{value:"96GB",children:"96GB"}),a.jsx("option",{value:"128GB",children:"128GB"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Operating System"}),a.jsxs("select",{value:t.operatingSystem||"",onChange:b=>e({...t,operatingSystem:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select OS"}),a.jsx("option",{value:"macOS",children:"macOS"})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Model"}),a.jsx("input",{type:"text",value:t.model,onChange:b=>e({...t,model:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. XPS 15",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Model Number"}),a.jsx("input",{type:"text",value:t.modelNumber,onChange:b=>e({...t,modelNumber:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. 9500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Processor"}),a.jsx("input",{type:"text",value:t.processor,onChange:b=>e({...t,processor:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Intel Core i7-11800H",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Graphics Card"}),a.jsx("input",{type:"text",value:t.graphicsCard,onChange:b=>e({...t,graphicsCard:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. NVIDIA RTX 3060",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Screen Size"}),a.jsx("input",{type:"text",value:t.screenSize,onChange:b=>e({...t,screenSize:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. 15.6 inch",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Storage Type"}),a.jsx("input",{type:"text",value:t.storageType,onChange:b=>e({...t,storageType:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. 512GB SSD",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"RAM"}),a.jsx("input",{type:"text",value:t.ram,onChange:b=>e({...t,ram:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. 16GB DDR4",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Operating System"}),a.jsx("input",{type:"text",value:t.operatingSystem,onChange:b=>e({...t,operatingSystem:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Windows 11 Home",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Color"}),a.jsx("input",{type:"text",value:t.color,onChange:b=>e({...t,color:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Silver",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Price (NOK)"}),a.jsx("input",{type:"number",value:t.price,onChange:b=>e({...t,price:Math.max(0,Number(b.target.value))}),className:"w-full input input-bordered",placeholder:"e.g. 12999",min:"0",step:"1",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Description"}),a.jsx("textarea",{value:t.description,onChange:b=>e({...t,description:b.target.value}),className:"w-full textarea textarea-bordered",placeholder:"Product description",required:!0})]}),a.jsxs("div",{className:"p-4 mt-4 bg-gray-100 rounded-lg",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Generated Product ID:"}),a.jsx("div",{className:"mt-1 text-sm text-gray-900",children:Z(t)||"Example: dell-xps15-intelcorei7-16gb-512gbssd-silver"}),a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Format: brand-model-processor-ram-storagetype-color"})]})]}),ce=()=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Brand"}),a.jsx("input",{type:"text",value:t.brand,onChange:b=>e({...t,brand:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Samsung, LG, Sony",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Model"}),a.jsx("input",{type:"text",value:t.model,onChange:b=>e({...t,model:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. QN90B",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Diagonal"}),a.jsxs("select",{value:t.diagonal||"",onChange:b=>e({...t,diagonal:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Size"}),a.jsx("option",{value:"32",children:'32"'}),a.jsx("option",{value:"43",children:'43"'}),a.jsx("option",{value:"50",children:'50"'}),a.jsx("option",{value:"55",children:'55"'}),a.jsx("option",{value:"65",children:'65"'}),a.jsx("option",{value:"75",children:'75"'}),a.jsx("option",{value:"85",children:'85"'})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Resolution"}),a.jsxs("select",{value:t.resolution||"",onChange:b=>e({...t,resolution:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Resolution"}),a.jsx("option",{value:"HD",children:"HD (1366x768)"}),a.jsx("option",{value:"Full HD",children:"Full HD (1920x1080)"}),a.jsx("option",{value:"4K",children:"4K Ultra HD (3840x2160)"}),a.jsx("option",{value:"8K",children:"8K (7680x4320)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Refresh Rate"}),a.jsxs("select",{value:t.refreshRate||"",onChange:b=>e({...t,refreshRate:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Refresh Rate"}),a.jsx("option",{value:"60Hz",children:"60Hz"}),a.jsx("option",{value:"100Hz",children:"100Hz"}),a.jsx("option",{value:"120Hz",children:"120Hz"}),a.jsx("option",{value:"144Hz",children:"144Hz"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Display Type"}),a.jsxs("select",{value:t.displayType||"",onChange:b=>e({...t,displayType:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Display Type"}),a.jsx("option",{value:"LED",children:"LED"}),a.jsx("option",{value:"QLED",children:"QLED"}),a.jsx("option",{value:"OLED",children:"OLED"}),a.jsx("option",{value:"Mini LED",children:"Mini LED"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Price (NOK)"}),a.jsx("input",{type:"number",value:t.price,onChange:b=>e({...t,price:Math.max(0,Number(b.target.value))}),className:"w-full input input-bordered",placeholder:"e.g. 12999",min:"0",step:"1",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Description"}),a.jsx("textarea",{value:t.description,onChange:b=>e({...t,description:b.target.value}),className:"w-full textarea textarea-bordered",placeholder:"Product description",required:!0})]}),a.jsxs("div",{className:"p-4 mt-4 bg-gray-100 rounded-lg",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Generated Product ID:"}),a.jsx("div",{className:"mt-1 text-sm text-gray-900",children:Z(t)||"Example: samsung-55-4k-uhd-led-tv-tu7105"}),a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Format: brand-model-diagonal-resolution-displaytype-tv-modelnumber"})]})]}),F=()=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Brand"}),a.jsxs("select",{value:t.brand,onChange:b=>e({...t,brand:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Brand"}),a.jsx("option",{value:"JBL",children:"JBL"}),a.jsx("option",{value:"Sony",children:"Sony"}),a.jsx("option",{value:"Bose",children:"Bose"}),a.jsx("option",{value:"Apple",children:"Apple"}),a.jsx("option",{value:"Samsung",children:"Samsung"}),a.jsx("option",{value:"Sennheiser",children:"Sennheiser"}),a.jsx("option",{value:"Beats",children:"Beats"}),a.jsx("option",{value:"Marshall",children:"Marshall"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Model"}),a.jsx("input",{type:"text",value:t.model,onChange:b=>e({...t,model:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Tune 520BT, WH-1000XM4",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Model Number"}),a.jsx("input",{type:"text",value:t.modelNumber,onChange:b=>e({...t,modelNumber:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. JBLT520BTBLK"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Product Type"}),a.jsxs("select",{value:t.subtype||"",onChange:b=>e({...t,subtype:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Type"}),a.jsx("option",{value:"headphones",children:"Headphones"}),a.jsx("option",{value:"earbuds",children:"Earbuds"}),a.jsx("option",{value:"speakers",children:"Speakers"}),a.jsx("option",{value:"soundbar",children:"Soundbar"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Connectivity"}),a.jsxs("select",{value:t.connectivity||"",onChange:b=>e({...t,connectivity:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Connectivity"}),a.jsx("option",{value:"Wired",children:"Wired"}),a.jsx("option",{value:"Wireless",children:"Wireless"}),a.jsx("option",{value:"Bluetooth",children:"Bluetooth"}),a.jsx("option",{value:"Multiple",children:"Multiple"})]})]}),(t.connectivity==="Wireless"||t.connectivity==="Bluetooth")&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Battery Life"}),a.jsx("input",{type:"text",value:t.batteryLife||"",onChange:b=>e({...t,batteryLife:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. Up to 30 hours"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Price (NOK)"}),a.jsx("input",{type:"number",value:t.price,onChange:b=>e({...t,price:Math.max(0,Number(b.target.value))}),className:"w-full input input-bordered",placeholder:"e.g. 1299",min:"0",step:"1",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Description"}),a.jsx("textarea",{value:t.description,onChange:b=>e({...t,description:b.target.value}),className:"w-full textarea textarea-bordered",placeholder:"Product description",required:!0})]}),t.subtype==="speakers"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Power Output"}),a.jsx("input",{type:"text",value:t.power||"",onChange:b=>e({...t,power:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. 100W"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Channels"}),a.jsx("input",{type:"text",value:t.channels||"",onChange:b=>e({...t,channels:b.target.value}),className:"w-full input input-bordered",placeholder:"e.g. 2.1, 5.1"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 required",children:"Color"}),a.jsxs("select",{value:t.color,onChange:b=>e({...t,color:b.target.value}),className:"w-full select select-bordered",required:!0,children:[a.jsx("option",{value:"",children:"Select Color"}),a.jsx("option",{value:"Black",children:"Black"}),a.jsx("option",{value:"White",children:"White"}),a.jsx("option",{value:"Blue",children:"Blue"}),a.jsx("option",{value:"Red",children:"Red"}),a.jsx("option",{value:"Gray",children:"Gray"}),a.jsx("option",{value:"Pink",children:"Pink"})]})]}),a.jsxs("div",{className:"p-4 mt-4 bg-gray-100 rounded-lg",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Generated Product ID:"}),a.jsx("div",{className:"mt-1 text-sm text-gray-900",children:Z(t)||"Example: jbl-tune520bt-bluetooth-headphones-black"}),a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Format: brand-model-connectivity-type-color"})]})]}),H=()=>t.category==="mobile"?W():t.category==="tv"?ce():t.category==="gaming"?ne():t.category==="laptops"?se():t.category==="audio"?F():null;return a.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[a.jsx("div",{className:"mb-8",children:a.jsx("div",{className:"card bg-base-100 shadow-xl",children:a.jsxs("div",{className:"card-body",children:[a.jsx("h2",{className:"card-title text-2xl",children:"Database Maintenance"}),a.jsx("p",{className:"text-lg mb-4",children:"Update search keywords and optimize database"}),a.jsx(mV,{})]})})}),a.jsxs("div",{className:"mb-4",children:[a.jsx("button",{onClick:V,className:"mr-2 btn btn-warning btn-sm",children:"Update All Search Keywords"}),a.jsx("button",{onClick:D,className:"mr-2 btn btn-info btn-sm",children:"Update Popular Products"}),a.jsx("button",{onClick:$,className:"mr-2 btn btn-secondary btn-sm",children:"Update Gaming Keywords"}),a.jsx(mr,{to:"/admin/debug-keywords",className:"btn btn-outline btn-sm",children:"Debug Keywords"})]}),a.jsxs("div",{className:"flex items-center justify-between mb-4 cursor-pointer",onClick:()=>E(!L),children:[a.jsx("h2",{className:"text-xl font-bold",children:"Admin Panel"}),L?a.jsx(vm,{}):a.jsx(_m,{})]}),!L&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-bold",children:"Add New Product"}),a.jsxs("select",{value:t.category,onChange:b=>e({...t,category:b.target.value}),className:"select select-bordered select-sm",required:!0,children:[a.jsx("option",{value:"mobile",children:"Mobile Phones"}),a.jsx("option",{value:"tv",children:"TV"}),a.jsx("option",{value:"audio",children:"Audio"}),a.jsx("option",{value:"gaming",children:"Gaming"}),a.jsx("option",{value:"laptops",children:"Laptops"})]})]}),a.jsx("form",{onSubmit:A,children:a.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[H(),a.jsxs("div",{className:"lg:col-span-3",children:[a.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Image"}),a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${c==="file"?"btn-primary":"btn-outline"}`,onClick:()=>d("file"),children:"Upload File"}),a.jsx("button",{type:"button",className:`btn btn-sm ${c==="url"?"btn-primary":"btn-outline"}`,onClick:()=>d("url"),children:"Insert URL"})]}),c==="file"?a.jsx("input",{type:"file",onChange:b=>i(b.target.files?b.target.files[0]:null),className:"w-full file-input file-input-sm file-input-bordered",accept:"image/*"}):a.jsx("input",{type:"url",value:o,onChange:b=>l(b.target.value),className:"w-full input input-sm input-bordered",placeholder:"https://example.com/image.jpg"})]}),a.jsx("div",{className:"lg:col-span-3",children:a.jsx("button",{type:"submit",className:"w-full btn btn-primary btn-sm",disabled:n,children:n?a.jsx("span",{className:"loading loading-spinner loading-sm"}):"Add Product"})})]})})]}),a.jsxs("div",{className:"mt-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>I(!v),children:[a.jsx("h3",{className:"text-lg font-bold",children:"Manage Products"}),v?a.jsx(vm,{}):a.jsx(_m,{})]}),!v&&a.jsxs("select",{value:R,onChange:b=>T(b.target.value),className:"select select-bordered select-sm",children:[a.jsx("option",{value:"mobile",children:"Mobile Phones"}),a.jsx("option",{value:"tv",children:"TV"}),a.jsx("option",{value:"audio",children:"Audio"}),a.jsx("option",{value:"gaming",children:"Gaming"}),a.jsx("option",{value:"laptops",children:"Laptops"})]})]}),!v&&a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"table w-full table-sm table-zebra",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[(hx[R]||[]).map(b=>a.jsx("th",{className:b.width,children:b.header},b.key)),a.jsx("th",{className:"w-24",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(b=>a.jsxs("tr",{className:"hover",children:[(hx[R]||[]).map(Q=>a.jsx("td",{children:Q.render?Q.render(b):b[Q.key]},Q.key)),a.jsx("td",{children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>q(b),className:"btn btn-xs btn-primary",children:"Edit"}),a.jsx("button",{onClick:()=>{j(b),_(!0)},className:"btn btn-xs btn-error",children:"Delete"})]})})]},b.id))})]})})]}),x&&O&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsxs("div",{className:"w-full max-w-md p-6 bg-white rounded-lg",children:[a.jsx("h3",{className:"mb-4 text-lg font-bold",children:"Delete Product"}),a.jsxs("p",{className:"mb-4",children:['Are you sure you want to delete "',O.name,'"? This action cannot be undone.']}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{className:"btn btn-ghost",onClick:()=>{_(!1),j(null)},children:"Cancel"}),a.jsx("button",{className:"btn btn-error",onClick:U,children:"Delete"})]})]})}),m&&m.id&&a.jsx(dV,{product:{...m,id:m.id},isOpen:C,onClose:()=>{w(!1),y(null)},onUpdate:b=>{f(Q=>Q.map(z=>z.id===b.id?b:z))}})]})]})},gV=()=>{const e=Wt().currentUser,[n,r]=k.useState((e==null?void 0:e.displayName)||""),[s,i]=k.useState(""),[o,l]=k.useState(""),[c,d]=k.useState(""),[h,f]=k.useState((e==null?void 0:e.photoURL)||Hn),[m,y]=k.useState(!1),[C,w]=k.useState([]),[R,T]=k.useState(()=>{const z=localStorage.getItem("favorites");return z?JSON.parse(z):[]}),[x,_]=k.useState((e==null?void 0:e.uid)||""),[O,j]=k.useState((e==null?void 0:e.photoURL)||Hn),[L,E]=k.useState(!1),[v,I]=k.useState(null),[A,P]=k.useState(!1),[M,S]=k.useState(""),[Z,U]=k.useState(!1),[q,V]=k.useState(()=>{const z=localStorage.getItem("cart");return z?JSON.parse(z):[]}),D=yr(),{updateUserAvatar:$}=bT();k.useEffect(()=>{if(e)r(e.displayName||""),f(e.photoURL||Hn),_(e.uid),W(),ne();else{const z=localStorage.getItem("nickname"),J=localStorage.getItem("firstName"),ee=localStorage.getItem("lastName"),K=localStorage.getItem("phoneNumber"),ie=localStorage.getItem("avatarURL"),_e=localStorage.getItem("favorites"),Pe=localStorage.getItem("userId"),De=localStorage.getItem("cart");z&&r(z),J&&i(J),ee&&l(ee),K&&d(K),ie&&f(ie),_e&&T(JSON.parse(_e)),Pe&&_(Pe),De&&V(JSON.parse(De))}},[e]),k.useEffect(()=>{x&&ne()},[x]),k.useEffect(()=>{localStorage.setItem("nickname",n)},[n]),k.useEffect(()=>{localStorage.setItem("firstName",s)},[s]),k.useEffect(()=>{localStorage.setItem("lastName",o)},[o]),k.useEffect(()=>{localStorage.setItem("phoneNumber",c)},[c]),k.useEffect(()=>{localStorage.setItem("avatarURL",h)},[h]),k.useEffect(()=>{localStorage.setItem("favorites",JSON.stringify(R))},[R]),k.useEffect(()=>{localStorage.setItem("userId",x)},[x]),k.useEffect(()=>{e||localStorage.setItem("cart",JSON.stringify(q))},[q,e]);const W=async()=>{if(e!=null&&e.email){const z=e.email.split("@")[0].toLowerCase().replace(/[^a-z0-9-_]/g,"").replace(/\s+/g,"-"),J=yr(),ee=de(J,`users/${z}`);try{const K=await je(ee);if(K.exists()){const ie=K.val();r(ie.nickname||""),i(ie.firstName||""),l(ie.lastName||""),d(ie.phoneNumber||""),S(z),f(ie.avatarURL||Hn),j(ie.avatarURL||Hn),ie.cart&&(V(ie.cart),localStorage.setItem("cart",JSON.stringify(ie.cart))),localStorage.setItem("userProfile",JSON.stringify(ie))}}catch(K){console.error("Error fetching user profile:",K)}}};k.useEffect(()=>{const z=localStorage.getItem("userProfile");if(z){const J=JSON.parse(z);S(J.customUserId||"")}},[]),k.useEffect(()=>{if(e!=null&&e.email){const z=e.email.split("@")[0].toLowerCase().replace(/[^a-z0-9-_]/g,"").replace(/\s+/g,"-"),J=de(D,`users/${z}/cart`),ee=Zs(J,K=>{if(K.exists()){const ie=K.val();V(ie),localStorage.setItem("cart",JSON.stringify(ie))}});return()=>ee()}},[e,D]);const ne=async()=>{if(x){const z=de(D,`orders/${x}`);try{const J=await je(z);if(J.exists()){const ee=J.val(),K=Object.values(ee).sort((ie,_e)=>new Date(_e.date).getTime()-new Date(ie.date).getTime());w(K)}else w([])}catch(J){console.error("Error fetching orders:",J),w([])}}else{const z=JSON.parse(localStorage.getItem("anonymousOrders")||"[]");z.length>0?w(z):w([])}},se=async z=>{if(z===n)return!0;const J=yr(),ee=de(J,`nicknames/${z.toLowerCase()}`);return!(await je(ee)).exists()},ce=async()=>{var z;if(e)try{if(U(!0),!await se(n))throw new Error("This nickname is already taken");const ee=(z=e.email)==null?void 0:z.split("@")[0].toLowerCase().replace(/[^a-z0-9-_]/g,"").replace(/\s+/g,"-");if(!ee)throw new Error("Invalid email");const K=yr(),ie=de(K,`users/${ee}`),_e={nickname:n,firstName:s,lastName:o,phoneNumber:c,avatarURL:O,lastUpdated:new Date().toISOString()};O.length<=1024?await mT(e,{displayName:n,photoURL:O}):console.warn("Avatar URL too long for Auth profile, updating only in database"),await Tn(ie,_e);const Pe=JSON.parse(localStorage.getItem("userProfile")||"{}");localStorage.setItem("userProfile",JSON.stringify({...Pe,..._e})),alert("Profile updated successfully"),y(!1)}catch(J){console.error("Error updating profile:",J),alert(J instanceof Error?J.message:"Failed to update profile")}finally{U(!1)}},F=()=>{P(!0)},H=()=>{P(!1)},b=async z=>{try{if(E(!0),!(e!=null&&e.uid))throw new Error("No user ID found");const J=de(D,`users/${e.uid}`);await Tn(J,{avatarURL:z,lastUpdated:new Date().toISOString()}),await $(z),j(z),f(z),window.dispatchEvent(new CustomEvent("avatarUpdated",{detail:{avatarURL:z}}))}catch(J){console.error("Error updating avatar:",J),alert("Failed to update avatar. Please try again.")}finally{E(!1),P(!1)}};k.useEffect(()=>{const z=()=>{if(e!=null&&e.photoURL)j(e.photoURL),f(e.photoURL);else{const ee=localStorage.getItem("avatarURL");ee?(j(ee),f(ee)):(j(Hn),f(Hn))}};z();const J=ee=>{var ie;const K=ee;(ie=K.detail)!=null&&ie.avatarURL&&(j(K.detail.avatarURL),f(K.detail.avatarURL))};return window.addEventListener("avatarUpdated",J),window.addEventListener("storage",z),()=>{window.removeEventListener("avatarUpdated",J),window.removeEventListener("storage",z)}},[e]),k.useEffect(()=>{if(e){const z=de(D,`users/${e.uid}`),J=Zs(z,ee=>{if(ee.exists()){const K=ee.val();S(K.customUserId||""),K.avatarURL&&(j(K.avatarURL),f(K.avatarURL),localStorage.setItem("avatarURL",K.avatarURL)),localStorage.setItem("userProfile",JSON.stringify(K))}});return()=>J()}},[e]);const Q=z=>{if(I(v===z?null:z),v!==z){const J=C.find(ee=>ee.id===z);J&&(!J.items||!Array.isArray(J.items))&&console.error("Order is missing items array:",J)}};return a.jsxs("div",{className:"container py-8 mx-auto",children:[a.jsx("h1",{className:"mb-8 text-3xl font-bold text-gray-900",children:"My Profile"}),a.jsx("div",{className:"p-6 mb-8 bg-white shadow-md rounded-xl",children:a.jsxs("div",{className:"flex flex-col items-center md:flex-row md:items-start",children:[a.jsxs("div",{className:"relative mb-6 md:mb-0 md:mr-8",children:[a.jsx("div",{className:"avatar",children:a.jsx("div",{className:"w-32 h-32 overflow-hidden rounded-full ring ring-[#003D2D] ring-offset-2",children:L?a.jsx("div",{className:"flex items-center justify-center w-full h-full bg-gray-100",children:a.jsx("span",{className:"loading loading-spinner loading-md"})}):a.jsx("img",{src:O,alt:"Avatar",className:"object-cover w-full h-full transition-all duration-200 cursor-pointer hover:opacity-80",onClick:F,onError:z=>gd(z)})})}),a.jsx("button",{onClick:F,className:"absolute bottom-0 right-0 p-2 text-white transition-colors rounded-full shadow-lg bg-[#003D2D] hover:bg-[#004D3D]",children:a.jsx(ax,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex flex-col items-center mb-6 md:items-start",children:[a.jsx("h2",{className:"mb-2 text-2xl font-bold text-gray-900",children:n||`${s} ${o}`.trim()||"User"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",M]})]}),a.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Nickname"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:n,onChange:z=>r(z.target.value),disabled:!m,className:"w-full px-4 py-2 transition-colors border rounded-lg outline-none disabled:bg-gray-50 focus:border-[#003D2D]"}),!m&&a.jsx("button",{onClick:()=>y(!0),className:"absolute right-2 top-2 text-[#003D2D] hover:text-[#004D3D]",children:a.jsx(ax,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"First Name"}),a.jsx("input",{type:"text",value:s,onChange:z=>i(z.target.value),disabled:!m,className:"w-full px-4 py-2 transition-colors border rounded-lg outline-none disabled:bg-gray-50 focus:border-[#003D2D]"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Last Name"}),a.jsx("input",{type:"text",value:o,onChange:z=>l(z.target.value),disabled:!m,className:"w-full px-4 py-2 transition-colors border rounded-lg outline-none disabled:bg-gray-50 focus:border-[#003D2D]"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Phone Number"}),a.jsx("input",{type:"text",value:c,onChange:z=>d(z.target.value),disabled:!m,className:"w-full px-4 py-2 transition-colors border rounded-lg outline-none disabled:bg-gray-50 focus:border-[#003D2D]"})]})]})}),m&&a.jsxs("div",{className:"flex gap-4 mt-6",children:[a.jsx("button",{onClick:()=>y(!1),className:"px-6 py-2 text-[#003D2D] border border-[#003D2D] rounded-lg hover:bg-gray-50",disabled:Z,children:"Cancel"}),a.jsx("button",{onClick:ce,className:"px-6 py-2 text-white rounded-lg bg-[#003D2D] hover:bg-[#004D3D]",disabled:Z,children:Z?a.jsx("span",{className:"loading loading-spinner loading-sm"}):"Save Changes"})]})]})]})}),e&&DT(e.email)&&a.jsxs("div",{className:"p-6 mb-8 bg-white shadow-md rounded-xl",children:[a.jsx("h2",{className:"mb-4 text-2xl font-bold text-gray-900",children:"Admin Panel"}),a.jsx(FT,{})]}),a.jsxs("div",{className:"p-6 bg-white shadow-md rounded-xl",children:[a.jsx("h2",{className:"mb-6 text-2xl font-bold text-gray-900",children:"Order History"}),C.length>0?a.jsx("div",{className:"space-y-4",children:C.map((z,J)=>{var ee,K;return a.jsxs("div",{className:"overflow-hidden border rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer bg-gray-50 hover:bg-gray-100",onClick:()=>Q(z.id),children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-semibold",children:["Order #",z.orderNumber||`${J+1}`]}),a.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(z.date).toLocaleDateString()," •",((ee=z.items)==null?void 0:ee.length)||0," items • Total: ",((K=z.total)==null?void 0:K.toFixed(2))||0," NOK"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${z.status==="completed"?"bg-green-100 text-green-800":z.status==="processing"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:z.status||"N/A"}),v===z.id?a.jsx(_m,{}):a.jsx(vm,{})]})]}),v===z.id&&a.jsx("div",{className:"p-4 border-t",children:a.jsx(nV,{order:z})})]},z.id||J)})}):a.jsx("p",{className:"text-center text-gray-500",children:"No order history available."})]}),A&&e&&a.jsx(cV,{initialImage:h,onSave:b,onCancel:H})]})},yV=()=>{const[t,e]=k.useState([]),[n,r]=k.useState(!0),i=Wt().currentUser;return k.useEffect(()=>{const o=async()=>{try{r(!0);let l=[];if(i){const h=de(me,`users/${i.uid}/favorites`),f=await je(h);f.exists()&&(l=Object.keys(f.val()))}else l=JSON.parse(localStorage.getItem("favorites")||"[]");if(l.length===0){e([]),r(!1);return}const c=["mobile","tv","gaming","laptops","smart-home","data"],d=[];for(const h of c){const f=nt(we,h);(await ot(f)).docs.forEach(y=>{l.includes(y.id)&&d.push({id:y.id,...y.data(),name:y.data().name||"Unnamed Product",description:y.data().description||"No description",price:Number(y.data().price)||0,image:y.data().image||"",brand:y.data().brand||"",category:h})})}e(d)}catch(l){console.error("Error fetching favorites:",l)}finally{r(!1)}};return o(),window.addEventListener("favoritesUpdated",o),()=>window.removeEventListener("favoritesUpdated",o)},[i]),n?a.jsx("div",{className:"flex justify-center items-center min-h-screen",children:a.jsx("span",{className:"loading loading-spinner loading-lg"})}):a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"My Favorites"}),t.length===0?a.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"No favorites yet"}),a.jsx("p",{className:"text-gray-600",children:"Items you mark as favorite will appear here"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(o=>a.jsx(Si,{product:o},o.id))})]})},vV=()=>{const[t,e]=k.useState([]),[n,r]=k.useState(!0),[s,i]=k.useState(!1),[o,l]=k.useState(""),[c,d]=k.useState(""),[h,f]=k.useState({}),m=sr(),y=Wt();k.useEffect(()=>{(async()=>{try{const E=JSON.parse(localStorage.getItem("cart")||"[]");if(E.length===0){e([]),r(!1);return}const v=E.map(async A=>{try{const P=await In(gt(we,"products",A.id));if(P.exists()){const Z=P.data();return{...A,name:Z.name,price:Z.price,image:Z.image}}const M=await In(gt(we,"mobile",A.id));if(M.exists()){const Z=M.data();return{...A,name:Z.name,price:Z.price,image:Z.image}}const S=await In(gt(we,"gaming",A.id));if(S.exists()){const Z=S.data();return{...A,name:Z.name,price:Z.price,image:Z.image}}return A}catch(P){return console.error(`Error fetching product ${A.id}:`,P),A}}),I=await Promise.all(v);e(I)}catch(E){console.error("Error fetching cart items:",E)}finally{r(!1)}})();const L=y.currentUser;if(L){l(L.displayName||"");const E=JSON.parse(localStorage.getItem("userProfile")||"{}");E.phoneNumber&&d(E.phoneNumber)}else{const E=localStorage.getItem("checkoutName")||"",v=localStorage.getItem("checkoutPhone")||"";l(E),d(v)}},[y]);const C=(j,L)=>{if(L<1)return;const E=t.map(v=>v.id===j?{...v,quantity:L}:v);e(E),localStorage.setItem("cart",JSON.stringify(E)),window.dispatchEvent(new Event("cartUpdated"))},w=j=>{const L=t.filter(E=>E.id!==j);e(L),localStorage.setItem("cart",JSON.stringify(L)),window.dispatchEvent(new Event("cartUpdated"))},R=()=>{e([]),localStorage.removeItem("cart"),window.dispatchEvent(new Event("cartUpdated"))},T=()=>{const j={};let L=!0;return o.trim()||(j.name="Name is required",L=!1),c.trim()?/^\+?[0-9\s-()]{8,}$/.test(c.trim())||(j.phone="Please enter a valid phone number",L=!1):(j.phone="Phone number is required",L=!1),f(j),L},x=async()=>{if(t.length!==0&&T())try{const j=O(),L=y.currentUser;let E="guest";if(L){const M=de(me,`users/${L.uid}`),S=await je(M);S.exists()&&(E=S.val().customUserId)}const v=new Date,I=`ORD-${Math.floor(Math.random()*1e4)}-${v.getFullYear()}`;localStorage.setItem("checkoutName",o),localStorage.setItem("checkoutPhone",c);const A=t.map(M=>({...M,price:Number(M.price),quantity:Number(M.quantity)})),P={id:Date.now().toString(),items:A,total:Number(j),date:v.toISOString(),status:"completed",orderNumber:I,shippingAddress:"Default Address",userId:L?L.uid:"anonymous",userEmail:L?L.email:"guest",customUserId:E,customerName:o.trim(),customerPhone:c.trim()};if(L)try{const M=de(me,`orders/${L.uid}/${P.id}`);await dt(M,P);const S=gt(we,"orders",I);await AI(S,{...P,createdAt:v.toISOString()}),console.log("Order saved successfully to Firebase")}catch(M){console.error("Error saving order to Firebase:",M),_(P)}else _(P);i(!0),e([]),localStorage.removeItem("cart");try{window.dispatchEvent(new Event("cartUpdated"))}catch(M){console.error("Error dispatching cartUpdated event:",M)}console.log("Cart cleared successfully"),setTimeout(()=>{i(!1),m("/profile",{state:{newOrder:!0}})},3e3)}catch(j){console.error("Error processing order:",j),alert("There was an error processing your order. Please try again.")}},_=j=>{try{const L=JSON.parse(localStorage.getItem("anonymousOrders")||"[]"),E={...j,id:`local-${Date.now()}`};L.push(E),localStorage.setItem("anonymousOrders",JSON.stringify(L)),console.log("Order saved successfully to localStorage")}catch(L){console.error("Error saving to localStorage:",L)}},O=()=>t.reduce((j,L)=>j+L.price*L.quantity,0);return n?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("span",{className:"loading loading-spinner loading-lg"})}):a.jsxs("div",{className:"container py-8 mx-auto",children:[a.jsx("h1",{className:"mb-4 text-2xl font-bold",children:"Shopping Cart"}),s&&a.jsxs("div",{className:"relative px-4 py-3 mb-4 text-green-700 bg-green-100 border border-green-400 rounded",role:"alert",children:[a.jsx("strong",{className:"font-bold",children:"Congratulations on your purchase!"}),a.jsx("span",{className:"block sm:inline",children:" Your order has been placed successfully."})]}),a.jsxs("div",{className:"flex flex-col justify-between gap-4 md:flex-row",children:[a.jsxs("div",{className:"md:w-1/2 lg:w-2/3",children:[t.length===0?a.jsxs("div",{className:"p-8 mb-6 text-center bg-white rounded-lg shadow-md",children:[a.jsx("h2",{className:"mb-4 text-xl font-semibold",children:"Your cart is empty"}),a.jsx("p",{className:"mb-4",children:"Add some products to your cart to continue shopping."}),a.jsx("button",{className:"btn btn-primary",onClick:()=>m("/"),children:"Continue Shopping"})]}):a.jsx("div",{className:"mb-6 overflow-hidden bg-white rounded-lg shadow-md",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Product"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Price"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Quantity"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Total"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(j=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 w-16 h-16",children:a.jsx("img",{className:"object-contain w-16 h-16",src:j.image,alt:j.name})}),a.jsx("div",{className:"ml-4",children:a.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.name})})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-gray-900",children:[Number(j.price).toFixed(2)," NOK"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200",onClick:()=>C(j.id,j.quantity-1),children:a.jsx(BS,{size:16})}),a.jsx("span",{className:"w-8 mx-2 text-center",children:j.quantity}),a.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200",onClick:()=>C(j.id,j.quantity+1),children:a.jsx(zS,{size:16})})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-gray-900",children:[Number(j.price*j.quantity).toFixed(2)," NOK"]})}),a.jsx("td",{className:"px-6 py-4 text-sm font-medium text-right whitespace-nowrap",children:a.jsx("button",{className:"text-red-600 hover:text-red-900",onClick:()=>w(j.id),children:a.jsx(qS,{size:16})})})]},j.id))})]})}),t.length>0&&a.jsx("button",{className:"mb-6 btn btn-outline btn-error",onClick:R,children:"Clear Cart"}),a.jsxs("div",{className:"p-6 mb-6 bg-white rounded-lg shadow-md",children:[a.jsx("h2",{className:"mb-4 text-lg font-bold",children:"Customer Information"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{htmlFor:"customerName",className:"block mb-2 text-gray-700",children:"Full Name *"}),a.jsx("input",{type:"text",id:"customerName",value:o,onChange:j=>l(j.target.value),className:`w-full input input-bordered ${h.name?"input-error":""}`,required:!0}),h.name&&a.jsx("p",{className:"mt-1 text-xs text-red-500",children:h.name})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{htmlFor:"customerPhone",className:"block mb-2 text-gray-700",children:"Phone Number *"}),a.jsx("input",{type:"tel",id:"customerPhone",value:c,onChange:j=>d(j.target.value),className:`w-full input input-bordered ${h.phone?"input-error":""}`,placeholder:"+47 123 45 678",required:!0}),h.phone&&a.jsx("p",{className:"mt-1 text-xs text-red-500",children:h.phone})]})]})]}),a.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md md:w-1/2 lg:w-1/3 h-fit",children:[a.jsx("h2",{className:"mb-4 text-lg font-bold",children:"Order Summary"}),a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{children:[Number(O()).toFixed(2)," NOK"]})]}),a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Shipping:"}),a.jsx("span",{children:"Free"})]}),a.jsx("div",{className:"my-4 border-t border-gray-200"}),a.jsxs("div",{className:"flex justify-between font-bold",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:[Number(O()).toFixed(2)," NOK"]})]}),a.jsx("button",{className:"w-full mt-4 btn btn-primary",onClick:x,disabled:t.length===0,children:"Checkout"}),t.length===0&&a.jsx("p",{className:"mt-2 text-sm text-center text-red-500",children:"Please add items to your cart before checking out"})]})]})]})},_V=()=>a.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[a.jsxs(mr,{to:"/mobile",className:"flex flex-col items-center p-4 bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[a.jsx(kF,{className:"text-3xl text-primary mb-2"}),a.jsx("span",{className:"text-center",children:"Mobile Phones"})]}),a.jsxs(mr,{to:"/laptops",className:"flex flex-col items-center p-4 bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[a.jsx(NF,{className:"text-3xl text-primary mb-2"}),a.jsx("span",{className:"text-center",children:"Laptops"})]}),a.jsxs(mr,{to:"/gaming",className:"flex flex-col items-center p-4 bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[a.jsx(TF,{className:"text-3xl text-primary mb-2"}),a.jsx("span",{className:"text-center",children:"Gaming"})]}),a.jsxs(mr,{to:"/tv-audio",className:"flex flex-col items-center p-4 bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[a.jsx(PF,{className:"text-3xl text-primary mb-2"}),a.jsx("span",{className:"text-center",children:"TV & Audio"})]})]}),wV=()=>{const[t,e]=k.useState([]),[n,r]=k.useState(!0),s=k.useRef(null),i=l=>{if(s.current){const c=l==="left"?-300:300;s.current.scrollBy({left:c,behavior:"smooth"})}},o=l=>({...l,id:l.id||"",name:l.name||"",description:l.description||"",price:Number(l.price)||0,image:l.image||"",brand:l.brand||"",model:l.model||""});return k.useEffect(()=>{const l=async()=>{try{const h=de(me,"popularProducts");try{const f=qO(h,zO("score"),$O(6)),m=await je(f);if(m.exists()){const y=m.val(),C=Object.entries(y).map(([w,R])=>({id:w,...R})).sort((w,R)=>R.score-w.score).slice(0,6);await c(C);return}}catch(f){console.log("Query with orderByChild failed, trying fallback approach:",f);const m=await je(h);if(m.exists()){const y=m.val(),C=Object.entries(y).map(([w,R])=>({id:w,...R})).sort((w,R)=>(R.score||0)-(w.score||0)).slice(0,6);await c(C);return}}console.log("No popular products found, fetching recent products instead"),d()}catch(h){console.error("Error fetching popular products:",h),d()}},c=async h=>{const f=h.map(async y=>{const C=["products","mobile","tv","gaming","laptops","audio"];for(const w of C)try{const R=await In(gt(we,w,y.id));if(R.exists()){const T=R.data();return{...o(T),id:y.id,score:y.score}}}catch(R){console.error(`Error fetching product ${y.id} from ${w}:`,R)}return{id:y.id,name:"Product not found",description:"Not available",price:0,image:"",brand:"Unknown",model:"Unknown",score:y.score}}),m=await Promise.all(f);e(m.filter(y=>y.name!=="Product not found")),r(!1)},d=async()=>{try{const h=["products","mobile","tv","gaming","laptops"];let f=[];for(const m of h){const y=nt(we,m);(await ot(y)).docs.forEach(w=>{const R=w.data();R.name&&R.price&&R.image&&f.push({...o(R),id:w.id,collection:m})})}f.sort((m,y)=>m.createdAt&&y.createdAt?new Date(y.createdAt).getTime()-new Date(m.createdAt).getTime():Math.random()-.5),e(f.slice(0,6)),r(!1)}catch(h){console.error("Error fetching recent products:",h),e([]),r(!1)}};l()},[]),a.jsx("div",{className:"flex flex-col",children:a.jsxs("main",{className:"flex-grow container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsx("section",{className:"hero bg-base-200 py-6 md:py-8 rounded-lg my-4",children:a.jsxs("div",{className:"px-4 md:px-8",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold",children:"Welcome to NEAS Shop"}),a.jsx("p",{className:"mt-2 md:mt-4 text-sm sm:text-base",children:"Find the best electronics and gadgets here."})]})}),a.jsx("section",{className:"py-6 md:py-8 bg-base-200 rounded-lg",children:a.jsxs("div",{className:"px-4 md:px-8",children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-3 md:mb-4",children:"Categories"}),a.jsx(_V,{})]})}),a.jsxs("section",{className:"py-6 md:py-8 mb-4",children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-3 md:mb-4",children:"Popular Products"}),n?a.jsx("div",{className:"flex justify-center",children:a.jsx("span",{className:"loading loading-spinner loading-lg"})}):a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>i("left"),className:"absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-gray-200 hover:bg-gray-300 p-2 rounded-full shadow-md","aria-label":"Scroll left",children:"‹"}),a.jsx("div",{ref:s,className:"flex flex-row flex-nowrap overflow-x-auto pb-4 product-row hide-scrollbar",children:t.length>0?t.map(l=>a.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/4 flex-shrink-0",children:a.jsx(Si,{product:l})},l.id)):a.jsx("div",{className:"w-full text-center py-8",children:a.jsx("p",{className:"text-gray-500",children:"No popular products found"})})}),a.jsx("button",{onClick:()=>i("right"),className:"absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-gray-200 hover:bg-gray-300 p-2 rounded-full shadow-md","aria-label":"Scroll right",children:"›"})]})]})]})})},fx={product:"Product",mobile:"Mobile Phones","tv-audio":"TV & Audio",gaming:"Gaming",laptops:"Laptops","data-accessories":"Data & Accessories",support:"Support",search:"Search Results",cart:"Shopping Cart",favorites:"Favorites",profile:"My Profile",login:"Login",register:"Register",admin:"Admin Panel"},px={mobile:"mobile",tv:"tv-audio",audio:"tv-audio",gaming:"gaming",laptops:"laptops","data-accessories":"data-accessories"},xV=()=>{const t=gi(),[e,n]=k.useState([]);return k.useEffect(()=>{(async()=>{var o,l,c;const s=t.pathname.split("/").filter(d=>d),i=[{name:"Home",path:"/"}];if(s[0]==="product"&&s.length>1){const d=s[1],h=["mobile","tv","audio","gaming","laptops","data-accessories"];let f=null,m=null;for(const C of h){const w=gt(we,C,d),R=await In(w);if(R.exists()){f=R.data(),m=C;break}}if(m&&px[m]){const C=px[m],w=fx[C]||m.charAt(0).toUpperCase()+m.slice(1);i.push({name:w,path:`/${C}`})}let y=(f==null?void 0:f.name)||"Product Details";(m==="mobile"||m==="gaming")&&f?y=[f.brand||"",f.model||"",f.modelNumber||"",f.memory||"",f.color||""].filter(w=>w&&w.trim()!=="").join(" ")||f.name:m==="tv"&&f?y=[f.brand||"",f.screenSize?`${f.screenSize}"`:"",f.resolution||"",f.refreshRate||"",f.displayType||"",f.model||"",f.modelNumber||""].filter(w=>w&&w.trim()!=="").join(" ")||f.name:m==="audio"&&f?y=[f.brand||"",f.model||"",((c=(l=(o=f.description)==null?void 0:o.split(",")[0])==null?void 0:l.split("•")[0])==null?void 0:c.trim())||"",f.color?`, ${f.color}`:""].filter(w=>w&&w.trim()!=="").join(" ")||f.name:m==="laptops"&&f&&f.brand!=="Apple"&&(y=[f.brand||"",f.model||"",f.modelNumber||"",f.processor||"",f.ram||"",f.storageType||"",f.color||""].filter(w=>w&&w.trim()!=="").join(" ")||f.name),i.push({name:y,path:t.pathname})}else{let d="";s.forEach(h=>{d+=`/${h}`;const f=fx[h]||h.charAt(0).toUpperCase()+h.slice(1);i.push({name:f,path:d})})}n(i)})()},[t.pathname]),t.pathname==="/"?null:a.jsx("div",{className:"container mx-auto px-4 py-2",children:a.jsx("div",{className:"text-sm breadcrumbs",children:a.jsx("ul",{className:"flex flex-row items-center",children:e.map((r,s)=>a.jsxs("li",{className:"flex items-center",children:[s>0&&a.jsx(vg,{size:14,className:"mx-1"}),s<e.length-1?a.jsx(mr,{to:r.path,className:"hover:text-primary",children:r.name}):a.jsx("span",{className:"text-gray-500 truncate max-w-[300px]",children:r.name})]},r.path))})})})},EV=()=>{const t=sr();return k.useEffect(()=>{const e=Wt(),n=Gy(e,r=>{if(r){const s=sessionStorage.getItem("redirectAfterLogin");s&&(sessionStorage.removeItem("redirectAfterLogin"),t(s))}});return()=>n()},[t]),null},SV=()=>{const[t,e]=k.useState(""),[n,r]=k.useState([]),[s,i]=k.useState(!1),[o,l]=k.useState(""),c=async()=>{if(t.trim()){i(!0),l(""),r([]);try{const d=["products","mobile","tv","gaming"],h=[];for(const f of d){const m=nt(we,f);(await ot(m)).forEach(C=>{const w=C.data(),R=w.searchKeywords||[];if(Array.isArray(R)){const T=R.filter(x=>x&&typeof x=="string"&&x.toLowerCase().includes(t.toLowerCase()));T.length>0&&h.push({id:C.id,name:w.name||"Unnamed Product",brand:w.brand||"",collection:f,keywords:R,matchedKeywords:T})}})}r(h)}catch(d){console.error("Error searching by keyword:",d),l("An error occurred during search.")}finally{i(!1)}}};return a.jsxs("div",{className:"container p-4 mx-auto",children:[a.jsx("h1",{className:"mb-4 text-xl font-bold",children:"Search Keyword Debugger"}),a.jsxs("div",{className:"flex mb-4",children:[a.jsx("input",{type:"text",className:"flex-grow p-2 border border-gray-300 rounded-l",placeholder:"Enter keyword to search",value:t,onChange:d=>e(d.target.value),onKeyDown:d=>d.key==="Enter"&&c()}),a.jsx("button",{className:"px-4 py-2 text-white bg-blue-500 rounded-r hover:bg-blue-600",onClick:c,disabled:s,children:s?"Searching...":"Search"})]}),o&&a.jsx("div",{className:"p-3 mb-4 text-red-700 bg-red-100 rounded",children:o}),n.length>0?a.jsxs("div",{children:[a.jsxs("h2",{className:"mb-3 text-lg font-semibold",children:["Found ",n.length," products with matching keywords"]}),a.jsx("div",{className:"space-y-4",children:n.map((d,h)=>a.jsxs("div",{className:"p-4 bg-white rounded shadow",children:[a.jsx("div",{className:"font-medium",children:d.name}),a.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",d.id]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Collection: ",d.collection]}),a.jsxs("div",{className:"mt-2",children:[a.jsx("div",{className:"text-sm font-medium",children:"Matched Keywords:"}),a.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:d.matchedKeywords.map((f,m)=>a.jsx("span",{className:"px-2 py-1 text-sm text-white bg-green-500 rounded",children:f},m))})]}),a.jsx("div",{className:"mt-2",children:a.jsxs("details",{children:[a.jsxs("summary",{className:"text-sm cursor-pointer text-blue-500",children:["Show all keywords (",d.keywords.length,")"]}),a.jsx("div",{className:"flex flex-wrap gap-1 p-2 mt-1 bg-gray-100 rounded",children:d.keywords.map((f,m)=>a.jsx("span",{className:"px-2 py-1 text-xs bg-gray-200 rounded",children:f},m))})]})})]},h))})]}):!s&&t&&a.jsx("div",{className:"p-4 text-center text-gray-500",children:"No products found with this keyword."})]})},CV=()=>{const[t,e]=k.useState([]),[n,r]=k.useState(!0),[s,i]=k.useState(null),[o,l]=k.useState(!1),[c,d]=k.useState([]),[h,f]=k.useState({}),[m,y]=k.useState([]),[C]=k.useState("all");k.useEffect(()=>{(async()=>{try{const _=nt(we,"laptops"),j=(await ot(_)).docs.map(E=>({id:E.id,...E.data(),name:E.data().name||"Unnamed Product",description:E.data().description||"No description available",price:Number(E.data().price)||0,image:E.data().image||"",brand:E.data().brand||"",processor:E.data().processor||"",ram:E.data().ram||"",graphicsCard:E.data().graphicsCard||"",storageType:E.data().storageType||"",screenSize:E.data().screenSize||"",operatingSystem:E.data().operatingSystem||"",color:E.data().color||"",category:"laptops"}));e(j);const L=[{name:"Brand",key:"brand",values:w(j,"brand")},{name:"Processor",key:"processor",values:w(j,"processor")},{name:"RAM",key:"ram",values:w(j,"ram")},{name:"Storage",key:"storageType",values:w(j,"storageType")},{name:"Screen Size",key:"screenSize",values:w(j,"screenSize")},{name:"Operating System",key:"operatingSystem",values:w(j,"operatingSystem")},{name:"Price",key:"price",values:[],type:"range",min:Math.min(...j.map(E=>E.price)),max:Math.max(...j.map(E=>E.price))}];y(L.filter(E=>E.values.length>0||E.key==="price")),d(j)}catch(_){console.error("Error fetching laptop products:",_),i("Failed to load products")}finally{r(!1)}})()},[]);const w=(x,_)=>{const O={};return x.forEach(j=>{const L=j[_];typeof L=="string"&&L.trim()&&(O[L]=(O[L]||0)+1)}),Object.entries(O).map(([j,L])=>({value:j,count:L})).sort((j,L)=>String(j.value).localeCompare(String(L.value)))};k.useEffect(()=>{let x=t;C==="mac"?x=x.filter(_=>_.brand==="Apple"||_.operatingSystem&&_.operatingSystem.toLowerCase().includes("macos")):C==="windows"&&(x=x.filter(_=>_.brand!=="Apple"&&(!_.operatingSystem||!_.operatingSystem.toLowerCase().includes("macos")))),x=x.filter(_=>Object.entries(h).every(([O,j])=>{if(O==="price"&&Array.isArray(j)&&j.length===2){const[L,E]=j;return _.price>=L&&_.price<=E}if(j instanceof Set){if(j.size===0)return!0;const L=_[O];if(typeof L=="string")return j.has(L)}return!0})),d(x)},[t,h,C]);const R=(x,_)=>{const O={...h};x==="price"&&Array.isArray(_)&&_.length===2?O[x]=_:Array.isArray(_)&&(_.length===0?delete O[x]:O[x]=new Set(_.map(String))),f(O)},T=x=>{oo(x,{incrementClick:!0,userId:"anonymous"})};return n?a.jsx("div",{className:"flex justify-center items-center min-h-screen",children:a.jsx("span",{className:"loading loading-spinner loading-lg"})}):s?a.jsx("div",{className:"text-red-500 text-center py-8",children:s}):a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Laptops"}),a.jsx("div",{className:"flex gap-2",children:a.jsxs("button",{onClick:()=>l(!o),className:"btn btn-primary btn-sm flex items-center gap-2",children:[a.jsx(mh,{}),o?"Hide Filters":"Show Filters"]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[o&&a.jsx("div",{className:"md:col-span-1",children:a.jsx(gh,{filters:m,activeFilters:h,onFilterChange:R})}),a.jsx("div",{className:`${o?"md:col-span-3":"md:col-span-4"}`,children:c.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(x=>a.jsx("div",{onClick:()=>T(x.id),children:a.jsx(Si,{product:x})},x.id))}):a.jsx("div",{className:"col-span-full text-center py-8",children:"No laptops found matching the selected filters."})})]})]})},mx=({children:t})=>{const n=Wt().currentUser;return!n||!DT(n.email)?a.jsx(Ea,{to:"/"}):a.jsx(a.Fragment,{children:t})},IV=()=>(k.useEffect(()=>{},[]),a.jsx(wF,{children:a.jsxs(VR,{children:[a.jsx(EV,{}),a.jsxs("div",{className:"flex flex-col min-h-screen",children:[a.jsx(EF,{}),a.jsx(xV,{}),a.jsx("main",{className:"flex-grow",children:a.jsxs(AR,{children:[a.jsx(Ze,{path:"/",element:a.jsx(wV,{})}),a.jsx(Ze,{path:"/mobile",element:a.jsx(UF,{})}),a.jsx(Ze,{path:"/product/:id",element:a.jsx(qF,{})}),a.jsx(Ze,{path:"/data-accessories",element:a.jsx(WF,{})}),a.jsx(Ze,{path:"/gaming",element:a.jsx(GF,{})}),a.jsx(Ze,{path:"/tv-audio",element:a.jsx(JF,{})}),a.jsx(Ze,{path:"/support",element:a.jsx(XF,{})}),a.jsx(Ze,{path:"/search",element:a.jsx(lx,{})}),a.jsx(Ze,{path:"/register",element:a.jsx(eV,{})}),a.jsx(Ze,{path:"/login",element:a.jsx(tV,{})}),a.jsx(Ze,{path:"/profile",element:a.jsx(gV,{})}),a.jsx(Ze,{path:"/favorites",element:a.jsx(yV,{})}),a.jsx(Ze,{path:"/cart",element:a.jsx(vV,{})}),a.jsx(Ze,{path:"/admin",element:a.jsx(mx,{children:a.jsx(FT,{})})}),a.jsx(Ze,{path:"/search",element:a.jsx(lx,{})}),a.jsx(Ze,{path:"/product/razer-deathadder",element:a.jsx(Ea,{to:"/product/razer-deathadder-wiredwireless-2022-black",replace:!0})}),a.jsx(Ze,{path:"/product/razer-v3",element:a.jsx(Ea,{to:"/product/razer-viper-v3-pro-wireless-2023-black",replace:!0})}),a.jsx(Ze,{path:"/product/razer-viper-v3",element:a.jsx(Ea,{to:"/product/razer-viper-v3-pro-wireless-2023-black",replace:!0})}),a.jsx(Ze,{path:"/product/razer-viper-pro",element:a.jsx(Ea,{to:"/product/razer-viper-v3-pro-wireless-2023-black",replace:!0})}),a.jsx(Ze,{path:"/admin/debug-keywords",element:a.jsx(mx,{children:a.jsx(SV,{})})}),a.jsx(Ze,{path:"/laptops",element:a.jsx(CV,{})})]})}),a.jsx(SF,{})]})]})})),TV=()=>{const t=window.location.hostname;return t.includes(".web.app")||t.includes(".firebaseapp.com")},bV=()=>{TV()&&window.addEventListener("popstate",()=>{console.log("Navigation detected in Firebase hosting environment")})};try{bV()}catch(t){console.warn("Error setting up hosting detection:",t)}try{yF()}catch(t){console.warn("Error setting up Firebase error handling:",t)}try{vF()}catch(t){console.error("Failed to setup Firestore access:",t)}Pf.createRoot(document.getElementById("root")).render(a.jsx(Sn.StrictMode,{children:a.jsx(IV,{})}));
//# sourceMappingURL=index-Dhf9bYi-.js.map
